<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CORPORATE ESCAPE // NexCorp Tower</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">
<style>
/* ===== RESET & BASE ===== */
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

html, body {
  width: 100%; height: 100%;
  background: #000;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  font-family: 'Share Tech Mono', 'Courier New', monospace;
}

/* ===== 16:9 GAME WRAPPER ===== */
#game-wrapper {
  position: relative;
  width: 100vw;
  height: calc(100vw * 9 / 16);
  max-width: 1600px;
  max-height: 900px;
  background: #03080f;
  overflow: hidden;
  box-shadow: 0 0 80px rgba(0,255,255,0.15), 0 0 200px rgba(0,100,255,0.08);
  transition: box-shadow 0.3s;
}
@media (max-aspect-ratio: 16/9) {
  #game-wrapper { width: calc(100vh * 16 / 9); height: 100vh; }
}

/* ===== BACKGROUNDS ===== */
.bg-grid {
  position: absolute; inset: 0;
  background-image:
    linear-gradient(rgba(0,255,255,0.04) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,255,255,0.04) 1px, transparent 1px);
  background-size: 50px 50px;
  animation: grid-drift 25s linear infinite;
  z-index: 0;
}
@keyframes grid-drift { 0%{background-position:0 0} 100%{background-position:50px 50px} }

.bg-hex-grid {
  position: absolute; inset: 0; z-index: 1; pointer-events: none; opacity: 0.4;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='56' height='100' viewBox='0 0 56 100'%3E%3Cpath d='M28 66L0 50V18L28 2l28 16v32L28 66zm0 0v34' fill='none' stroke='rgba(0,255,255,0.06)' stroke-width='1'/%3E%3C/svg%3E");
  background-size: 56px 100px;
}
.bg-city { position:absolute; bottom:0; left:0; right:0; height:45%; z-index:1; pointer-events:none; }
.bg-city svg { width:100%; height:100%; display:block; }
.bg-glow {
  position:absolute; inset:0;
  background:
    radial-gradient(ellipse 60% 40% at 50% 100%, rgba(0,80,160,0.25) 0%, transparent 70%),
    radial-gradient(ellipse 30% 20% at 20% 110%, rgba(0,200,255,0.1) 0%, transparent 60%),
    radial-gradient(ellipse 30% 20% at 80% 110%, rgba(60,0,200,0.12) 0%, transparent 60%);
  z-index:2; pointer-events:none;
}
.bg-scanlines {
  position:absolute; inset:0;
  background: repeating-linear-gradient(0deg, transparent, transparent 3px, rgba(0,0,0,0.12) 3px, rgba(0,0,0,0.12) 4px);
  z-index:98; pointer-events:none;
}

/* ===== HUD ===== */
#hud {
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 12px;
  background: linear-gradient(to bottom, rgba(0,0,0,0.8) 0%, transparent 100%);
  z-index: 50;
  pointer-events: none;
}
.hud-left, .hud-right { display:flex; align-items:center; gap:10px; }
.hud-center { flex:1; display:flex; align-items:center; justify-content:center; }
.hud-logo { font-family:'Orbitron',monospace; font-size:0.65rem; font-weight:700; letter-spacing:4px; color:rgba(0,255,255,0.5); text-transform:uppercase; }
.hud-floor { font-family:'Orbitron',monospace; font-size:clamp(0.75rem,1.6vw,1rem); font-weight:700; letter-spacing:3px; color:#0ff; text-shadow:0 0 10px #0ff; }
.hud-score { font-family:'Orbitron',monospace; font-size:clamp(0.75rem,1.6vw,1rem); font-weight:700; letter-spacing:3px; color:#ff0; text-shadow:0 0 10px #ff0; }
.hud-score.bounce { animation: score-bounce 0.4s ease; }
@keyframes score-bounce { 0%,100%{transform:scale(1)} 50%{transform:scale(1.4) translateY(-2px)} }
.hud-divider { width:1px; height:20px; background:linear-gradient(to bottom, transparent, #0ff4, transparent); }
.hud-battery-wrap { display:flex; align-items:center; gap:5px; font-size:0.6rem; color:#0f9; letter-spacing:2px; }
.battery-bar { display:flex; gap:2px; align-items:center; }
.battery-seg { width:9px; height:11px; background:#0f9; border:1px solid #0f96; box-shadow:0 0 4px #0f96; }
.battery-seg.empty { background:transparent; border-color:#0f93; box-shadow:none; }
.battery-cap { width:3px; height:6px; background:#0f96; border-radius:0 1px 1px 0; }
.hud-rec { display:flex; align-items:center; gap:4px; font-size:0.65rem; color:#f55; letter-spacing:3px; }
.rec-dot { width:6px; height:6px; background:#f55; border-radius:50%; box-shadow:0 0 6px #f55; animation:blink 1.2s step-end infinite; }
.hud-clock { font-family:'Orbitron',monospace; font-size:0.65rem; color:rgba(0,255,255,0.6); letter-spacing:2px; }
.hud-ticker-wrap { overflow:hidden; width:clamp(80px,18vw,200px); height:18px; }
.hud-ticker { display:inline-block; white-space:nowrap; font-size:0.45rem; color:rgba(0,255,255,0.35); letter-spacing:1px; animation:ticker-scroll 20s linear infinite; }
@keyframes ticker-scroll { 0%{transform:translateX(100%)} 100%{transform:translateX(-100%)} }
/* Progress dots */
#hud-progress { display:flex; gap:4px; align-items:center; }
.prog-dot { width:7px; height:7px; border-radius:50%; background:#333; border:1px solid #555; transition:all 0.3s; }
.prog-dot.done { background:#0f8; border-color:#0f8; box-shadow:0 0 4px #0f8; }
.prog-dot.current { background:#0ff; border-color:#0ff; box-shadow:0 0 6px #0ff; animation:blink 0.8s step-end infinite; }

/* EXIT button */
#exit-btn {
  font-family: 'Orbitron', monospace;
  font-size: 0.55rem;
  letter-spacing: 2px;
  color: #0ff;
  background: rgba(0,0,0,0.6);
  border: 1px solid rgba(0,255,255,0.4);
  padding: 4px 9px;
  cursor: pointer;
  pointer-events: all;
  transition: all 0.2s;
  text-transform: uppercase;
}
#exit-btn:hover { border-color:#0ff; color:#fff; box-shadow:0 0 8px rgba(0,255,255,0.4); }

/* ===== SCREENS ===== */
.screen {
  position: absolute; inset: 0;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  opacity: 0; pointer-events: none;
  transition: opacity 0.4s ease;
  z-index: 10;
  /* 22% of 16:9 height expressed as % of width = 22×(9/16)% = 12.375% */
  padding-top: 56px;
  padding-bottom: calc(12.375% + 12px);
}
.screen.active { opacity:1; pointer-events:all; }

/* Per-type entrance animations */
@keyframes bootFadeIn { from{opacity:0;filter:brightness(0) blur(4px)} to{opacity:1;filter:brightness(1) blur(0)} }
.anim-boot { animation: bootFadeIn 1s ease forwards; }
@keyframes dataWipeIn { 0%{clip-path:inset(0 100% 0 0);opacity:0.3} 100%{clip-path:inset(0 0% 0 0);opacity:1} }
.anim-wipe { animation: dataWipeIn 0.5s cubic-bezier(0.77,0,0.175,1) forwards; }
@keyframes blindsIn { 0%{clip-path:inset(0 0 100% 0)} 100%{clip-path:inset(0 0 0% 0)} }
.anim-blinds { animation: blindsIn 0.45s ease forwards; }
@keyframes zoomIn { from{transform:scale(0.6);opacity:0} to{transform:scale(1);opacity:1} }
.anim-zoom { animation: zoomIn 0.4s cubic-bezier(0.34,1.56,0.64,1) forwards; }
@keyframes matchSlideIn { from{transform:translateY(40px);opacity:0} to{transform:translateY(0);opacity:1} }
.anim-match { animation: matchSlideIn 0.4s ease forwards; }
@keyframes winExplode { 0%{transform:scale(0.3);opacity:0} 60%{transform:scale(1.05);opacity:1} 100%{transform:scale(1);opacity:1} }
.anim-win { animation: winExplode 0.8s cubic-bezier(0.34,1.56,0.64,1) forwards; }

/* ===== GLITCH ===== */
.glitch { position:relative; animation:glitch-main 2.5s infinite; }
.glitch::before, .glitch::after { content:attr(data-text); position:absolute; top:0; left:0; width:100%; overflow:hidden; }
.glitch::before { color:#0ff; clip-path:polygon(0 15%,100% 15%,100% 30%,0 30%); animation:glitch-top 2.5s infinite; opacity:0.8; }
.glitch::after  { color:#f0f; clip-path:polygon(0 65%,100% 65%,100% 80%,0 80%); animation:glitch-bot 2.5s infinite; opacity:0.8; }
@keyframes glitch-main { 0%,82%,100%{transform:none} 84%{transform:skewX(-3deg) scaleX(1.01)} 86%{transform:skewX(3deg)} 88%{transform:skewX(-1deg)} 90%{transform:none} }
@keyframes glitch-top { 0%,81%,100%{transform:none;opacity:0} 82%{transform:translate(-4px,2px);opacity:0.8;color:#f0f} 84%{transform:translate(4px,-2px);opacity:0.8;color:#0ff} 86%{transform:none;opacity:0} }
@keyframes glitch-bot { 0%,80%,100%{transform:none;opacity:0} 81%{transform:translate(4px,2px);opacity:0.8;color:#ff0} 83%{transform:translate(-4px,-2px);opacity:0.8;color:#f0f} 85%{transform:none;opacity:0} }
@keyframes blink { 0%,100%{opacity:1} 50%{opacity:0} }
@keyframes pulse-glow { 0%,100%{filter:drop-shadow(0 0 16px rgba(0,255,255,0.5))} 50%{filter:drop-shadow(0 0 32px rgba(0,255,255,0.9))} }

/* ===== BOOT SCREEN ===== */
#screen-boot { gap:8px; background:radial-gradient(ellipse 90% 70% at 50% 60%, #020b1a 0%, #000 100%); padding-bottom:8px !important; }
#matrix-canvas { position:absolute; inset:0; z-index:1; pointer-events:none; opacity:0.18; }
.boot-logo-wrap { margin-bottom:4px; filter:drop-shadow(0 0 24px rgba(0,255,255,0.7)); animation:pulse-glow 2.5s ease-in-out infinite; z-index:2; }
.boot-title {
  font-family:'Orbitron',monospace; font-weight:900;
  font-size:clamp(2rem,5.5vw,4rem); color:#fff;
  letter-spacing:10px; text-transform:uppercase;
  text-shadow:0 0 20px #0ff,0 0 50px #0ff8,0 0 100px #0ff3;
  z-index:2; position:relative;
  animation:title-powerup 1.2s steps(1,end) 0.3s both;
}
@keyframes title-powerup {
  0%  {opacity:0;text-shadow:none;letter-spacing:2px}
  30% {opacity:0.7;color:#0ff;text-shadow:0 0 30px #0ff;letter-spacing:4px}
  60% {opacity:0.9;color:#8ff;letter-spacing:8px}
  100%{opacity:1;color:#fff;letter-spacing:10px;text-shadow:0 0 20px #0ff,0 0 50px #0ff8,0 0 100px #0ff3}
}
.boot-subtitle { font-size:clamp(0.85rem,2.2vw,1.3rem); color:rgba(0,255,255,0.65); letter-spacing:6px; text-transform:uppercase; z-index:2; }
.boot-version { font-size:clamp(0.55rem,1vw,0.7rem); color:rgba(0,255,255,0.35); letter-spacing:3px; margin-top:2px; z-index:2; }
.boot-prompt {
  font-size:clamp(0.85rem,2vw,1.15rem); color:#0ff; letter-spacing:4px;
  animation:blink 1s step-end infinite; margin-top:8px; z-index:2;
  padding:6px 20px; border:1px solid rgba(0,255,255,0.3);
  background:rgba(0,255,255,0.04);
  clip-path:polygon(8px 0%,100% 0%,calc(100% - 8px) 100%,0% 100%);
}
.boot-terminal {
  font-size:clamp(0.5rem,1.1vw,0.68rem); color:rgba(0,255,255,0.55); letter-spacing:1px;
  line-height:1.75; text-align:left; width:clamp(220px,60vw,520px);
  max-height:90px; overflow:hidden; margin-bottom:4px; z-index:2;
  background:rgba(0,255,255,0.02); border-left:2px solid rgba(0,255,255,0.2);
  padding:4px 8px;
}
.boot-terminal .bt-line { opacity:0; animation:bt-appear 0.1s forwards; }
@keyframes bt-appear { to{opacity:1} }
/* Boot progress bar */
.boot-progress-wrap { width:clamp(180px,50vw,400px); height:4px; background:rgba(0,255,255,0.1); border:1px solid rgba(0,255,255,0.2); z-index:2; }
.boot-progress-bar { height:100%; width:0%; background:linear-gradient(90deg,#0ff,#0f8); box-shadow:0 0 6px #0ff; transition:width 0.15s ease; }

/* ===== CONTENT PANEL ===== */
.content-panel {
  background: rgba(0,6,18,0.92);
  border: 1px solid rgba(0,255,255,0.22);
  backdrop-filter: blur(8px);
  padding: clamp(10px,1.5vw,18px);
  max-width: 860px; width: 94%;
  flex: 0 1 auto;
  min-height: 0;
  overflow-y: auto;
  box-shadow: 0 0 0 1px rgba(0,255,255,0.08), 0 0 50px rgba(0,200,255,0.08), inset 0 0 30px rgba(0,10,30,0.6);
  position: relative;
}
/* Cyberpunk corner brackets */
.content-panel::after {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0; bottom: 0;
  pointer-events: none;
  background:
    linear-gradient(to right,  rgba(0,255,255,0.6) 12px, transparent 12px) top left / 12px 2px no-repeat,
    linear-gradient(to bottom, rgba(0,255,255,0.6) 12px, transparent 12px) top left / 2px 12px no-repeat,
    linear-gradient(to left,   rgba(0,255,255,0.6) 12px, transparent 12px) top right / 12px 2px no-repeat,
    linear-gradient(to bottom, rgba(0,255,255,0.6) 12px, transparent 12px) top right / 2px 12px no-repeat,
    linear-gradient(to right,  rgba(0,255,255,0.6) 12px, transparent 12px) bottom left / 12px 2px no-repeat,
    linear-gradient(to top,    rgba(0,255,255,0.6) 12px, transparent 12px) bottom left / 2px 12px no-repeat,
    linear-gradient(to left,   rgba(0,255,255,0.6) 12px, transparent 12px) bottom right / 12px 2px no-repeat,
    linear-gradient(to top,    rgba(0,255,255,0.6) 12px, transparent 12px) bottom right / 2px 12px no-repeat;
}
/* Unit color accent bar */
.content-panel::before {
  content: '';
  display: block;
  height: 3px;
  background: var(--unit-color, linear-gradient(90deg, transparent, #0ff, transparent));
  margin-bottom: 12px;
  box-shadow: 0 0 8px var(--unit-glow, rgba(0,255,255,0.5));
}
/* Scrollbar */
.content-panel::-webkit-scrollbar { width:5px; }
.content-panel::-webkit-scrollbar-track { background:rgba(0,255,255,0.05); }
.content-panel::-webkit-scrollbar-thumb { background:rgba(0,255,255,0.35); border-radius:2px; box-shadow:0 0 4px rgba(0,255,255,0.4); }

/* Traveling border light */
@keyframes border-travel {
  0%   { background-position: 0% 0%, 100% 0%, 100% 100%, 0% 100%; }
  100% { background-position: 100% 0%, 100% 100%, 0% 100%, 0% 0%; }
}

/* ===== FLOOR HEADER ===== */
.floor-header {
  font-family: 'Orbitron', monospace;
  font-size: clamp(0.9rem,2.2vw,1.35rem);
  letter-spacing: 4px;
  color: #0ff;
  text-align: center;
  margin-bottom: 10px;
  text-shadow: 0 0 12px #0ff,0 0 24px #0ff6;
}
.floor-header span.cn-text { font-size:0.75em; }
.unit-tag {
  display: inline-block;
  font-family: 'Orbitron', monospace;
  font-size: 0.65rem;
  letter-spacing: 3px;
  padding: 3px 10px;
  border: 1px solid currentColor;
  margin-bottom: 7px;
  opacity: 0.9;
  text-transform: uppercase;
  background: rgba(0,255,255,0.05);
}

/* ===== QUESTION BOX ===== */
.question-box {
  font-size: clamp(1.05rem,2.4vw,1.5rem);
  color: #cce8ff;
  line-height: 1.65;
  text-align: center;
  padding: 14px 18px;
  border: 1px solid rgba(0,255,255,0.18);
  border-left: 3px solid rgba(0,255,255,0.3);
  background: linear-gradient(135deg, rgba(0,20,50,0.5) 0%, rgba(0,10,30,0.3) 100%);
  margin-bottom: 10px;
  position: relative;
}
.scenario-box {
  font-size: clamp(0.8rem,1.6vw,1rem);
  color: rgba(200,220,255,0.8);
  line-height: 1.6;
  text-align: left;
  padding: 10px 14px;
  border: 1px solid rgba(150,100,255,0.2);
  background: rgba(80,0,160,0.06);
  margin-bottom: 8px;
  font-style: italic;
}

/* ===== ANSWER BUTTONS (MCQ/Scenario) ===== */
.answers-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}
@media (max-width: 540px) { .answers-grid { grid-template-columns: 1fr; } }
.answer-btn {
  font-family: 'Share Tech Mono', monospace;
  font-size: clamp(0.9rem,1.9vw,1.15rem);
  line-height: 1.45;
  color: #a8e4ff;
  background: linear-gradient(135deg, rgba(0,20,50,0.85) 0%, rgba(0,35,75,0.75) 100%);
  border: 1px solid rgba(0,200,255,0.45);
  border-left: 3px solid rgba(0,220,255,0.7);
  padding: 9px 14px;
  cursor: pointer;
  text-align: left;
  transition: all 0.2s;
  clip-path: polygon(6px 0%,100% 0%,calc(100% - 6px) 100%,0% 100%);
  position: relative; overflow: hidden;
  min-height: 52px;
  overflow-wrap: break-word;
  word-break: break-word;
  box-shadow: inset 0 0 12px rgba(0,100,200,0.12), 0 0 0 1px rgba(0,150,255,0.08);
}
.answer-btn::before { content:''; position:absolute; top:0; left:-110%; width:100%; height:100%; background:linear-gradient(90deg,transparent,rgba(0,200,255,0.1),transparent); transition:left 0.4s; }
.answer-btn:not(:disabled):hover::before { left:110%; }
.answer-btn:not(:disabled):hover { border-color:#0ff; color:#fff; background:rgba(0,255,255,0.1); box-shadow:0 0 16px rgba(0,200,255,0.3),inset 0 0 20px rgba(0,200,255,0.05); }
.answer-btn:disabled { cursor:default; }
.answer-btn.correct { border-color:#0f8!important; color:#0f8!important; background:rgba(0,200,100,0.1)!important; box-shadow:0 0 12px rgba(0,200,80,0.4)!important; }
.answer-btn.wrong   { border-color:#f44!important; color:#f44!important; background:rgba(255,50,50,0.1)!important; box-shadow:0 0 12px rgba(255,50,50,0.4)!important; animation:shake 0.5s ease; }
@keyframes shake { 0%,100%{transform:translateX(0)} 15%,45%,75%{transform:translateX(-7px)} 30%,60%,90%{transform:translateX(7px)} }

/* ===== TRUE/FALSE ===== */
.tf-buttons { display:flex; gap:14px; justify-content:center; margin-top:4px; }
.tf-btn {
  font-family: 'Orbitron', monospace;
  font-size: clamp(0.9rem,2vw,1.3rem);
  letter-spacing: 4px;
  font-weight: 700;
  padding: 14px 36px;
  cursor: pointer;
  border: 2px solid;
  background: transparent;
  transition: all 0.2s;
  min-height: 54px;
  clip-path: polygon(8px 0%,100% 0%,calc(100% - 8px) 100%,0% 100%);
}
.tf-btn.true-btn  { color:#0ff; border-color:rgba(0,255,255,0.4); }
.tf-btn.false-btn { color:#f80; border-color:rgba(255,128,0,0.4); }
.tf-btn:not(:disabled):hover { box-shadow:0 0 20px; opacity:1; }
.tf-btn.true-btn:not(:disabled):hover  { box-shadow:0 0 20px rgba(0,255,255,0.5); border-color:#0ff; color:#fff; }
.tf-btn.false-btn:not(:disabled):hover { box-shadow:0 0 20px rgba(255,128,0,0.5); border-color:#f80; color:#fff; }
.tf-btn:disabled { cursor:default; opacity:0.7; }
.tf-btn.correct { border-color:#0f8!important; color:#0f8!important; box-shadow:0 0 16px rgba(0,200,80,0.5)!important; }
.tf-btn.wrong   { border-color:#f44!important; color:#f44!important; box-shadow:0 0 16px rgba(255,50,50,0.5)!important; animation:shake 0.5s ease; }

/* ===== FILL IN BLANK ===== */
.fill-input-wrap { display:flex; gap:8px; align-items:stretch; margin-top:4px; }
.fill-input {
  flex:1;
  font-family: 'Share Tech Mono', monospace;
  font-size: clamp(0.9rem,1.8vw,1.15rem);
  color: #0ff;
  background: rgba(0,20,40,0.7);
  border: 1px solid rgba(0,255,255,0.3);
  padding: 10px 14px;
  outline: none;
  transition: border-color 0.2s;
  letter-spacing: 2px;
}
.fill-input:focus { border-color:#0ff; box-shadow:0 0 10px rgba(0,255,255,0.2); }
.fill-input::placeholder { color:rgba(0,255,255,0.25); }
.fill-submit {
  font-family: 'Orbitron', monospace;
  font-size: 0.7rem;
  letter-spacing: 2px;
  color: #0ff;
  background: rgba(0,20,40,0.8);
  border: 1px solid rgba(0,255,255,0.4);
  padding: 10px 18px;
  cursor: pointer;
  transition: all 0.2s;
  clip-path: polygon(5px 0%,100% 0%,calc(100% - 5px) 100%,0% 100%);
}
.fill-submit:hover { border-color:#0ff; color:#fff; box-shadow:0 0 12px rgba(0,255,255,0.3); }
.fill-hint { font-size:clamp(0.65rem,1.2vw,0.8rem); color:rgba(0,255,255,0.3); letter-spacing:1px; margin-top:6px; text-align:center; }
.fill-blank-highlight { color:#ff0; border-bottom:2px solid #ff0; padding:0 4px; }

/* ===== MATCHING ===== */
.match-wrapper {
  display: flex;
  gap: clamp(8px,2vw,20px);
  align-items: flex-start;
  width: 100%;
}
.match-col { flex:1; min-width:0; }
.match-col-label { font-family:'Orbitron',monospace; font-size:0.6rem; letter-spacing:3px; color:rgba(0,180,255,0.6); text-align:center; margin-bottom:8px; padding-bottom:5px; border-bottom:1px solid rgba(0,255,255,0.15); }
.match-item {
  font-size: clamp(0.7rem,1.4vw,0.9rem);
  color: #7ac;
  background: rgba(0,20,40,0.6);
  border: 1px solid rgba(0,180,255,0.25);
  padding: 7px 10px;
  margin-bottom: 5px;
  cursor: pointer;
  transition: all 0.2s;
  line-height: 1.3;
  min-height: 38px;
  overflow-wrap: break-word;
}
.match-item:hover { border-color:#0ff; color:#fff; background:rgba(0,255,255,0.06); }
.match-item.selected { border-color:#ff0!important; color:#ff0!important; background:rgba(255,255,0,0.06)!important; box-shadow:0 0 10px rgba(255,255,0,0.3)!important; }
.match-item.matched-correct { border-color:#0f8!important; color:#0f8!important; background:rgba(0,200,80,0.1)!important; cursor:default; }
.match-item.matched-wrong   { border-color:#f44!important; color:#f44!important; background:rgba(255,50,50,0.1)!important; animation:shake 0.4s ease; }
.match-item.disabled-item   { cursor:default; opacity:0.5; pointer-events:none; }

/* ===== FEEDBACK ===== */
.feedback-row { display:flex; justify-content:center; margin-top:8px; min-height:0; }
.feedback-msg { font-size:clamp(0.75rem,1.4vw,0.95rem); letter-spacing:2px; padding:4px 12px; border:1px solid; }
.feedback-msg.ok  { color:#0f8; border-color:#0f84; background:rgba(0,200,80,0.06); }
.feedback-msg.err { color:#f44; border-color:#f444; background:rgba(255,50,50,0.06); }
.hidden { display:none!important; }

/* ===== CONTINUE BUTTON ===== */
.continue-btn {
  font-family: 'Orbitron', monospace;
  font-size: clamp(0.65rem,1.4vw,0.85rem);
  letter-spacing: 3px;
  text-transform: uppercase;
  color: #0ff;
  background: transparent;
  border: 2px solid rgba(0,255,255,0.4);
  padding: 9px 24px;
  cursor: pointer;
  transition: all 0.25s;
  clip-path: polygon(8px 0%,100% 0%,calc(100% - 8px) 100%,0% 100%);
  margin-top: 12px;
}
.continue-btn:hover { border-color:#0ff; color:#fff; box-shadow:0 0 20px rgba(0,255,255,0.3); }

/* ===== GENERIC BTN ===== */
.btn {
  font-family: 'Orbitron', monospace;
  font-size: clamp(0.7rem,1.5vw,0.9rem);
  letter-spacing: 3px;
  text-transform: uppercase;
  color: #0ff;
  background: transparent;
  border: 2px solid rgba(0,255,255,0.4);
  padding: 9px 22px;
  cursor: pointer;
  transition: all 0.25s;
  clip-path: polygon(8px 0%,100% 0%,calc(100% - 8px) 100%,0% 100%);
  position: relative; overflow: hidden;
}
.btn::before { content:''; position:absolute; top:0; left:-110%; width:100%; height:100%; background:linear-gradient(90deg,transparent,rgba(0,255,255,0.18),transparent); transition:left 0.5s; }
.btn:hover::before { left:110%; }
.btn:hover { border-color:#0ff; color:#fff; box-shadow:0 0 24px rgba(0,255,255,0.35); }
.btn:active { transform:scale(0.95); }

/* ===== DRAG AND DROP ===== */
#screen-floordnd .content-panel { max-width:860px; }
.dnd-wrapper { display:flex; gap:clamp(10px,2vw,22px); align-items:flex-start; }
.dnd-col { flex:1; min-width:0; }
.dnd-col-label { font-family:'Orbitron',monospace; font-size:0.6rem; letter-spacing:3px; color:rgba(0,180,255,0.6); text-align:center; margin-bottom:7px; padding-bottom:5px; border-bottom:1px solid rgba(0,255,255,0.15); }
@media (max-width: 600px) { .dnd-wrapper { flex-direction:column; } }
.data-drive {
  display:flex; align-items:center; gap:7px;
  background:linear-gradient(135deg,#061424 0%,#0c2040 100%);
  border:1px solid rgba(0,180,255,0.35);
  padding:6px 9px; margin-bottom:5px;
  cursor:grab;
  font-size:clamp(0.65rem,1.3vw,0.9rem);
  color:#7ce0ff;
  transition:all 0.2s;
  user-select:none;
  clip-path:polygon(4px 0%,100% 0%,calc(100% - 4px) 100%,0% 100%);
  overflow-wrap:break-word;
}
.data-drive:hover { border-color:#0ff; box-shadow:0 0 12px rgba(0,255,255,0.25); transform:translateX(3px); }
.data-drive.dragging { opacity:0.4; cursor:grabbing; }
.data-drive.placed { opacity:0.3; cursor:default; pointer-events:none; }
.drive-icon { font-size:0.75rem; flex-shrink:0; }
.drive-label { flex:1; line-height:1.3; }
.server-slot {
  display:flex; align-items:center; gap:7px;
  border:1px dashed rgba(0,180,80,0.4);
  min-height:36px;
  padding:5px 9px; margin-bottom:5px;
  font-size:clamp(0.55rem,1vw,0.72rem);
  color:rgba(0,180,80,0.5);
  transition:all 0.2s;
  background:rgba(0,20,10,0.4);
  clip-path:polygon(4px 0%,100% 0%,calc(100% - 4px) 100%,0% 100%);
  overflow-wrap:break-word;
}
.server-slot.drag-over { border-color:#0ff; background:rgba(0,255,255,0.07); box-shadow:0 0 10px rgba(0,255,255,0.3) inset; }
.server-slot.filled { border-style:solid; border-color:rgba(0,180,255,0.4); color:#7ce0ff; }
.server-slot.correct-slot { border-color:#0f8!important; background:rgba(0,200,80,0.1)!important; box-shadow:0 0 12px rgba(0,200,80,0.3)!important; animation:slot-accept 0.5s ease; }
.server-slot.wrong-slot   { border-color:#f44!important; background:rgba(255,50,50,0.1)!important; animation:flash-red 0.6s ease; }
@keyframes slot-accept { 0%{transform:scaleX(1)} 50%{transform:scaleX(1.03);box-shadow:0 0 20px rgba(0,255,128,0.6)} 100%{transform:scaleX(1)} }
@keyframes flash-red   { 0%,100%{background:rgba(255,50,50,0.1)} 50%{background:rgba(255,50,50,0.25)} }
.slot-num { font-family:'Orbitron',monospace; font-size:0.65rem; color:rgba(0,180,80,0.5); flex-shrink:0; width:14px; }
.slot-content { flex:1; line-height:1.3; }
.slot-empty-label { font-style:italic; opacity:0.5; font-size:0.6rem; }
.remove-btn { font-size:0.65rem; cursor:pointer; color:rgba(255,100,100,0.5); flex-shrink:0; background:none; border:none; padding:2px 4px; line-height:1; transition:color 0.15s; }
.remove-btn:hover { color:#f55; }
.dnd-actions { display:flex; justify-content:center; gap:12px; margin-top:8px; }

/* ===== DIALOGUE BOX ===== */
#dialogue-box {
  position: absolute;
  bottom: 0; left: 0; right: 0;
  height: 22%;
  background: linear-gradient(to top, rgba(0,3,14,0.98) 0%, rgba(0,6,22,0.94) 100%);
  border-top: 2px solid rgba(0,255,255,0.4);
  display: flex;
  align-items: center;
  padding: 8px 16px;
  gap: 14px;
  z-index: 60;
}
#dialogue-box.hidden { transform:translateY(100%); opacity:0; pointer-events:none; }
#dialogue-box:not(.hidden) { animation:materialize 0.4s ease forwards; }
@keyframes materialize { 0%{transform:translateY(20px) scaleY(0.8);opacity:0;filter:blur(4px)} 60%{transform:translateY(-3px) scaleY(1.02);opacity:0.9;filter:blur(0)} 100%{transform:translateY(0) scaleY(1);opacity:1;filter:blur(0)} }
#dialogue-box::before { content:''; position:absolute; top:0; left:0; right:0; height:1px; background:linear-gradient(90deg,transparent 0%,rgba(0,255,255,0.2) 20%,#0ff 50%,rgba(0,255,255,0.2) 80%,transparent 100%); animation:scan-line-h 3s ease-in-out infinite; }
@keyframes scan-line-h { 0%,100%{opacity:0.6} 50%{opacity:1} }
#dialogue-box::after { content:'AEGIS v3.0'; position:absolute; top:4px; right:14px; font-family:'Orbitron',monospace; font-size:0.45rem; letter-spacing:2px; color:rgba(0,255,255,0.3); }
.aegis-avatar { flex-shrink:0; width:clamp(50px,7vw,80px); height:clamp(50px,7vw,80px); filter:drop-shadow(0 0 10px rgba(0,255,255,0.7)); animation:aegis-idle 3s ease-in-out infinite; }
@keyframes aegis-idle { 0%,100%{filter:drop-shadow(0 0 10px rgba(0,255,255,0.6))} 50%{filter:drop-shadow(0 0 22px rgba(0,255,255,1))} }
.aegis-avatar.talking { animation:aegis-talk 0.35s ease-in-out infinite; }
@keyframes aegis-talk { 0%,100%{transform:scale(1)} 50%{transform:scale(1.05)} }
.aegis-avatar.alarmed { filter:drop-shadow(0 0 14px rgba(255,50,50,0.9))!important; animation:aegis-alarm 0.3s ease-in-out infinite; }
@keyframes aegis-alarm { 0%,100%{transform:scale(1)} 50%{transform:scale(1.07)} }
.dialogue-content { flex:1; min-width:0; display:flex; flex-direction:column; justify-content:center; gap:3px; }
#dialogue-speaker { font-family:'Orbitron',monospace; font-size:clamp(0.6rem,1.1vw,0.8rem); letter-spacing:5px; color:#0ff; text-shadow:0 0 10px #0ff,0 0 20px #0ff6; margin-bottom:2px; }
#dialogue-text-en { font-size:clamp(0.88rem,1.7vw,1.1rem); color:#d0e8ff; line-height:1.45; min-height:1.4em; }
#dialogue-text-zh { font-family:'Noto Sans SC',sans-serif; font-size:clamp(0.72rem,1.3vw,0.9rem); color:rgba(100,200,255,0.65); line-height:1.4; min-height:1.3em; margin-top:2px; }
#dialogue-continue { font-size:0.62rem; color:rgba(0,255,255,0.6); letter-spacing:3px; margin-top:3px; animation:blink 0.9s step-end infinite; display:none; }

/* ===== WIN SCREEN ===== */
#screen-win { background:radial-gradient(ellipse 80% 60% at 50% 60%, #020d05 0%, #000 100%); gap:10px; padding-bottom:8px !important; }
.win-title { font-family:'Orbitron',monospace; font-weight:900; font-size:clamp(1.4rem,4vw,2.8rem); color:#0f8; letter-spacing:6px; text-shadow:0 0 20px #0f8,0 0 50px #0f84; animation:win-pulse 2s ease-in-out infinite; z-index:10; }
@keyframes win-pulse { 0%,100%{text-shadow:0 0 20px #0f8,0 0 50px #0f84} 50%{text-shadow:0 0 40px #0f8,0 0 80px #0f8,0 0 120px #0f86} }
.win-sub { font-size:clamp(0.6rem,1.3vw,0.8rem); color:rgba(0,255,128,0.6); letter-spacing:4px; text-align:center; z-index:10; }
.win-stats { font-size:clamp(0.55rem,1vw,0.7rem); color:rgba(0,255,128,0.45); letter-spacing:2px; text-align:center; z-index:10; }
.win-knowledge { z-index:10; max-width:600px; width:90%; background:rgba(0,20,10,0.7); border:1px solid rgba(0,200,80,0.2); padding:10px 14px; margin-top:4px; }
.win-knowledge-title { font-family:'Orbitron',monospace; font-size:0.6rem; letter-spacing:3px; color:rgba(0,255,128,0.7); margin-bottom:7px; }
.win-knowledge-list { font-size:0.6rem; color:rgba(0,255,128,0.5); line-height:1.8; columns:2; column-gap:16px; }
.win-helicopter { position:absolute; bottom:15%; font-size:clamp(1rem,2.5vw,1.8rem); opacity:0; animation:heli-rise 3s ease-out 0.5s forwards; filter:drop-shadow(0 0 8px rgba(0,255,128,0.8)); left:50%; transform:translateX(-50%); z-index:6; }
@keyframes heli-rise { 0%{bottom:5%;opacity:0} 30%{opacity:0.8} 100%{bottom:70%;opacity:0} }
@keyframes spin-rays { from{transform:translate(-50%,-50%) rotate(0deg)} to{transform:translate(-50%,-50%) rotate(360deg)} }

/* ===== FLOOR TRANSITION ===== */
.floor-transition { position:absolute; inset:0; background:rgba(0,2,10,0.96); display:flex; flex-direction:column; align-items:center; justify-content:center; z-index:200; gap:14px; }
.ft-hex { font-size:clamp(1.8rem,5vw,3.5rem); color:#0ff; animation:ft-spin 0.8s linear infinite; text-shadow:0 0 20px #0ff; }
@keyframes ft-spin { from{transform:rotate(0deg)} to{transform:rotate(360deg)} }
.ft-text { font-family:'Orbitron',monospace; font-size:clamp(0.7rem,1.8vw,1.1rem); color:#0ff; letter-spacing:6px; text-shadow:0 0 12px #0ff; }
.ft-cn   { font-family:'Noto Sans SC',sans-serif; font-size:clamp(0.55rem,1.3vw,0.8rem); color:rgba(100,220,255,0.65); letter-spacing:2px; }
.ft-bar-wrap { width:clamp(140px,30vw,260px); height:3px; background:rgba(0,255,255,0.15); border:1px solid rgba(0,255,255,0.3); }
.ft-bar { height:100%; width:0%; background:linear-gradient(90deg,#0ff,#0f8); box-shadow:0 0 6px #0ff; transition:width 0.7s ease; }

/* ===== OVERLAYS ===== */
.correct-overlay { position:absolute; inset:0; background:radial-gradient(circle at 50% 50%,rgba(0,255,128,0.18) 0%,transparent 70%); z-index:150; pointer-events:none; animation:correct-pulse 0.8s ease-out forwards; }
@keyframes correct-pulse { 0%{opacity:0;transform:scale(0.8)} 30%{opacity:1;transform:scale(1)} 100%{opacity:0;transform:scale(1.1)} }
.wrong-overlay { position:absolute; inset:0; background:rgba(255,30,30,0.2); z-index:150; pointer-events:none; animation:wrong-flash 0.6s ease-out forwards; }
@keyframes wrong-flash { 0%,40%{opacity:1} 100%{opacity:0} }
@keyframes screen-shake { 0%,100%{transform:translateX(0)} 15%,45%,75%{transform:translateX(-8px)} 30%,60%,90%{transform:translateX(8px)} }
#game-wrapper.shake { animation:screen-shake 0.5s ease; }

/* ===== EXIT MODAL ===== */
#exit-modal {
  position: absolute; inset: 0;
  background: rgba(0,0,0,0.7);
  display: flex; align-items: center; justify-content: center;
  z-index: 300;
  backdrop-filter: blur(4px);
}
.exit-modal-box {
  background: rgba(0,8,20,0.95);
  border: 2px solid rgba(0,255,255,0.4);
  padding: 28px 36px;
  text-align: center;
  box-shadow: 0 0 40px rgba(0,255,255,0.2);
  max-width: 380px; width: 85%;
}
.exit-modal-title { font-family:'Orbitron',monospace; font-size:clamp(0.9rem,2vw,1.2rem); font-weight:700; letter-spacing:5px; color:#0ff; text-shadow:0 0 12px #0ff; margin-bottom:6px; }
.exit-modal-sub   { font-family:'Noto Sans SC',sans-serif; font-size:0.8rem; color:rgba(100,200,255,0.6); letter-spacing:2px; margin-bottom:18px; }
.exit-modal-btns  { display:flex; gap:14px; justify-content:center; }
.exit-yes { font-family:'Orbitron',monospace; font-size:0.7rem; letter-spacing:3px; color:#f44; background:transparent; border:2px solid rgba(255,50,50,0.5); padding:8px 22px; cursor:pointer; clip-path:polygon(6px 0%,100% 0%,calc(100% - 6px) 100%,0% 100%); transition:all 0.2s; }
.exit-yes:hover { border-color:#f44; box-shadow:0 0 14px rgba(255,50,50,0.4); color:#fff; }
.exit-no  { font-family:'Orbitron',monospace; font-size:0.7rem; letter-spacing:3px; color:#0ff; background:transparent; border:2px solid rgba(0,255,255,0.5); padding:8px 22px; cursor:pointer; clip-path:polygon(6px 0%,100% 0%,calc(100% - 6px) 100%,0% 100%); transition:all 0.2s; }
.exit-no:hover  { border-color:#0ff; box-shadow:0 0 14px rgba(0,255,255,0.4); color:#fff; }

/* ===== BILINGUAL ===== */
.cn-text { display:block; font-family:'Noto Sans SC','PingFang SC','Microsoft YaHei',sans-serif; font-size:0.85em; color:rgba(100,220,255,0.65); margin-top:6px; font-weight:400; letter-spacing:0.5px; }
.type-cursor { animation:blink 0.6s step-end infinite; color:#0ff; }

/* ===== MUTE BUTTON ===== */
#mute-btn {
  font-family: 'Orbitron', monospace;
  font-size: 0.6rem;
  letter-spacing: 1px;
  color: rgba(0,255,255,0.5);
  background: transparent;
  border: 1px solid rgba(0,255,255,0.2);
  padding: 3px 8px;
  cursor: pointer;
  pointer-events: all;
  transition: all 0.2s;
}
#mute-btn:hover { color:#0ff; border-color:#0ff; box-shadow:0 0 6px rgba(0,255,255,0.3); }
#mute-btn.muted { color:rgba(255,80,80,0.6); border-color:rgba(255,80,80,0.3); }
/* ===== CYBERPUNK INFO BADGE ===== */
.q-type-badge {
  position: absolute;
  top: -1px; right: 20px;
  font-family: 'Orbitron', monospace;
  font-size: 0.5rem;
  letter-spacing: 2px;
  padding: 2px 8px;
  background: rgba(0,255,255,0.08);
  border: 1px solid rgba(0,255,255,0.2);
  border-top: none;
  color: rgba(0,255,255,0.55);
  text-transform: uppercase;
}
/* ===== UTILITY ===== */
.tc { text-align:center; }
</style>
</head>
<body>
<div id="game-wrapper">

  <!-- ===== BACKGROUNDS ===== -->
  <div class="bg-grid"></div>
  <div class="bg-hex-grid"></div>
  <div class="bg-city">
    <svg viewBox="0 0 1280 260" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMax meet">
      <defs>
        <linearGradient id="sky-grad" x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stop-color="#000814" stop-opacity="0"/>
          <stop offset="100%" stop-color="#000814" stop-opacity="1"/>
        </linearGradient>
        <filter id="glow-city">
          <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
          <feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge>
        </filter>
      </defs>
      <g fill="#060d1a" filter="url(#glow-city)">
        <rect x="0" y="180" width="60" height="80"/><rect x="55" y="160" width="40" height="100"/>
        <rect x="90" y="140" width="55" height="120"/><rect x="140" y="170" width="35" height="90"/>
        <rect x="170" y="150" width="50" height="110"/><rect x="215" y="120" width="65" height="140"/>
        <rect x="275" y="160" width="40" height="100"/><rect x="310" y="100" width="80" height="160"/>
        <rect x="385" y="150" width="45" height="110"/><rect x="425" y="130" width="60" height="130"/>
        <rect x="480" y="80" width="90" height="180"/><rect x="565" y="140" width="50" height="120"/>
        <rect x="610" y="110" width="70" height="150"/><rect x="675" y="90" width="85" height="170"/>
        <rect x="755" y="150" width="45" height="110"/><rect x="795" y="120" width="65" height="140"/>
        <rect x="855" y="75" width="95" height="185"/><rect x="945" y="145" width="50" height="115"/>
        <rect x="990" y="105" width="75" height="155"/><rect x="1060" y="135" width="55" height="125"/>
        <rect x="1110" y="160" width="40" height="100"/><rect x="1145" y="115" width="70" height="145"/>
        <rect x="1210" y="155" width="45" height="105"/><rect x="1250" y="130" width="30" height="130"/>
      </g>
      <g>
        <rect x="488" y="100" width="4" height="3" fill="rgba(255,220,100,0.7)"/><rect x="496" y="100" width="4" height="3" fill="rgba(255,220,100,0.5)"/>
        <rect x="504" y="100" width="4" height="3" fill="rgba(255,220,100,0.7)"/><rect x="488" y="108" width="4" height="3" fill="rgba(255,220,100,0.4)"/>
        <rect x="862" y="90" width="4" height="3" fill="rgba(255,220,100,0.6)"/><rect x="870" y="90" width="4" height="3" fill="rgba(255,220,100,0.7)"/>
        <rect x="315" y="115" width="4" height="3" fill="rgba(100,200,255,0.5)"/><rect x="323" y="115" width="4" height="3" fill="rgba(100,200,255,0.7)"/>
        <rect x="683" y="105" width="4" height="3" fill="rgba(255,180,100,0.6)"/><rect x="691" y="105" width="4" height="3" fill="rgba(255,180,100,0.4)"/>
      </g>
      <rect x="0" y="245" width="1280" height="15" fill="rgba(0,80,160,0.15)"/>
      <rect x="0" y="0" width="1280" height="260" fill="url(#sky-grad)"/>
    </svg>
  </div>
  <div class="bg-glow"></div>
  <div class="bg-scanlines"></div>
  <canvas id="particles-canvas" style="position:absolute;inset:0;z-index:3;pointer-events:none;opacity:0.35;"></canvas>

  <!-- ===== HUD ===== -->
  <div id="hud">
    <div class="hud-left">
      <button id="exit-btn">&#9664; EXIT</button>
      <div class="hud-divider"></div>
      <div class="hud-logo">NexCorp Sec</div>
      <div class="hud-divider"></div>
      <div class="hud-floor" id="hud-floor">FLOOR 0</div>
      <div class="hud-divider"></div>
      <div class="hud-score" id="hud-score">SCR 0</div>
    </div>
    <div class="hud-center">
      <div id="hud-progress"></div>
      <div class="hud-ticker-wrap" style="margin-left:10px;"><div class="hud-ticker">NEXCORP SEC SYS v3.0 // BREACH ALERT // KNOWLEDGE VERIFICATION PROTOCOL ACTIVE // 安全验证协议 // AEGIS ONLINE //</div></div>
    </div>
    <div class="hud-right">
      <div class="hud-battery-wrap">
        <span>PWR</span>
        <div class="battery-bar" id="battery-bar">
          <div class="battery-seg" data-seg="1"></div><div class="battery-seg" data-seg="2"></div>
          <div class="battery-seg" data-seg="3"></div><div class="battery-seg" data-seg="4"></div>
          <div class="battery-seg" data-seg="5"></div><div class="battery-cap"></div>
        </div>
      </div>
      <div class="hud-divider"></div>
      <div class="hud-rec"><div class="rec-dot"></div>REC</div>
      <div class="hud-divider"></div>
      <div class="hud-clock" id="hud-clock">00:00:00</div>
      <div class="hud-divider"></div>
      <button id="mute-btn" title="Toggle ambient sound">&#9834;</button>
    </div>
  </div>

  <!-- ===== SCREEN: BOOT ===== -->
  <canvas id="matrix-canvas"></canvas>
  <div id="screen-boot" class="screen active">
    <div class="boot-logo-wrap">
      <svg width="80" height="80" viewBox="0 0 90 90" xmlns="http://www.w3.org/2000/svg">
        <circle cx="45" cy="45" r="44" fill="#050a14" stroke="#0ff" stroke-width="1.5" opacity="0.8"/>
        <circle cx="45" cy="45" r="36" fill="none" stroke="rgba(0,255,255,0.2)" stroke-width="1" stroke-dasharray="4 3"/>
        <polygon points="45,12 72,28 72,62 45,78 18,62 18,28" fill="none" stroke="#0ff" stroke-width="1.5" opacity="0.7"/>
        <circle cx="45" cy="45" r="14" fill="#061828" stroke="#0ff" stroke-width="1.5"/>
        <circle cx="45" cy="45" r="7" fill="#0ff" opacity="0.9"/>
        <circle cx="48" cy="42" r="2" fill="#fff" opacity="0.8"/>
        <line x1="31" y1="45" x2="59" y2="45" stroke="#0ff" stroke-width="0.7" opacity="0.5"/>
        <line x1="45" y1="6" x2="45" y2="10" stroke="#0ff" stroke-width="1.5" opacity="0.8"/>
        <line x1="45" y1="80" x2="45" y2="84" stroke="#0ff" stroke-width="1.5" opacity="0.8"/>
        <line x1="6" y1="45" x2="10" y2="45" stroke="#0ff" stroke-width="1.5" opacity="0.8"/>
        <line x1="80" y1="45" x2="84" y2="45" stroke="#0ff" stroke-width="1.5" opacity="0.8"/>
      </svg>
    </div>
    <h1 class="boot-title glitch" data-text="CORPORATE ESCAPE">CORPORATE ESCAPE</h1>
    <p class="boot-subtitle">NexCorp Tower &nbsp;//&nbsp; Security Breach Protocol</p>
    <p class="cn-text" style="text-align:center;font-size:clamp(0.55rem,1.4vw,0.8rem);letter-spacing:3px;color:rgba(0,255,255,0.45);margin-top:2px;">企业逃脱 // 奈克斯科普大厦入侵协议</p>
    <p class="boot-version">SYSTEM v3.0 &nbsp;|&nbsp; CLASSIFIED: TOP SECRET &nbsp;|&nbsp; 2026</p>
    <div id="boot-terminal" class="boot-terminal"></div>
    <div class="boot-progress-wrap" id="boot-progress-wrap" style="display:none;">
      <div class="boot-progress-bar" id="boot-progress-bar"></div>
    </div>
    <p class="boot-prompt" id="boot-prompt">&#9654; PRESS ANY KEY OR CLICK TO BEGIN &#9664;<span class="cn-text" style="font-size:0.7em;display:inline;margin-left:8px;">按任意键或点击开始</span></p>
  </div>

  <!-- ===== SCREEN: QUESTION (shared for MCQ / TF / Fill / Scenario) ===== -->
  <div id="screen-question" class="screen">
    <div class="content-panel" id="question-panel">
      <div class="unit-tag" id="q-unit-tag">UNIT 0</div>
      <div class="floor-header" id="q-floor-header">FLOOR 01 // LOBBY TERMINAL</div>
      <div class="question-box" id="q-text"></div>
      <!-- MCQ/Scenario answers -->
      <div class="answers-grid hidden" id="q-mcq-answers"></div>
      <!-- TF buttons -->
      <div class="tf-buttons hidden" id="q-tf-buttons">
        <button class="tf-btn true-btn" id="tf-true">TRUE &#10003;<span class="cn-text" style="font-size:0.5em;display:inline;margin-left:6px;">真</span></button>
        <button class="tf-btn false-btn" id="tf-false">FALSE &#10007;<span class="cn-text" style="font-size:0.5em;display:inline;margin-left:6px;">假</span></button>
      </div>
      <!-- Fill in blank -->
      <div class="hidden" id="q-fill-area">
        <div class="fill-input-wrap">
          <input type="text" class="fill-input" id="fill-input" placeholder="TYPE YOUR ANSWER // 输入答案" autocomplete="off" spellcheck="false"/>
          <button class="fill-submit" id="fill-submit">SUBMIT &#9654;</button>
        </div>
        <div class="fill-hint" id="fill-hint"></div>
      </div>
      <div class="feedback-row" id="q-feedback-row">
        <div id="q-feedback" class="feedback-msg hidden"></div>
      </div>
      <div style="display:flex;justify-content:center;">
        <button class="continue-btn hidden" id="q-continue">CONTINUE &nbsp;&#9654;&#9654;<span class="cn-text" style="font-size:0.65em;display:inline;margin-left:6px;">继续</span></button>
      </div>
    </div>
  </div>

  <!-- ===== SCREEN: MATCHING ===== -->
  <div id="screen-match" class="screen">
    <div class="content-panel" id="match-panel" style="max-width:780px;">
      <div class="unit-tag" id="match-unit-tag">UNIT 2</div>
      <div class="floor-header" id="match-floor-header">MATCH PAIRS // 配对</div>
      <div class="question-box" id="match-instruction" style="font-size:clamp(0.75rem,1.5vw,0.95rem);">
        Match each term to its correct definition. Click a term, then click its definition.
        <span class="cn-text">将每个术语与其正确定义配对。点击术语，然后点击其定义。</span>
      </div>
      <div class="match-wrapper" id="match-wrapper">
        <div class="match-col">
          <div class="match-col-label">&#9664; TERMS &#9654; <span style="font-family:'Noto Sans SC',sans-serif;font-size:0.85em;">术语</span></div>
          <div id="match-terms"></div>
        </div>
        <div class="match-col">
          <div class="match-col-label">&#9664; DEFINITIONS &#9654; <span style="font-family:'Noto Sans SC',sans-serif;font-size:0.85em;">定义</span></div>
          <div id="match-defs"></div>
        </div>
      </div>
      <div class="feedback-row" style="margin-top:10px;">
        <div id="match-feedback" class="feedback-msg hidden"></div>
      </div>
      <div style="display:flex;justify-content:center;">
        <button class="continue-btn hidden" id="match-continue">CONTINUE &nbsp;&#9654;&#9654;</button>
      </div>
    </div>
  </div>

  <!-- ===== SCREEN: DRAG-AND-DROP (Final Floor) ===== -->
  <div id="screen-floordnd" class="screen">
    <div class="content-panel" style="max-width:860px;width:94%;">
      <div class="unit-tag" style="color:#08f;border-color:#08f;">UNIT 2 — FINAL CHALLENGE</div>
      <div class="floor-header" id="dnd-floor-header">
        &#9672;&nbsp; FINAL FLOOR &nbsp;// MAINFRAME CORE &nbsp;&#9672;
        <span class="cn-text">主机核心 — 最终挑战</span>
      </div>
      <div class="question-box" style="font-size:clamp(0.7rem,1.3vw,0.9rem);margin-bottom:10px;">
        Arrange the Australian Court Hierarchy — Slot 1 = HIGHEST, Slot 5 = LOWEST.
        Drag each court to its correct position.
        <span class="cn-text">排列澳大利亚法院层级——插槽1=最高权威，插槽5=最低。将每个法院拖到正确位置。</span>
      </div>
      <div class="dnd-wrapper">
        <div class="dnd-col" id="drives-col">
          <div class="dnd-col-label">&#9664; DATA DRIVES &#9654; <span style="font-family:'Noto Sans SC',sans-serif;font-size:0.8em;color:rgba(100,220,255,0.6);">数据驱动器</span></div>
          <div id="drives-container"></div>
        </div>
        <div class="dnd-col" id="slots-col">
          <div class="dnd-col-label">&#9664; SERVER SLOTS &#9654; <span style="font-family:'Noto Sans SC',sans-serif;font-size:0.8em;color:rgba(100,220,255,0.6);">服务器插槽</span></div>
          <div id="slots-container"></div>
        </div>
      </div>
      <div class="dnd-actions">
        <button class="btn" id="dnd-submit-btn">SUBMIT &nbsp;&#9654;&#9654; <span style="font-family:'Noto Sans SC',sans-serif;font-size:0.75em;">提交</span></button>
        <button class="btn" id="dnd-reset-btn" style="border-color:rgba(255,100,100,0.4);color:rgba(255,150,150,0.8);">RESET <span style="font-family:'Noto Sans SC',sans-serif;font-size:0.75em;">重置</span></button>
      </div>
      <div class="feedback-row" style="margin-top:6px;"><div id="dnd-feedback" class="feedback-msg hidden"></div></div>
    </div>
  </div>

  <!-- ===== SCREEN: WIN ===== -->
  <div id="screen-win" class="screen">
    <div style="position:absolute;inset:0;pointer-events:none;z-index:5;overflow:hidden;">
      <div style="position:absolute;top:50%;left:50%;width:700px;height:700px;transform:translate(-50%,-50%);
        background:conic-gradient(rgba(0,255,128,0.04) 0deg,transparent 10deg,rgba(0,255,128,0.04) 20deg,transparent 30deg,rgba(0,255,128,0.04) 40deg,transparent 50deg,rgba(0,255,128,0.04) 60deg,transparent 70deg,rgba(0,255,128,0.04) 80deg,transparent 90deg,rgba(0,255,128,0.04) 100deg,transparent 110deg,rgba(0,255,128,0.04) 120deg,transparent 130deg);
        animation:spin-rays 20s linear infinite;border-radius:50%;">
      </div>
    </div>
    <div class="win-helicopter" id="win-heli">&#x1F681;</div>
    <div class="win-title glitch" data-text="ACCESS GRANTED" style="z-index:10;">ACCESS GRANTED</div>
    <p class="win-sub" style="z-index:10;">ESCAPE SEQUENCE COMPLETE — NEXCORP TOWER UNLOCKED</p>
    <p class="win-sub cn-text" style="z-index:10;color:rgba(0,255,128,0.5);">逃脱序列完成 — 奈克斯科普大厦已解锁</p>
    <p class="win-stats" id="win-stats" style="z-index:10;margin-top:4px;"></p>
    <div class="win-knowledge" id="win-knowledge" style="z-index:10;">
      <div class="win-knowledge-title">&#9654; KNOWLEDGE GAINED THIS SESSION // 本次获取的知识</div>
      <div class="win-knowledge-list" id="win-knowledge-list"></div>
    </div>
    <div style="z-index:10;margin-top:14px;">
      <button class="btn" id="replay-btn" style="border-color:rgba(0,255,128,0.5);color:#0f8;">
        &#x21BA; &nbsp; PLAY AGAIN &nbsp;// 再玩一次
      </button>
    </div>
    <div style="z-index:10;margin-top:8px;font-size:0.65rem;color:rgba(0,255,128,0.4);letter-spacing:2px;text-align:center;">
      KNOWLEDGE IS THE KEY — WELL DONE, AGENT.
      <span class="cn-text" style="color:rgba(0,255,128,0.35);">知识是钥匙 — 干得好，特工。</span>
    </div>
  </div>

  <!-- ===== DIALOGUE BOX ===== -->
  <div id="dialogue-box" class="hidden">
    <svg class="aegis-avatar" id="aegis-svg" viewBox="0 0 80 80" xmlns="http://www.w3.org/2000/svg">
      <circle cx="40" cy="40" r="38" fill="#04091a" stroke="#0ff" stroke-width="1.5"/>
      <circle cx="40" cy="40" r="31" fill="none" stroke="rgba(0,255,255,0.15)" stroke-width="1" stroke-dasharray="5 3">
        <animateTransform attributeName="transform" type="rotate" from="0 40 40" to="360 40 40" dur="8s" repeatCount="indefinite"/>
      </circle>
      <circle cx="40" cy="40" r="26" fill="none" stroke="rgba(240,0,240,0.1)" stroke-width="1" stroke-dasharray="3 5">
        <animateTransform attributeName="transform" type="rotate" from="360 40 40" to="0 40 40" dur="5s" repeatCount="indefinite"/>
      </circle>
      <line x1="9" y1="40" x2="16" y2="40" stroke="#0ff" stroke-width="0.8" opacity="0.7"/>
      <line x1="64" y1="40" x2="71" y2="40" stroke="#0ff" stroke-width="0.8" opacity="0.7"/>
      <line x1="40" y1="9" x2="40" y2="16" stroke="#0ff" stroke-width="0.8" opacity="0.7"/>
      <line x1="40" y1="64" x2="40" y2="71" stroke="#0ff" stroke-width="0.8" opacity="0.7"/>
      <circle cx="40" cy="40" r="20" fill="#061420" stroke="#0ff" stroke-width="1.5"/>
      <circle cx="40" cy="40" r="15" fill="none" stroke="rgba(0,255,255,0.3)" stroke-width="0.7" stroke-dasharray="3 2"/>
      <circle cx="40" cy="40" r="9" fill="#0ff" opacity="0.95"/>
      <circle cx="44" cy="36" r="2.5" fill="white" opacity="0.75"/>
      <line x1="21" y1="40" x2="59" y2="40" stroke="#0ff" stroke-width="0.6" opacity="0.4">
        <animate attributeName="y1" values="30;50;30" dur="2.5s" repeatCount="indefinite"/>
        <animate attributeName="y2" values="30;50;30" dur="2.5s" repeatCount="indefinite"/>
      </line>
      <text x="40" y="72" text-anchor="middle" fill="rgba(0,255,255,0.4)" font-size="5" font-family="monospace">AEGIS v3.0</text>
    </svg>
    <div class="dialogue-content">
      <div id="dialogue-speaker">AEGIS &nbsp;&#9654;&nbsp; ACTIVE</div>
      <div id="dialogue-text-en"></div>
      <div id="dialogue-text-zh"></div>
      <div id="dialogue-continue">&#9660; CONTINUE // 继续</div>
    </div>
  </div>

  <!-- Floor transition overlay -->
  <div id="floor-transition" class="floor-transition hidden">
    <div class="ft-hex">&#x2B21;</div>
    <div class="ft-text" id="ft-text">ACCESSING NEXT FLOOR...</div>
    <div class="ft-cn" id="ft-cn">正在访问下一层...</div>
    <div class="ft-bar-wrap"><div class="ft-bar" id="ft-bar"></div></div>
  </div>

  <!-- Correct / Wrong overlays -->
  <div id="correct-overlay" class="correct-overlay hidden"></div>
  <div id="wrong-overlay" class="wrong-overlay hidden"></div>

  <!-- Exit confirmation modal -->
  <div id="exit-modal" class="hidden">
    <div class="exit-modal-box">
      <div class="exit-modal-title">ABORT MISSION?</div>
      <div class="exit-modal-sub">中止任务？</div>
      <p style="font-size:0.7rem;color:rgba(200,200,255,0.5);margin-bottom:16px;letter-spacing:1px;">Your progress will be lost. // 你的进度将丢失。</p>
      <div class="exit-modal-btns">
        <button class="exit-yes" id="exit-yes">YES // 是</button>
        <button class="exit-no" id="exit-no">NO // 否</button>
      </div>
    </div>
  </div>

</div><!-- end #game-wrapper -->
<script>
"use strict";

// ============================================================
//  SOUND FX — Web Audio API (no external files)
// ============================================================
const SoundFX = (() => {
  let ctx = null;
  function getCtx() {
    if (!ctx) {
      try { ctx = new (window.AudioContext || window.webkitAudioContext)(); } catch(e) {}
    }
    return ctx;
  }
  function tone(freq, type, dur, vol=0.25, startFreq=null) {
    const c = getCtx(); if(!c) return;
    try {
      const o = c.createOscillator();
      const g = c.createGain();
      o.connect(g); g.connect(c.destination);
      o.type = type;
      o.frequency.setValueAtTime(startFreq||freq, c.currentTime);
      if(startFreq) o.frequency.linearRampToValueAtTime(freq, c.currentTime + dur);
      g.gain.setValueAtTime(vol, c.currentTime);
      g.gain.exponentialRampToValueAtTime(0.0001, c.currentTime + dur);
      o.start(c.currentTime);
      o.stop(c.currentTime + dur + 0.01);
    } catch(e) {}
  }
  return {
    playCorrect() { [523,659,784].forEach((f,i)=>setTimeout(()=>tone(f,'sine',0.09,0.22),i*80)); },
    playWrong()   { tone(100,'sawtooth',0.32,0.28); },
    playClick()   { tone(800,'sine',0.05,0.12); },
    playTransition() { tone(2000,'sine',0.4,0.18,200); },
    playBoot()    { [200,400,600,800,1200].forEach((f,i)=>setTimeout(()=>tone(f,'sine',0.1,0.18),i*110)); },
    playWin()     { [[261,0],[329,120],[392,240],[523,380],[659,550],[784,720]].forEach(([f,d])=>setTimeout(()=>tone(f,'sine',0.5,0.2),d)); },
    playType()    { tone(1800,'sine',0.02,0.06); },
    playDrag()    { tone(300,'sine',0.12,0.08); },
    playDrop()    { tone(160,'sine',0.12,0.28); },
    // ── Ambient background drone ─────────────────────────────
    startAmbient() {
      const c = getCtx(); if(!c) return;
      if(this._ambNodes) return; // already running
      try {
        this._ambNodes = [];
        const freqs = [55, 82.5, 110, 165]; // low A drone chord
        freqs.forEach((f, i) => {
          const o = c.createOscillator();
          const g = c.createGain();
          o.connect(g); g.connect(c.destination);
          o.type = 'sine';
          o.frequency.setValueAtTime(f + (i * 0.12), c.currentTime); // slight detune
          g.gain.setValueAtTime(0, c.currentTime);
          g.gain.linearRampToValueAtTime(0.022 - i * 0.004, c.currentTime + 3);
          o.start();
          this._ambNodes.push({o, g});
        });
        // Sub-bass oscillator
        const sub = c.createOscillator();
        const subG = c.createGain();
        sub.connect(subG); subG.connect(c.destination);
        sub.type = 'sine';
        sub.frequency.setValueAtTime(27.5, c.currentTime);
        subG.gain.setValueAtTime(0, c.currentTime);
        subG.gain.linearRampToValueAtTime(0.06, c.currentTime + 4);
        sub.start();
        this._ambNodes.push({o: sub, g: subG});
      } catch(e) {}
    },
    stopAmbient() {
      if(!this._ambNodes) return;
      const c = getCtx(); if(!c) return;
      this._ambNodes.forEach(({o, g}) => {
        try { g.gain.linearRampToValueAtTime(0, c.currentTime + 1); o.stop(c.currentTime + 1.1); } catch(e){}
      });
      this._ambNodes = null;
    },
    setAmbientMuted(muted) {
      if(!this._ambNodes) return;
      const c = getCtx(); if(!c) return;
      // gains: [0.022, 0.018, 0.014, 0.010, 0.06] matching startAmbient
      const gains = [0.022, 0.018, 0.014, 0.010, 0.06];
      this._ambNodes.forEach(({g}, i) => {
        try { g.gain.cancelScheduledValues(c.currentTime); g.gain.setValueAtTime(muted ? 0 : (gains[i] ?? 0.015), c.currentTime); } catch(e){}
      });
    },
  };
})();

// ============================================================
//  QUESTION BANK — 63 questions across Units 0-11
// ============================================================
// Types: 'mcq', 'tf', 'fill', 'match', 'scenario'
// Unit colors: 0=#888, 1=#4af, 2=#08f, 3=#fa0, 4=#0c8, 5=#0a6, 6=#f60, 7=#f30, 8=#a0f, 9-11=#0f9
const UNIT_COLORS = ['#888','#4af','#08f','#fa0','#0c8','#0a6','#f60','#f30','#a0f','#0f9','#0f9','#0f9'];
const UNIT_NAMES  = ['Unit 0: Intro','Unit 1: Legal Foundation','Unit 2: Legal System','Unit 3: Business Structures','Unit 4: Contracts I','Unit 5: Contracts II','Unit 6: Negligence I','Unit 7: Negligence II','Unit 8: Consumer Protection','Unit 9: Sustainability I','Unit 10: Sustainability II','Unit 11: Sustainability III'];

const QUESTION_BANK = [
// ── UNIT 0 ──────────────────────────────────────────────────
{ id:'u0q1', unit:0, type:'mcq', topic:'Course Learning Outcomes',
  en:'What does "CLO" stand for in this course?',
  zh:'"CLO"在本课程中代表什么？',
  opts:['Course Licensing Obligation','Course Learning Outcome','Corporate Law Overview','Curriculum Legal Objective'],
  optsZh:['课程许可义务','课程学习成果','公司法概述','课程法律目标'],
  ans:1,
  okEn:'Correct. CLO = Course Learning Outcome — the skills and knowledge you demonstrate by course end.',
  okZh:'正确。CLO代表课程学习成果——课程结束时应展示的技能和知识。',
  errEn:'Incorrect. CLO stands for Course Learning Outcome — specific skills assessed in this course.',
  errZh:'不正确。CLO代表课程学习成果——本课程中评估的具体技能。'},

{ id:'u0q2', unit:0, type:'tf', topic:'Course Overview',
  stmt:'Business Environments covers Units 0 through 8 only.',
  stmtZh:'《商业环境》课程仅覆盖第0至第8单元。',
  ans:false,
  okEn:'Correct — FALSE. The course covers Units 0 through 11, including three sustainability units (9, 10, 11).',
  okZh:'正确——假。该课程覆盖第0至第11单元，包括三个可持续发展单元（9、10、11）。',
  errEn:'FALSE. The course covers Units 0–11, including sustainability units 9, 10, and 11.',
  errZh:'假。该课程覆盖第0至第11单元，包括可持续发展单元9、10和11。'},

{ id:'u0q3', unit:0, type:'mcq', topic:'Assessment Structure',
  en:'Which assessment weight is typically correct for a group project in Business Environments?',
  zh:'《商业环境》课程中小组项目通常占多少分?',
  opts:['10%','20%','30%','40%'],
  optsZh:['10%','20%','30%','40%'],
  ans:2,
  okEn:'Correct. The group project is typically worth 30% of the overall grade.',
  okZh:'正确。小组项目通常占总成绩的30%。',
  errEn:'Incorrect. The group project is typically worth 30% of the overall grade.',
  errZh:'不正确。小组项目通常占总成绩的30%。'},

{ id:'u0q4', unit:0, type:'tf', topic:'Business Law Relevance',
  stmt:'Business law is only relevant to large corporations.',
  stmtZh:'商业法律仅与大型公司相关。',
  ans:false,
  okEn:'Correct — FALSE. Business law applies to all businesses, from sole traders to multinationals.',
  okZh:'正确——假。商业法律适用于所有企业，从个体经营者到跨国公司。',
  errEn:'FALSE. Business law applies to all businesses regardless of size.',
  errZh:'假。商业法律适用于所有规模的企业。'},

// ── UNIT 1 ──────────────────────────────────────────────────
{ id:'u1q1', unit:1, type:'mcq', topic:'Rule of Law',
  en:'Which of the following is NOT one of the five principles of the Rule of Law?',
  zh:'下列哪项不是法治五原则之一？',
  opts:['Equality before the law','Law is supreme over government','Majority rule determines law','Independent judiciary'],
  optsZh:['法律面前人人平等','法律高于政府','多数决定法律','独立的司法机构'],
  ans:2,
  okEn:'Correct. "Majority rule" is not a Rule of Law principle. The 5 principles include equality, supremacy of law, fair procedures, independent judiciary, and protection of rights.',
  okZh:'正确。"多数决定"不是法治原则。5项原则包括：平等、法律至上、公正程序、独立司法、权利保护。',
  errEn:'Incorrect. "Majority rule" is not a Rule of Law principle. The five principles are: equality before the law, law is supreme, fair procedures, independent judiciary, and protection of rights.',
  errZh:'不正确。"多数决定"不是法治原则。五项原则是：法律面前人人平等、法律至上、公正程序、独立司法、权利保护。'},

{ id:'u1q2', unit:1, type:'mcq', topic:'Separation of Powers',
  en:'The separation of powers doctrine divides government into how many branches?',
  zh:'权力分立原则将政府分为几个部门？',
  opts:['Two — executive and judiciary','Three — legislative, executive, judicial','Four — federal, state, local, judicial','Five — matching the Rule of Law principles'],
  optsZh:['两个——行政和司法','三个——立法、行政、司法','四个——联邦、州、地方、司法','五个——对应法治原则'],
  ans:1,
  okEn:'Correct. Three branches: Legislative (makes laws), Executive (implements laws), Judicial (interprets laws).',
  okZh:'正确。三个部门：立法机关（制定法律）、行政机关（执行法律）、司法机关（解释法律）。',
  errEn:'Incorrect. Three branches: Legislative, Executive, and Judicial.',
  errZh:'不正确。三个部门：立法机关、行政机关和司法机关。'},

{ id:'u1q3', unit:1, type:'fill', topic:'Division of Powers',
  blank:'The ___ of powers refers to the division of law-making authority between the federal government and state governments in Australia.',
  blankZh:'___权力是指澳大利亚联邦政府与州政府之间立法权力的划分。',
  accepts:['division','division of'],
  okEn:'Correct. The "division of powers" allocates powers between the Commonwealth and the states under the Constitution.',
  okZh:'正确。"权力划分"是宪法规定的联邦与州之间权力的分配。',
  errEn:'The answer is "division" — the division of powers splits authority between federal and state governments.',
  errZh:'答案是"division"（划分）——权力划分将权力分配给联邦和州政府。'},

{ id:'u1q4', unit:1, type:'mcq', topic:'Constitutional Law',
  en:'Which section of the Australian Constitution provides the mechanism for referendums?',
  zh:'澳大利亚宪法哪一条规定了公投机制？',
  opts:['s51','s109','s128','s7'],
  optsZh:['第51条','第109条','第128条','第7条'],
  ans:2,
  okEn:'Correct. Section 128 sets out the process for altering the Australian Constitution by referendum.',
  okZh:'正确。第128条规定了通过公投修改澳大利亚宪法的程序。',
  errEn:'Incorrect. Section 128 deals with referendums for constitutional amendments.',
  errZh:'不正确。第128条规定了宪法修正案的公投程序。'},

{ id:'u1q5', unit:1, type:'tf', topic:'Parliamentary Supremacy',
  stmt:'Under the Australian Constitution, the federal Parliament can override all state laws.',
  stmtZh:'根据澳大利亚宪法，联邦议会可以否决所有州法律。',
  ans:false,
  okEn:'Correct — FALSE. Federal Parliament can only override state laws in areas where it has constitutional power (s51). States retain residual powers.',
  okZh:'正确——假。联邦议会只能在其有宪法权力的领域（第51条）否决州法律。州保留剩余权力。',
  errEn:'FALSE. Federal Parliament can only override state laws in areas of its constitutional power. States keep residual powers.',
  errZh:'假。联邦议会只能在其宪法权力范围内否决州法律。州保留剩余权力。'},

{ id:'u1q6', unit:1, type:'mcq', topic:'High Court',
  en:'Under the Rule of Law, which court is responsible for ensuring the Australian Constitution is upheld?',
  zh:'在法治原则下，哪个法院负责确保澳大利亚宪法得到遵守？',
  opts:['Federal Circuit Court','Supreme Court of NSW','High Court of Australia','Administrative Appeals Tribunal'],
  optsZh:['联邦巡回法院','新南威尔士州最高法院','澳大利亚高等法院','行政上诉法庭'],
  ans:2,
  okEn:'Correct. The High Court of Australia is the apex court and guardian of the Constitution.',
  okZh:'正确。澳大利亚高等法院是最高法院，也是宪法的守护者。',
  errEn:'Incorrect. The High Court of Australia is the apex court and guardian of the Constitution.',
  errZh:'不正确。澳大利亚高等法院是最高法院和宪法的守护者。'},

// ── UNIT 2 ──────────────────────────────────────────────────
{ id:'u2q1', unit:2, type:'mcq', topic:'Sources of Law',
  en:'Which of the following is NOT a formal source of law in Australia?',
  zh:'下列哪项不是澳大利亚法律的正式来源？',
  opts:['Statute law (legislation)','Common law (case law)','Equity','Executive decrees'],
  optsZh:['成文法（立法）','普通法（判例法）','衡平法','行政命令'],
  ans:3,
  okEn:'Correct. The three formal sources of Australian law are statute law, common law, and equity. Executive decrees are not a formal independent source.',
  okZh:'正确。澳大利亚法律的三个正式来源是成文法、普通法和衡平法。行政命令不是独立的正式来源。',
  errEn:'Incorrect. The three formal sources are statute law, common law, and equity.',
  errZh:'不正确。三个正式来源是成文法、普通法和衡平法。'},

{ id:'u2q2', unit:2, type:'mcq', topic:'Court Hierarchy',
  en:'In the Australian court hierarchy, which court has the highest authority?',
  zh:'在澳大利亚法院层级中，哪个法院拥有最高权威？',
  opts:['Supreme Court (State)','Federal Court of Australia','High Court of Australia','Court of Appeal'],
  optsZh:['（州）最高法院','澳大利亚联邦法院','澳大利亚高等法院','上诉法院'],
  ans:2,
  okEn:'Correct. The High Court of Australia is the apex court — its decisions bind all other courts in Australia.',
  okZh:'正确。澳大利亚高等法院是最高法院——其判决对澳大利亚所有其他法院均有约束力。',
  errEn:'Incorrect. The High Court of Australia is the apex court whose decisions bind all lower courts.',
  errZh:'不正确。澳大利亚高等法院是最高法院，其判决对所有下级法院均有约束力。'},

{ id:'u2q3', unit:2, type:'fill', topic:'Precedent',
  blank:'"___ decidendi" is the Latin term for the binding legal reason(s) for a court\'s decision.',
  blankZh:'"___决定"是拉丁语，指法院判决的具有约束力的法律理由。',
  accepts:['ratio','Ratio'],
  okEn:'Correct. "Ratio decidendi" (reason for deciding) is the legally binding part of a judgment.',
  okZh:'正确。"Ratio decidendi"（判决理由）是判决中具有法律约束力的部分。',
  errEn:'The answer is "ratio" — ratio decidendi is the binding legal reason in a judgment.',
  errZh:'答案是"ratio"——ratio decidendi是判决中具有约束力的法律理由。'},

{ id:'u2q4', unit:2, type:'mcq', topic:'Postal Acceptance Rule',
  en:'Under the postal acceptance rule, acceptance of an offer is effective when:',
  zh:'根据邮政承诺规则，要约的承诺在何时生效？',
  opts:['The offeror reads the letter','The letter is received','The letter is posted (sent)','The offeror acknowledges receipt'],
  optsZh:['要约人阅读信件时','信件被收到时','信件被寄出时','要约人确认收到时'],
  ans:2,
  okEn:'Correct. Under the postal acceptance rule (Adams v Lindsell), acceptance is complete when the letter is posted, not when received.',
  okZh:'正确。根据邮政承诺规则（Adams v Lindsell），当信件寄出时承诺即完成，而非收到时。',
  errEn:'Incorrect. Under the postal rule, acceptance is effective from the moment the letter is posted.',
  errZh:'不正确。根据邮政规则，承诺从信件寄出时起生效。'},

{ id:'u2q5', unit:2, type:'mcq', topic:'Obiter Dictum',
  en:'"Obiter dictum" in a court judgment is:',
  zh:'法院判决中的"附带意见"是：',
  opts:['The binding ratio of the case','A non-binding comment made by a judge in passing','The headnote summarising the judgment','The written dissenting opinion'],
  optsZh:['案件的约束性理由','法官顺带发表的非约束性评论','概括判决的案例提要','书面异议意见'],
  ans:1,
  okEn:'Correct. Obiter dictum ("said by the way") is persuasive but not binding on future courts.',
  okZh:'正确。附带意见（"顺便说"）对未来法院具有说服力，但无约束力。',
  errEn:'Incorrect. Obiter dictum is a non-binding comment by a judge — only the ratio decidendi is binding.',
  errZh:'不正确。附带意见是法官的非约束性评论——只有判决理由具有约束力。'},

{ id:'u2q6', unit:2, type:'match', topic:'Precedent Concepts',
  en:'Match each legal term to its correct definition.',
  zh:'将每个法律术语与其正确定义配对。',
  pairs:[
    {term:'Ratio decidendi', def:'Binding reason for a court\'s decision'},
    {term:'Obiter dictum',   def:'Non-binding comment made in passing'},
    {term:'Stare decisis',   def:'Doctrine of binding precedent'},
    {term:'Appellate jurisdiction', def:'Power to hear appeals from lower courts'},
  ],
  pairsZh:[
    {term:'判决理由', def:'法院判决的约束性理由'},
    {term:'附带意见', def:'顺带发表的非约束性评论'},
    {term:'遵循先例', def:'约束性先例原则'},
    {term:'上诉管辖权', def:'审理下级法院上诉的权力'},
  ],
  okEn:'Excellent! All legal terms correctly matched.',
  okZh:'优秀！所有法律术语均正确匹配。',
  errEn:'Incorrect match. Review the definitions of each concept.',
  errZh:'匹配错误。请复习每个概念的定义。'},

// ── UNIT 3 ──────────────────────────────────────────────────
{ id:'u3q1', unit:3, type:'mcq', topic:'Sole Trader Liability',
  en:'Which business structure gives the owner UNLIMITED personal liability?',
  zh:'哪种商业结构使所有者承担无限个人责任？',
  opts:['Company (Pty Ltd)','Sole trader','Public company (Ltd)','Unit trust'],
  optsZh:['私人公司（Pty Ltd）','个体经营者','上市公司（Ltd）','单位信托'],
  ans:1,
  okEn:'Correct. A sole trader has no separate legal entity — the owner is personally liable for all business debts.',
  okZh:'正确。个体经营者没有独立的法人地位——所有者对所有商业债务承担个人责任。',
  errEn:'Incorrect. A sole trader bears unlimited personal liability for all business debts.',
  errZh:'不正确。个体经营者对所有商业债务承担无限个人责任。'},

{ id:'u3q2', unit:3, type:'mcq', topic:'Salomon v Salomon',
  en:'The landmark case Salomon v Salomon (1897) established that:',
  zh:'里程碑案例Salomon v Salomon（1897年）确立了：',
  opts:['Directors must act in good faith','A company is a separate legal entity from its shareholders','Partners have joint and several liability','A trustee must act in beneficiaries\' interests'],
  optsZh:['董事必须诚信行事','公司是独立于股东的法律实体','合伙人承担连带责任','受托人必须为受益人利益行事'],
  ans:1,
  okEn:'Correct. Salomon v Salomon established the "corporate veil" — a company has its own legal identity separate from its members.',
  okZh:'正确。Salomon v Salomon确立了"公司面纱"——公司拥有独立于其成员的法律身份。',
  errEn:'Incorrect. Salomon v Salomon established that a company is a separate legal entity distinct from its shareholders.',
  errZh:'不正确。Salomon v Salomon确立了公司是独立于股东的独立法律实体。'},

{ id:'u3q3', unit:3, type:'fill', topic:'Company Registration',
  blank:'Companies in Australia must be registered with ___, the national corporate regulator.',
  blankZh:'澳大利亚的公司必须在___注册，这是全国性的公司监管机构。',
  accepts:['ASIC','asic'],
  okEn:'Correct. ASIC (Australian Securities and Investments Commission) registers and regulates companies under the Corporations Act 2001.',
  okZh:'正确。ASIC（澳大利亚证券和投资委员会）依据《2001年公司法》注册和监管公司。',
  errEn:'The answer is ASIC — Australian Securities and Investments Commission, the national corporate regulator.',
  errZh:'答案是ASIC——澳大利亚证券和投资委员会，全国性公司监管机构。'},

{ id:'u3q4', unit:3, type:'mcq', topic:'Partnership Liability',
  en:'In a general partnership, the partners are liable for business debts:',
  zh:'在普通合伙中，合伙人对商业债务的责任是：',
  opts:['Only to the value of their capital contribution','With limited liability up to $500,000','Jointly and severally with unlimited liability','With limited liability protected by the Partnership Act'],
  optsZh:['仅限于其资本出资额','有限责任至50万元','连带且无限责任','受《合伙法》保护的有限责任'],
  ans:2,
  okEn:'Correct. General partners are jointly and severally liable — creditors can sue all partners together or any one partner for the full debt.',
  okZh:'正确。普通合伙人承担连带责任——债权人可以同时起诉所有合伙人，或单独起诉任一合伙人追偿全部债务。',
  errEn:'Incorrect. General partners have joint and several unlimited liability for all partnership debts.',
  errZh:'不正确。普通合伙人对所有合伙债务承担连带无限责任。'},

{ id:'u3q5', unit:3, type:'mcq', topic:'Corporations Act',
  en:'Which legislation primarily governs companies in Australia?',
  zh:'哪部法律主要管辖澳大利亚的公司？',
  opts:['Partnership Act 1963 (ACT)','Corporations Act 2001 (Cth)','Trade Practices Act 1974','ASIC Act 2001'],
  optsZh:['1963年《合伙法》（首都领地）','2001年《公司法》（联邦）','1974年《贸易行为法》','2001年《ASIC法》'],
  ans:1,
  okEn:'Correct. The Corporations Act 2001 (Cth) is the principal legislation governing all corporations in Australia.',
  okZh:'正确。《2001年公司法》（联邦）是管辖澳大利亚所有公司的主要立法。',
  errEn:'Incorrect. The Corporations Act 2001 (Cth) is the main legislation governing Australian companies.',
  errZh:'不正确。《2001年公司法》（联邦）是管辖澳大利亚公司的主要立法。'},

{ id:'u3q6', unit:3, type:'tf', topic:'Trusts',
  stmt:'A trust is a separate legal entity like a company.',
  stmtZh:'信托是像公司一样的独立法律实体。',
  ans:false,
  okEn:'Correct — FALSE. A trust is a legal relationship (not a legal entity). The trustee holds property on behalf of beneficiaries.',
  okZh:'正确——假。信托是一种法律关系（而非法律实体）。受托人代表受益人持有财产。',
  errEn:'FALSE. A trust is a legal relationship, not a separate legal entity. The trustee holds the property for beneficiaries.',
  errZh:'假。信托是一种法律关系，不是独立的法律实体。受托人为受益人持有财产。'},

// ── UNIT 4 ──────────────────────────────────────────────────
{ id:'u4q1', unit:4, type:'mcq', topic:'Elements of Contract',
  en:'Which of the following is NOT one of the 6 essential elements of a valid contract?',
  zh:'下列哪项不是有效合同的6个基本要素之一？',
  opts:['Offer','Consideration','Registration with a government body','Intention to create legal relations'],
  optsZh:['要约','对价','向政府机构注册','创立法律关系的意图'],
  ans:2,
  okEn:'Correct. The 6 elements are: offer, acceptance, consideration, intention, capacity, and legality. Registration is not required.',
  okZh:'正确。6个要素是：要约、承诺、对价、意图、行为能力和合法性。无需注册。',
  errEn:'Incorrect. The 6 elements are offer, acceptance, consideration, intention, capacity, and legality.',
  errZh:'不正确。6个要素是要约、承诺、对价、意图、行为能力和合法性。'},

{ id:'u4q2', unit:4, type:'mcq', topic:'Invitation to Treat',
  en:'In Pharmaceutical Society v Boots Cash Chemists (1953), goods displayed on a shop shelf are:',
  zh:'在Pharmaceutical Society v Boots（1953年）案中，陈列在商店货架上的商品是：',
  opts:['An offer to sell which customers can accept','An invitation to treat, not a binding offer','A completed contract at point of display','A unilateral contract open to all customers'],
  optsZh:['顾客可以接受的销售要约','要约邀请，而非具有约束力的要约','陈列时即完成的合同','对所有顾客开放的单方合同'],
  ans:1,
  okEn:'Correct. Displaying goods is an invitation to treat — the customer makes the offer at the checkout, which the shop accepts or rejects.',
  okZh:'正确。陈列商品是要约邀请——顾客在收银台发出要约，由商店接受或拒绝。',
  errEn:'Incorrect. Displaying goods is an invitation to treat, not an offer. The customer makes the offer at the till.',
  errZh:'不正确。陈列商品是要约邀请，而非要约。顾客在收银台发出要约。'},

{ id:'u4q3', unit:4, type:'mcq', topic:'Consideration',
  en:'Which statement about consideration is CORRECT?',
  zh:'关于对价，哪项陈述是正确的？',
  opts:['Consideration must be adequate and sufficient','Past consideration is valid consideration','Consideration must be sufficient but need not be adequate','Consideration can be a promise to perform an existing public duty'],
  optsZh:['对价必须充分且足够','过去的对价是有效对价','对价必须足够但不需要充分','对价可以是履行现有公共职责的承诺'],
  ans:2,
  okEn:'Correct. Consideration must be sufficient (real/genuine) but need not be adequate (equal in value). Courts do not assess commercial adequacy.',
  okZh:'正确。对价必须足够（真实/genuine），但不需要充分（等值）。法院不评估商业充分性。',
  errEn:'Incorrect. Consideration must be sufficient (genuine) but need not be adequate (equal in value).',
  errZh:'不正确。对价必须足够（真实），但不需要充分（等值）。'},

{ id:'u4q4', unit:4, type:'tf', topic:'Past Consideration',
  stmt:'Past consideration is valid consideration for a new contract.',
  stmtZh:'过去的对价是新合同的有效对价。',
  ans:false,
  okEn:'Correct — FALSE. "Past consideration is no consideration" — an act already done before the promise was made cannot be used as consideration.',
  okZh:'正确——假。"过去的对价不是对价"——在承诺作出之前已完成的行为不能作为对价。',
  errEn:'FALSE. Past consideration is no consideration — the act must occur after the promise to be valid consideration.',
  errZh:'假。过去的对价不是对价——行为必须在承诺之后发生才能成为有效对价。'},

{ id:'u4q5', unit:4, type:'mcq', topic:'Capacity',
  en:'Which group generally lacks full contractual capacity under Australian law?',
  zh:'根据澳大利亚法律，哪个群体通常缺乏完全合同行为能力？',
  opts:['Employed adults','Company directors','Minors (persons under 18)','Foreign nationals'],
  optsZh:['在职成年人','公司董事','未成年人（18岁以下）','外国国民'],
  ans:2,
  okEn:'Correct. Minors (under 18) generally lack full contractual capacity — contracts with minors are voidable at the minor\'s option, with limited exceptions (necessaries).',
  okZh:'正确。未成年人（18岁以下）通常缺乏完全合同行为能力——与未成年人的合同是可撤销的（有限例外，如生活必需品）。',
  errEn:'Incorrect. Minors (under 18) generally lack full contractual capacity under Australian law.',
  errZh:'不正确。根据澳大利亚法律，未成年人（18岁以下）通常缺乏完全合同行为能力。'},

{ id:'u4q6', unit:4, type:'scenario', topic:'Offer and Acceptance',
  scenario:'Ahmed sees a poster at the local council: "REWARD: $500 for information leading to recovery of stolen public artwork." Ahmed finds the artwork and returns it, then claims the reward.',
  scenarioZh:'艾哈迈德在当地市政厅看到一张海报："奖励：提供找回被盗公共艺术品线索者奖励500美元。"艾哈迈德找到了艺术品并归还，然后索取奖励。',
  en:'Can Ahmed successfully claim the $500 reward?',
  zh:'艾哈迈德能成功索取500美元的奖励吗？',
  opts:['No — he needed to sign a contract first','No — a poster is only an invitation to treat','Yes — finding and returning the artwork constitutes acceptance by performance','No — the reward expired when he returned it'],
  optsZh:['不能——他需要先签署合同','不能——海报只是要约邀请','能——找到并归还艺术品构成以行为方式承诺','不能——他归还时奖励已过期'],
  ans:2,
  okEn:'Correct. The poster is a unilateral offer — it can be accepted by performing the requested act. Ahmed accepted by finding and returning the artwork.',
  okZh:'正确。海报是单方要约——可以通过履行所要求的行为来承诺。艾哈迈德通过找到并归还艺术品完成了承诺。',
  errEn:'Incorrect. The poster is a unilateral offer accepted by performance. Ahmed can claim the reward.',
  errZh:'不正确。海报是以行为方式承诺的单方要约。艾哈迈德可以索取奖励。'},

// ── UNIT 5 ──────────────────────────────────────────────────
{ id:'u5q1', unit:5, type:'mcq', topic:'Conditions vs Warranties',
  en:'In contract law, a "condition" is:',
  zh:'在合同法中，"条件"是：',
  opts:['Any term in a standard form contract','A fundamental term — breach allows termination and damages','A minor term — breach allows damages only','A term implied by statute only'],
  optsZh:['标准格式合同中的任何条款','基本条款——违反允许终止合同并索赔损害','次要条款——违反只能索赔损害','仅由法规隐含的条款'],
  ans:1,
  okEn:'Correct. A condition is a fundamental term — breach entitles the innocent party to terminate the contract AND claim damages.',
  okZh:'正确。条件是基本条款——违反使无辜方有权终止合同并索赔损害。',
  errEn:'Incorrect. A condition is a fundamental term; breach gives the right to terminate and claim damages.',
  errZh:'不正确。条件是基本条款；违反给予终止合同并索赔损害的权利。'},

{ id:'u5q2', unit:5, type:'mcq', topic:'Hadley v Baxendale',
  en:'The rule in Hadley v Baxendale (1854) concerns which aspect of contract remedies?',
  zh:'Hadley v Baxendale（1854年）的规则涉及合同救济的哪个方面？',
  opts:['The duty to mitigate loss','Remoteness of damages — only foreseeable losses are recoverable','Specific performance requirements','Frustration of contract'],
  optsZh:['减损损失的义务','损害赔偿的远程性——只有可预见的损失才可追偿','特定履行要求','合同受阻'],
  ans:1,
  okEn:'Correct. Hadley v Baxendale limits recoverable damages to losses that arise naturally from the breach or were reasonably in the contemplation of both parties.',
  okZh:'正确。Hadley v Baxendale将可追偿损害限制为自然因违约而产生的损失，或双方合理预期的损失。',
  errEn:'Incorrect. Hadley v Baxendale establishes the remoteness rule — only reasonably foreseeable losses are recoverable.',
  errZh:'不正确。Hadley v Baxendale确立了远程性规则——只有合理可预见的损失才可追偿。'},

{ id:'u5q3', unit:5, type:'mcq', topic:'Frustration',
  en:'A contract is "frustrated" when:',
  zh:'合同"受阻"是指：',
  opts:['One party refuses to perform','An unexpected event makes performance impossible or radically different from what was agreed','The consideration is inadequate','One party commits a minor breach'],
  optsZh:['一方拒绝履行','意外事件使履行不可能或与约定根本不同','对价不充分','一方构成轻微违约'],
  ans:1,
  okEn:'Correct. Frustration occurs when an unforeseen event, through no fault of either party, makes contractual performance impossible or radically different.',
  okZh:'正确。当不可预见的事件（双方均无过错）使合同履行不可能或根本性改变时，发生合同受阻。',
  errEn:'Incorrect. Frustration occurs when an unforeseen event makes performance impossible or radically different — not mere inconvenience.',
  errZh:'不正确。合同受阻是指不可预见的事件使履行不可能或根本性改变——而非单纯的不便。'},

{ id:'u5q4', unit:5, type:'mcq', topic:'Vitiating Factors',
  en:'Which of the following is NOT a vitiating factor that can make a contract voidable?',
  zh:'下列哪项不是可使合同可撤销的缺陷因素？',
  opts:['Misrepresentation','Duress','Inconvenience to one party','Undue influence'],
  optsZh:['虚假陈述','胁迫','对一方的不便','不当影响'],
  ans:2,
  okEn:'Correct. "Inconvenience" is not a vitiating factor. The main vitiating factors are misrepresentation, duress, undue influence, unconscionability, and mistake.',
  okZh:'正确。"不便"不是缺陷因素。主要缺陷因素是虚假陈述、胁迫、不当影响、违反良知和错误。',
  errEn:'Incorrect. Inconvenience is not a vitiating factor. The factors include misrepresentation, duress, undue influence, unconscionability.',
  errZh:'不正确。不便不是缺陷因素。因素包括虚假陈述、胁迫、不当影响、违反良知。'},

{ id:'u5q5', unit:5, type:'tf', topic:'Liquidated Damages',
  stmt:'Liquidated damages are damages assessed by a court after a breach occurs.',
  stmtZh:'违约金是在违约发生后由法院评估的损害赔偿。',
  ans:false,
  okEn:'Correct — FALSE. Liquidated damages are a genuine pre-estimate of loss agreed by the parties in advance and written into the contract.',
  okZh:'正确——假。违约金是双方事先约定并写入合同的对损失的真实预估。',
  errEn:'FALSE. Liquidated damages are a pre-agreed genuine estimate of loss specified in the contract itself — not assessed by a court.',
  errZh:'假。违约金是合同中规定的预先约定的损失真实估计——而非由法院评估。'},

{ id:'u5q6', unit:5, type:'mcq', topic:'Remedies',
  en:'Which remedy for breach of contract ORDERS a party to perform their contractual obligations?',
  zh:'合同违约的哪种救济要求当事方履行其合同义务？',
  opts:['Damages','Rescission','Specific performance','Injunction'],
  optsZh:['损害赔偿','撤销','特定履行','禁令'],
  ans:2,
  okEn:'Correct. Specific performance is an equitable remedy ordering the defendant to perform their contractual obligations (typically used for unique goods or land).',
  okZh:'正确。特定履行是一种衡平救济，要求被告履行其合同义务（通常用于独特商品或土地）。',
  errEn:'Incorrect. Specific performance orders a party to actually perform their contractual obligations.',
  errZh:'不正确。特定履行要求当事方实际履行其合同义务。'},

// ── UNIT 6 ──────────────────────────────────────────────────
{ id:'u6q1', unit:6, type:'mcq', topic:'Donoghue v Stevenson',
  en:'The "neighbour principle" in negligence law was established in which case?',
  zh:'过失法中的"邻居原则"是在哪个案例中确立的？',
  opts:['Hadley v Baxendale (1854)','Hedley Byrne v Heller (1964)','Donoghue v Stevenson [1932]','Wagon Mound (No 1) [1961]'],
  optsZh:['Hadley v Baxendale（1854年）','Hedley Byrne v Heller（1964年）','Donoghue v Stevenson（1932年）','Wagon Mound（第1号）（1961年）'],
  ans:2,
  okEn:'Correct. In Donoghue v Stevenson [1932], Lord Atkin established the neighbour principle: you owe a duty of care to those reasonably affected by your acts.',
  okZh:'正确。在Donoghue v Stevenson（1932年）案中，阿特金勋爵确立了邻居原则：你对那些合理受你行为影响的人负有注意义务。',
  errEn:'Incorrect. Donoghue v Stevenson [1932] established the neighbour principle and the modern law of negligence.',
  errZh:'不正确。Donoghue v Stevenson（1932年）确立了邻居原则和现代过失法。'},

{ id:'u6q2', unit:6, type:'mcq', topic:'Elements of Negligence',
  en:'To succeed in a negligence claim, a plaintiff must prove which four elements?',
  zh:'要在过失索赔中胜诉，原告必须证明哪四个要素？',
  opts:['Offer, acceptance, consideration, intention','Duty of care, breach, causation, damage','Misrepresentation, duress, undue influence, mistake','Proximity, foreseeability, policy, fairness'],
  optsZh:['要约、承诺、对价、意图','注意义务、违反、因果关系、损害','虚假陈述、胁迫、不当影响、错误','邻近性、可预见性、政策、公平性'],
  ans:1,
  okEn:'Correct. The four elements of negligence are: (1) duty of care, (2) breach of that duty, (3) causation, and (4) damage (not too remote).',
  okZh:'正确。过失的四个要素是：（1）注意义务，（2）违反该义务，（3）因果关系，（4）损害（非过于远程）。',
  errEn:'Incorrect. The four elements are duty of care, breach, causation, and damage.',
  errZh:'不正确。四个要素是注意义务、违反、因果关系和损害。'},

{ id:'u6q3', unit:6, type:'mcq', topic:'Causation — But For Test',
  en:'The "but for" test in negligence is used to establish:',
  zh:'过失中的"若非"测试用于确定：',
  opts:['Remoteness of damage','Whether the defendant owed a duty of care','Causation — whether the defendant\'s breach caused the plaintiff\'s harm','Whether the defendant acted reasonably'],
  optsZh:['损害的远程性','被告是否负有注意义务','因果关系——被告的违反是否导致原告的伤害','被告是否合理行事'],
  ans:2,
  okEn:'Correct. The but-for test asks: "But for the defendant\'s negligence, would the plaintiff have suffered the harm?" If yes, causation is established.',
  okZh:'正确。若非测试问："若非被告的过失，原告是否会遭受伤害？"如果是，则确立因果关系。',
  errEn:'Incorrect. The but-for test establishes causation: but for the defendant\'s breach, would the harm have occurred?',
  errZh:'不正确。若非测试确立因果关系：若非被告的违反，损害是否会发生？'},

{ id:'u6q4', unit:6, type:'mcq', topic:'Breach — Reasonable Person',
  en:'The standard used to determine whether a defendant breached their duty of care is:',
  zh:'用于确定被告是否违反其注意义务的标准是：',
  opts:['The subjective standard of the particular defendant','The standard of the "reasonable person" in the same circumstances','The expert professional standard in all cases','The highest possible standard of care'],
  optsZh:['特定被告的主观标准','相同情况下"理性人"的标准','所有情况下的专家专业标准','最高可能的注意标准'],
  ans:1,
  okEn:'Correct. The objective "reasonable person" standard (Blyth v Birmingham Waterworks) — what would a reasonable person in the defendant\'s position have done?',
  okZh:'正确。客观的"理性人"标准（Blyth v Birmingham Waterworks）——处于被告地位的理性人会怎么做？',
  errEn:'Incorrect. The objective reasonable person standard is used — what would a reasonable person in those circumstances have done?',
  errZh:'不正确。使用客观理性人标准——处于该情况的理性人会怎么做？'},

{ id:'u6q5', unit:6, type:'scenario', topic:'Breach of Duty',
  scenario:'Dr. Chen, a cardiologist, performs a routine heart stent procedure. She uses an outdated technique that peer-reviewed guidelines replaced 3 years ago. The patient suffers preventable complications.',
  scenarioZh:'陈博士是一名心脏科医生，她进行了一次常规心脏支架手术。她使用了一种3年前经同行评审指南取代的过时技术。患者遭受了可预防的并发症。',
  en:'In a negligence claim, has Dr. Chen breached her duty of care?',
  zh:'在过失索赔中，陈博士是否违反了其注意义务？',
  opts:['No — she performed the operation competently','No — any complications are an inherent surgical risk','Yes — she fell below the standard of a reasonably competent cardiologist','Yes — only because the patient did not consent to the old technique'],
  optsZh:['否——她胜任地进行了手术','否——任何并发症都是手术固有风险','是——她低于合理胜任的心脏科医生标准','是——仅因为患者未同意使用旧技术'],
  ans:2,
  okEn:'Correct. A professional is measured against the standard of a reasonably competent member of their profession. Using an outdated technique falls below that standard.',
  okZh:'正确。专业人员按照其专业中合理胜任成员的标准进行衡量。使用过时技术低于该标准。',
  errEn:'Incorrect. Dr. Chen breached her duty by using a technique below the standard expected of a reasonably competent cardiologist.',
  errZh:'不正确。陈博士使用低于合理胜任心脏科医生预期标准的技术，违反了其注意义务。'},

{ id:'u6q6', unit:6, type:'mcq', topic:'Remoteness — Wagon Mound',
  en:'The Wagon Mound (No 1) [1961] test for remoteness of damage asks whether:',
  zh:'Wagon Mound（第1号）（1961年）关于损害远程性的测试问：',
  opts:['The damage was the direct result of the breach','The damage was reasonably foreseeable by the defendant','The defendant intended to cause the damage','The damage occurred within 6 months of the breach'],
  optsZh:['损害是违反的直接结果','被告合理预见了损害','被告意图造成损害','损害在违反后6个月内发生'],
  ans:1,
  okEn:'Correct. The Wagon Mound test: a defendant is only liable for damage that was reasonably foreseeable — not for unforeseeable consequences.',
  okZh:'正确。Wagon Mound测试：被告只对合理可预见的损害承担责任——不对不可预见的后果负责。',
  errEn:'Incorrect. The Wagon Mound test requires damage to be reasonably foreseeable by the defendant to be recoverable.',
  errZh:'不正确。Wagon Mound测试要求损害对被告合理可预见才可追偿。'},

// ── UNIT 7 ──────────────────────────────────────────────────
{ id:'u7q1', unit:7, type:'mcq', topic:'Negligent Misstatement',
  en:'Hedley Byrne v Heller [1964] established liability for:',
  zh:'Hedley Byrne v Heller（1964年）确立了以下责任：',
  opts:['Physical harm caused by defective products','Negligent misstatement causing pure economic loss','Trespass to land','Breach of statutory duty'],
  optsZh:['缺陷产品造成的人身伤害','导致纯粹经济损失的疏忽失实陈述','土地侵犯','违反法定义务'],
  ans:1,
  okEn:'Correct. Hedley Byrne v Heller established that liability can arise for a negligent misstatement (advice/information) that causes pure economic loss, where a special relationship exists.',
  okZh:'正确。Hedley Byrne v Heller确立了，当存在特殊关系时，导致纯粹经济损失的疏忽失实陈述（建议/信息）可以产生责任。',
  errEn:'Incorrect. Hedley Byrne v Heller established liability for negligent misstatement causing pure economic loss.',
  errZh:'不正确。Hedley Byrne v Heller确立了疏忽失实陈述导致纯粹经济损失的责任。'},

{ id:'u7q2', unit:7, type:'mcq', topic:'Special Relationship',
  en:'For a negligent misstatement claim, what must exist between the parties?',
  zh:'对于疏忽失实陈述索赔，当事方之间必须存在什么？',
  opts:['A written contract','A special relationship of skill, reliance, and knowledge','A fiduciary relationship only','A formal retainer agreement'],
  optsZh:['书面合同','技能、依赖和知识的特殊关系','仅限信托关系','正式委托协议'],
  ans:1,
  okEn:'Correct. There must be a "special relationship" — the defendant has special skill, the plaintiff reasonably relied on the advice, and the defendant knew of that reliance.',
  okZh:'正确。必须存在"特殊关系"——被告具有特殊技能，原告合理依赖了建议，被告知道这种依赖。',
  errEn:'Incorrect. A special relationship requiring skill, reasonable reliance, and knowledge of that reliance must exist.',
  errZh:'不正确。必须存在需要技能、合理依赖和知道该依赖的特殊关系。'},

{ id:'u7q3', unit:7, type:'mcq', topic:'Defences to Negligence',
  en:'"Volenti non fit injuria" means:',
  zh:'"自愿承担风险"意味着：',
  opts:['The defendant acted voluntarily in creating the risk','A person who freely consents to a risk cannot later sue for resulting harm','Contributory negligence bars all recovery','The plaintiff was also negligent'],
  optsZh:['被告自愿创造了风险','自愿同意承担风险的人不能因此后来起诉损害','相互过失阻止一切追偿','原告也存在过失'],
  ans:1,
  okEn:'Correct. Volenti non fit injuria — "no injury is done to one who consents." If the plaintiff freely and voluntarily assumed the risk, the defendant has a complete defence.',
  okZh:'正确。自愿承担风险——"同意者不受伤害"。如果原告自由自愿地承担了风险，被告有完全抗辩。',
  errEn:'Incorrect. Volenti non fit injuria means a person who voluntarily accepts a known risk cannot sue for resulting harm.',
  errZh:'不正确。自愿承担风险意味着自愿接受已知风险的人不能为此起诉损害。'},

{ id:'u7q4', unit:7, type:'tf', topic:'Proportionate Liability',
  stmt:'Proportionate liability allows a court to apportion damages among multiple defendants according to their respective responsibility.',
  stmtZh:'按比例责任允许法院根据各方各自的责任在多名被告之间分配损害赔偿。',
  ans:true,
  okEn:'Correct — TRUE. Under proportionate liability schemes (e.g., Civil Liability Acts), where multiple parties caused the same loss, each pays only their proportionate share.',
  okZh:'正确——真。在按比例责任方案（如《民事责任法》）下，当多方造成相同损失时，每方只支付其相应份额。',
  errEn:'TRUE. Proportionate liability divides responsibility among multiple defendants based on their respective contribution to the loss.',
  errZh:'真。按比例责任根据各被告对损失的相应贡献在多名被告之间划分责任。'},

{ id:'u7q5', unit:7, type:'mcq', topic:'Pure Economic Loss',
  en:'"Pure economic loss" in tort law refers to:',
  zh:'侵权法中的"纯粹经济损失"是指：',
  opts:['Loss of profits caused by a physical injury','Financial loss not resulting from personal injury or property damage','Loss of reputation due to defamation','Emotional distress without financial consequence'],
  optsZh:['人身伤害造成的利润损失','非人身伤害或财产损害导致的财务损失','诽谤造成的声誉损失','没有财务后果的情绪困扰'],
  ans:1,
  okEn:'Correct. Pure economic loss is financial loss that does not flow from any physical harm to the plaintiff\'s person or property — courts have traditionally been cautious about allowing such claims.',
  okZh:'正确。纯粹经济损失是不来自原告人身或财产任何物理伤害的财务损失——法院历来对允许此类索赔持谨慎态度。',
  errEn:'Incorrect. Pure economic loss is financial loss that is not linked to physical injury or property damage.',
  errZh:'不正确。纯粹经济损失是与人身伤害或财产损害无关的财务损失。'},

// ── UNIT 8 ──────────────────────────────────────────────────
{ id:'u8q1', unit:8, type:'mcq', topic:'Australian Consumer Law',
  en:'The Australian Consumer Law (ACL) is contained in Schedule 2 of which Act?',
  zh:'《澳大利亚消费者法》（ACL）包含在哪部法令的附表2中？',
  opts:['ASIC Act 2001','Trade Practices Act 1974','Competition and Consumer Act 2010','Corporations Act 2001'],
  optsZh:['2001年《ASIC法》','1974年《贸易行为法》','2010年《竞争与消费者法》','2001年《公司法》'],
  ans:2,
  okEn:'Correct. The ACL is Schedule 2 of the Competition and Consumer Act 2010 (Cth) — it applies nationally to all consumer transactions.',
  okZh:'正确。ACL是《2010年竞争与消费者法》（联邦）的附表2——适用于所有消费者交易。',
  errEn:'Incorrect. The ACL is Schedule 2 of the Competition and Consumer Act 2010 (Cth).',
  errZh:'不正确。ACL是《2010年竞争与消费者法》（联邦）的附表2。'},

{ id:'u8q2', unit:8, type:'mcq', topic:'Misleading Conduct',
  en:'Section 18 of the ACL prohibits:',
  zh:'ACL第18条禁止：',
  opts:['Unfair contract terms','Misleading or deceptive conduct in trade or commerce','Consumer guarantees breaches','Unconscionable conduct only'],
  optsZh:['不公平合同条款','贸易或商业中的误导性或欺骗性行为','违反消费者保证','仅违反良知的行为'],
  ans:1,
  okEn:'Correct. Section 18 ACL: "A person must not, in trade or commerce, engage in conduct that is misleading or deceptive or is likely to mislead or deceive."',
  okZh:'正确。ACL第18条："在贸易或商业中，任何人不得从事误导性或欺骗性行为，或可能误导或欺骗的行为。"',
  errEn:'Incorrect. Section 18 ACL prohibits misleading or deceptive conduct in trade or commerce.',
  errZh:'不正确。ACL第18条禁止贸易或商业中的误导性或欺骗性行为。'},

{ id:'u8q3', unit:8, type:'mcq', topic:'Consumer Guarantees',
  en:'Under the ACL consumer guarantees, goods must be of "acceptable quality." This means they are:',
  zh:'根据ACL消费者保证，商品必须具有"可接受质量"。这意味着它们：',
  opts:['The cheapest available on the market','Safe, durable, free from defects, acceptable in appearance, and fit for all purposes','Exactly as described in any advertisement','Covered by a manufacturer\'s warranty'],
  optsZh:['市场上最便宜的','安全、耐用、无缺陷、外观可接受、适合所有用途','完全符合任何广告描述','有制造商保修'],
  ans:1,
  okEn:'Correct. Under s54 ACL, acceptable quality means the goods are safe, durable, free from defects, acceptable in appearance, and fit for all purposes for which goods of that kind are commonly supplied.',
  okZh:'正确。根据ACL第54条，可接受质量意味着商品安全、耐用、无缺陷、外观可接受，且适合该类商品通常供应的所有用途。',
  errEn:'Incorrect. "Acceptable quality" under s54 ACL means safe, durable, free from defects, acceptable in appearance, and fit for purpose.',
  errZh:'不正确。ACL第54条下的"可接受质量"意味着安全、耐用、无缺陷、外观可接受和适合用途。'},

{ id:'u8q4', unit:8, type:'fill', topic:'ACCC',
  blank:'The body that enforces the Australian Consumer Law at the national level is the ___.',
  blankZh:'在国家层面执行《澳大利亚消费者法》的机构是___。',
  accepts:['ACCC','accc','Australian Competition and Consumer Commission'],
  okEn:'Correct. The ACCC (Australian Competition and Consumer Commission) is the national regulator enforcing the ACL and competition laws.',
  okZh:'正确。ACCC（澳大利亚竞争与消费者委员会）是执行ACL和竞争法的国家监管机构。',
  errEn:'The answer is ACCC — Australian Competition and Consumer Commission, the national consumer law regulator.',
  errZh:'答案是ACCC——澳大利亚竞争与消费者委员会，国家消费者法监管机构。'},

{ id:'u8q5', unit:8, type:'mcq', topic:'Unfair Contract Terms',
  en:'Under s23 ACL, an unfair contract term in a standard form consumer contract is one that:',
  zh:'根据ACL第23条，标准格式消费者合同中的不公平合同条款是：',
  opts:['Is written in complex legal language','Creates a significant imbalance, is not reasonably necessary, and would cause financial or other detriment','Is longer than 5 pages','Requires arbitration of disputes'],
  optsZh:['使用复杂法律语言','造成显著不平衡、非合理必要、会造成财务或其他损害','超过5页','要求仲裁争议'],
  ans:1,
  okEn:'Correct. Under s23 ACL, an unfair term causes significant imbalance, is not reasonably necessary to protect the supplier\'s legitimate interests, and would cause detriment if relied upon.',
  okZh:'正确。根据ACL第23条，不公平条款造成显著不平衡、非合理必要以保护供应商合法利益、如被依赖会造成损害。',
  errEn:'Incorrect. An unfair term under s23 creates significant imbalance, is not reasonably necessary, and causes detriment.',
  errZh:'不正确。第23条下的不公平条款造成显著不平衡、非合理必要并造成损害。'},

{ id:'u8q6', unit:8, type:'tf', topic:'Consumer Remedies',
  stmt:'Under ACL consumer guarantees, a supplier must always offer a full refund for any faulty product.',
  stmtZh:'根据ACL消费者保证，供应商必须始终为任何有缺陷的产品提供全额退款。',
  ans:false,
  okEn:'Correct — FALSE. The remedy depends on the seriousness of the failure. Major failures entitle consumers to a refund, replacement, or compensation. Minor failures only require repair.',
  okZh:'正确——假。救济取决于故障的严重性。重大故障使消费者有权获得退款、更换或赔偿。轻微故障只需要修复。',
  errEn:'FALSE. Remedy depends on failure severity — major failures allow refund/replacement; minor failures only require repair.',
  errZh:'假。救济取决于故障严重性——重大故障允许退款/更换；轻微故障只需要修复。'},

// ── UNIT 9 ──────────────────────────────────────────────────
{ id:'u9q1', unit:9, type:'fill', topic:'ESG',
  blank:'ESG stands for Environmental, Social, and ___.',
  blankZh:'ESG代表环境、社会和___。',
  accepts:['Governance','governance'],
  okEn:'Correct. ESG = Environmental, Social, Governance — the three pillars used to measure a company\'s sustainability and ethical impact.',
  okZh:'正确。ESG=环境、社会、治理——用于衡量公司可持续性和道德影响的三个支柱。',
  errEn:'The answer is "Governance" — ESG: Environmental, Social, Governance.',
  errZh:'答案是"治理"——ESG：环境、社会、治理。'},

{ id:'u9q2', unit:9, type:'mcq', topic:"Carroll's CSR Pyramid",
  en:"Carroll's Pyramid of Corporate Social Responsibility (CSR) has four levels. What is the BASE (most fundamental) level?",
  zh:"卡罗尔的企业社会责任（CSR）金字塔有四个层次。什么是最基础（最基本）的层次？",
  opts:['Philanthropic responsibilities','Ethical responsibilities','Legal responsibilities','Economic responsibilities'],
  optsZh:['慈善责任','道德责任','法律责任','经济责任'],
  ans:3,
  okEn:"Correct. Carroll's Pyramid (from base to top): Economic → Legal → Ethical → Philanthropic. Economic is the foundation — businesses must be profitable to survive.",
  okZh:"正确。卡罗尔金字塔（从底部到顶部）：经济→法律→道德→慈善。经济是基础——企业必须盈利才能生存。",
  errEn:"Incorrect. The base of Carroll's Pyramid is economic responsibilities — businesses must be profitable.",
  errZh:"不正确。卡罗尔金字塔的基础是经济责任——企业必须盈利。"},

{ id:'u9q3', unit:9, type:'mcq', topic:'Triple Bottom Line',
  en:'The "Triple Bottom Line" (TBL) framework measures corporate performance in terms of:',
  zh:'"三重底线"（TBL）框架以什么来衡量企业绩效：',
  opts:['Revenue, costs, and profit','People, Planet, Profit','Quality, Safety, Environment','Shareholders, Stakeholders, Society'],
  optsZh:['收入、成本和利润','人、地球、利润','质量、安全、环境','股东、利益相关者、社会'],
  ans:1,
  okEn:'Correct. The TBL (Elkington, 1994) measures social (People), environmental (Planet), and financial (Profit) performance.',
  okZh:'正确。三重底线（Elkington，1994年）衡量社会（人）、环境（地球）和财务（利润）绩效。',
  errEn:'Incorrect. The Triple Bottom Line measures People (social), Planet (environmental), and Profit (financial).',
  errZh:'不正确。三重底线衡量人（社会）、地球（环境）和利润（财务）。'},

{ id:'u9q4', unit:9, type:'mcq', topic:'Stakeholder Theory',
  en:'Stakeholder Theory, developed by R. Edward Freeman, argues that businesses should create value for:',
  zh:'由R.爱德华·弗里曼提出的利益相关者理论认为，企业应该为以下对象创造价值：',
  opts:['Shareholders only','Shareholders and bondholders only','All stakeholders who affect or are affected by the company','Only employees and customers'],
  optsZh:['仅股东','仅股东和债券持有人','影响公司或受公司影响的所有利益相关者','仅员工和客户'],
  ans:2,
  okEn:'Correct. Freeman\'s Stakeholder Theory holds that companies have responsibilities to all stakeholders — shareholders, employees, suppliers, customers, communities, and the environment.',
  okZh:'正确。弗里曼的利益相关者理论认为，公司对所有利益相关者负有责任——股东、员工、供应商、客户、社区和环境。',
  errEn:'Incorrect. Stakeholder Theory holds businesses are responsible to all parties who affect or are affected by them.',
  errZh:'不正确。利益相关者理论认为企业对影响他们或受他们影响的所有方负有责任。'},

{ id:'u9q5', unit:9, type:'mcq', topic:'UN SDGs',
  en:'The United Nations Sustainable Development Goals (SDGs) were adopted as part of the 2030 Agenda in which year?',
  zh:'联合国可持续发展目标（SDGs）作为2030年议程的一部分，是在哪年通过的？',
  opts:['2000','2010','2015','2020'],
  optsZh:['2000年','2010年','2015年','2020年'],
  ans:2,
  okEn:'Correct. The 17 SDGs were adopted by all UN member states in 2015 as the "2030 Agenda for Sustainable Development."',
  okZh:'正确。17个可持续发展目标于2015年由所有联合国成员国通过，作为"2030年可持续发展议程"。',
  errEn:'Incorrect. The 17 SDGs were adopted by UN member states in 2015.',
  errZh:'不正确。17个可持续发展目标于2015年由联合国成员国通过。'},

{ id:'u9q6', unit:9, type:'tf', topic:'Greenwashing',
  stmt:'Greenwashing involves making false or misleading environmental claims about a company\'s products or practices.',
  stmtZh:'洗绿行为包括对公司产品或做法作出虚假或误导性的环境声明。',
  ans:true,
  okEn:'Correct — TRUE. Greenwashing is when companies make misleading or unsubstantiated claims about their environmental credentials — enforceable under s18 ACL by the ACCC.',
  okZh:'正确——真。洗绿是公司对其环境资质作出误导性或无根据声明的行为——ACCC可依据ACL第18条执行。',
  errEn:'TRUE. Greenwashing — false or misleading environmental claims — is enforceable under ACL s18 by the ACCC.',
  errZh:'真。洗绿——虚假或误导性环境声明——ACCC可依据ACL第18条执行。'},

// ── UNIT 10 ──────────────────────────────────────────────────
{ id:'u10q1', unit:10, type:'mcq', topic:'EPBC Act',
  en:'The EPBC Act 1999 stands for:',
  zh:'EPBC法案1999年代表：',
  opts:['Environmental Protection and Business Compliance Act','Environment Protection and Biodiversity Conservation Act','Ecological Planning and Building Code Act','Environmental Permit and Business Conduct Act'],
  optsZh:['环境保护和企业合规法','环境保护和生物多样性保护法','生态规划和建筑规范法','环境许可和企业行为法'],
  ans:1,
  okEn:'Correct. The Environment Protection and Biodiversity Conservation Act 1999 (Cth) is Australia\'s main national environmental law, protecting biodiversity and significant environmental matters.',
  okZh:'正确。《1999年环境保护和生物多样性保护法》（联邦）是澳大利亚主要的国家环境法，保护生物多样性和重要环境事项。',
  errEn:'Incorrect. EPBC = Environment Protection and Biodiversity Conservation Act 1999.',
  errZh:'不正确。EPBC = 1999年环境保护和生物多样性保护法。'},

{ id:'u10q2', unit:10, type:'mcq', topic:'Climate Change Act 2022',
  en:'Australia\'s Climate Change Act 2022 set a target to reduce greenhouse gas emissions by what percentage by 2030 (compared to 2005 levels)?',
  zh:'澳大利亚《2022年气候变化法》设定了到2030年（与2005年水平相比）减少温室气体排放的目标是多少？',
  opts:['26–28%','35%','43%','50%'],
  optsZh:['26-28%','35%','43%','50%'],
  ans:2,
  okEn:'Correct. The Climate Change Act 2022 enshrined a 43% reduction in emissions by 2030 (from 2005 levels) and net zero by 2050 into law.',
  okZh:'正确。《2022年气候变化法》将到2030年减排43%（与2005年水平相比）和到2050年净零排放写入法律。',
  errEn:'Incorrect. The Climate Change Act 2022 targets a 43% reduction in emissions by 2030 from 2005 levels.',
  errZh:'不正确。《2022年气候变化法》目标是到2030年从2005年水平减排43%。'},

{ id:'u10q3', unit:10, type:'mcq', topic:'Modern Slavery Act',
  en:'The Modern Slavery Act 2018 (Cth) requires Australian entities with annual consolidated revenue over ___ to report on modern slavery risks in their supply chains.',
  zh:'《2018年现代奴役法》（联邦）要求年合并收入超过___的澳大利亚实体报告其供应链中的现代奴役风险。',
  opts:['$10 million','$50 million','$100 million','$500 million'],
  optsZh:['1000万澳元','5000万澳元','1亿澳元','5亿澳元'],
  ans:2,
  okEn:'Correct. Entities with consolidated annual revenue of AU$100 million or more must submit an annual Modern Slavery Statement to the government.',
  okZh:'正确。年合并收入达1亿澳元或以上的实体必须向政府提交年度现代奴役声明。',
  errEn:'Incorrect. The threshold is $100 million annual consolidated revenue.',
  errZh:'不正确。门槛是年合并收入1亿澳元。'},

{ id:'u10q4', unit:10, type:'tf', topic:'Paris Agreement',
  stmt:'The Paris Agreement legally binds all signatory nations to achieve specific quantified greenhouse gas emission reductions.',
  stmtZh:'《巴黎协定》在法律上约束所有签署国实现特定量化的温室气体减排目标。',
  ans:false,
  okEn:'Correct — FALSE. While the Paris Agreement framework is legally binding, each country\'s Nationally Determined Contribution (NDC) is self-set and voluntary — there is no international enforcement mechanism.',
  okZh:'正确——假。虽然《巴黎协定》框架具有法律约束力，但每个国家的国家自主贡献（NDC）是自行设定的且是自愿的——没有国际执行机制。',
  errEn:'FALSE. The Paris Agreement framework is binding, but each country\'s specific emission targets (NDCs) are nationally determined and voluntary.',
  errZh:'假。《巴黎协定》框架具有约束力，但每个国家的具体减排目标（NDC）是国家自主确定且自愿的。'},

{ id:'u10q5', unit:10, type:'mcq', topic:'ASX Governance',
  en:'The ASX Corporate Governance Principles and Recommendations are published by:',
  zh:'ASX企业治理原则和建议由谁发布：',
  opts:['ASIC','APRA','ASX Corporate Governance Council','Australian Treasury'],
  optsZh:['ASIC','APRA','ASX企业治理委员会','澳大利亚财政部'],
  ans:2,
  okEn:'Correct. The ASX Corporate Governance Council (comprising ASX and 20+ investor and business groups) publishes the Principles and Recommendations used by listed entities.',
  okZh:'正确。ASX企业治理委员会（由ASX和20多个投资者和商业团体组成）发布上市实体使用的原则和建议。',
  errEn:'Incorrect. The ASX Corporate Governance Principles are published by the ASX Corporate Governance Council.',
  errZh:'不正确。ASX企业治理原则由ASX企业治理委员会发布。'},

{ id:'u10q6', unit:10, type:'mcq', topic:'Greenwashing Enforcement',
  en:'In Australia, greenwashing enforcement against misleading environmental claims is primarily carried out by:',
  zh:'在澳大利亚，针对误导性环境声明的洗绿执法主要由谁进行：',
  opts:['EPA (Environment Protection Authority)','APRA','ACCC','ASIC'],
  optsZh:['EPA（环境保护局）','APRA','ACCC','ASIC'],
  ans:2,
  okEn:'Correct. The ACCC enforces ACL s18 against misleading environmental claims. ASIC also takes action on misleading sustainability claims by financial entities.',
  okZh:'正确。ACCC依据ACL第18条针对误导性环境声明执法。ASIC也对金融实体的误导性可持续发展声明采取行动。',
  errEn:'Incorrect. The ACCC primarily enforces against greenwashing under ACL s18. ASIC may also act in financial services.',
  errZh:'不正确。ACCC主要依据ACL第18条针对洗绿行为执法。ASIC也可能在金融服务领域采取行动。'},

// ── UNIT 11 ──────────────────────────────────────────────────
{ id:'u11q1', unit:11, type:'mcq', topic:'Director Duties',
  en:'Section 180 of the Corporations Act 2001 requires directors to exercise their powers with:',
  zh:'《2001年公司法》第180条要求董事以以下方式行使其权力：',
  opts:['Maximum profit for shareholders at all times','The degree of care and diligence of a reasonable person in their position','Absolute caution avoiding all business risk','Strict compliance with all stakeholder wishes'],
  optsZh:['始终为股东最大化利润','处于其职位的理性人的谨慎和勤勉程度','绝对谨慎避免所有商业风险','严格遵守所有利益相关者的意愿'],
  ans:1,
  okEn:'Correct. Section 180 imposes an objective standard — the care and diligence of a reasonable person with the same responsibilities, informed about the company.',
  okZh:'正确。第180条施加客观标准——承担相同责任、了解公司的理性人的谨慎和勤勉程度。',
  errEn:'Incorrect. Section 180 requires the care and diligence of a reasonable person in the same position.',
  errZh:'不正确。第180条要求处于相同职位的理性人的谨慎和勤勉程度。'},

{ id:'u11q2', unit:11, type:'mcq', topic:'Director Duties',
  en:'Section 181 of the Corporations Act requires directors to act:',
  zh:'《公司法》第181条要求董事：',
  opts:['To maximise short-term shareholder returns','In good faith in the best interests of the corporation and for a proper purpose','Only in their own financial interests','To follow all instructions from majority shareholders'],
  optsZh:['最大化短期股东回报','善意地为了公司的最佳利益并出于正当目的行事','仅为自身财务利益','遵循所有多数股东的指示'],
  ans:1,
  okEn:'Correct. Section 181 imposes a duty of good faith — directors must act honestly in the best interests of the company as a whole, not personal gain.',
  okZh:'正确。第181条施加诚信义务——董事必须为了整个公司的最佳利益诚实行事，而非个人利益。',
  errEn:'Incorrect. Section 181 requires directors to act in good faith in the best interests of the corporation for a proper purpose.',
  errZh:'不正确。第181条要求董事善意地为了公司的最佳利益出于正当目的行事。'},

{ id:'u11q3', unit:11, type:'match', topic:'Sustainability Frameworks',
  en:'Match each sustainability concept to its description.',
  zh:'将每个可持续发展概念与其描述配对。',
  pairs:[
    {term:'ESG',                        def:'Environmental, Social, and Governance criteria'},
    {term:"Carroll's Pyramid",          def:'CSR: Economic→Legal→Ethical→Philanthropic'},
    {term:'Triple Bottom Line',         def:'People, Planet, and Profit framework'},
    {term:'Stakeholder Theory',         def:'Businesses create value for all affected parties'},
  ],
  pairsZh:[
    {term:'ESG',               def:'环境、社会和治理标准'},
    {term:'卡罗尔金字塔',       def:'CSR：经济→法律→道德→慈善'},
    {term:'三重底线',           def:'人、地球和利润框架'},
    {term:'利益相关者理论',     def:'企业为所有受影响方创造价值'},
  ],
  okEn:'Excellent! All sustainability frameworks correctly matched.',
  okZh:'优秀！所有可持续发展框架均正确匹配。',
  errEn:'Incorrect. Review the core sustainability frameworks.',
  errZh:'匹配错误。请复习核心可持续发展框架。'},

{ id:'u11q4', unit:11, type:'mcq', topic:'Whistleblower Protections',
  en:'Under the Corporations Act 2001, whistleblower protections apply to disclosures about:',
  zh:'根据《2001年公司法》，举报人保护适用于关于以下内容的披露：',
  opts:['Only fraud against the government','Misconduct, breach of the law, or financial crimes involving corporations','Personal grievances about working conditions','Tax avoidance by individuals'],
  optsZh:['仅针对政府的欺诈','涉及公司的不当行为、违法行为或金融犯罪','关于工作条件的个人申诉','个人避税'],
  ans:1,
  okEn:'Correct. Whistleblower protections under Part 9.4AAA of the Corporations Act cover disclosures of misconduct, legal breaches, financial crimes, and other improper conduct by corporations.',
  okZh:'正确。《公司法》第9.4AAA部分的举报人保护涵盖公司不当行为、违法行为、金融犯罪和其他不当行为的披露。',
  errEn:'Incorrect. Whistleblower protections cover misconduct, legal breaches, and financial crimes involving corporations.',
  errZh:'不正确。举报人保护涵盖涉及公司的不当行为、违法行为和金融犯罪。'},

{ id:'u11q5', unit:11, type:'tf', topic:'Profit and Sustainability',
  stmt:'According to the Triple Bottom Line concept, a company can be both profitable and environmentally sustainable simultaneously.',
  stmtZh:'根据三重底线概念，公司可以同时具有盈利性和环境可持续性。',
  ans:true,
  okEn:'Correct — TRUE. The TBL framework argues that sustainable business practices (People + Planet) can coexist with and even enhance long-term Profit.',
  okZh:'正确——真。三重底线框架认为，可持续的商业实践（人+地球）可以与长期利润共存，甚至提升长期利润。',
  errEn:'TRUE. The Triple Bottom Line shows profitability and sustainability are not mutually exclusive — sustainable practices can enhance long-term profit.',
  errZh:'真。三重底线表明盈利能力和可持续性并不互斥——可持续做法可以提升长期利润。'},

{ id:'u11q6', unit:11, type:'mcq', topic:'ASX Governance Principles',
  en:'Which of the following is NOT one of the ASX Corporate Governance Principles?',
  zh:'下列哪项不是ASX企业治理原则之一？',
  opts:['Lay solid foundations for management and oversight','Act ethically and responsibly','Maximise short-term returns to shareholders','Recognise and manage risk'],
  optsZh:['为管理和监督奠定坚实基础','道德地和负责任地行事','最大化对股东的短期回报','识别和管理风险'],
  ans:2,
  okEn:'Correct. "Maximise short-term returns" is NOT an ASX Governance Principle. The 8 principles focus on transparency, ethics, risk management, and accountability — not short-term profit maximisation.',
  okZh:'正确。"最大化短期回报"不是ASX治理原则。8项原则关注透明度、道德、风险管理和问责制——而非短期利润最大化。',
  errEn:'Incorrect. "Maximise short-term returns" is not an ASX Governance Principle — the principles focus on governance, ethics, and risk.',
  errZh:'不正确。"最大化短期回报"不是ASX治理原则——原则关注治理、道德和风险。'},

// ===== UNIT 0 EXTENDED =====
{ id:'u0q5', unit:0, type:'mcq', topic:'CLO2 — Legal Framework',
  en:'CLO2 of this course requires students to do what?',
  zh:'本课程CLO2要求学生做什么？',
  opts:['Memorise all case names','Analyse business scenarios using legal frameworks','Pass the bar exam','Write legislation'],
  optsZh:['记住所有案例名称','运用法律框架分析商业场景','通过律师资格考试','起草法律'],
  ans:1,
  okEn:'Correct. CLO2 focuses on applying legal frameworks to analyse real-world business scenarios.',
  okZh:'正确。CLO2侧重于运用法律框架分析现实商业场景。',
  errEn:'Incorrect. CLO2 is about applying legal frameworks to business scenarios, not memorisation or professional admission.',
  errZh:'不正确。CLO2是关于将法律框架应用于商业场景，而非记忆或专业资格认证。'},

{ id:'u0q6', unit:0, type:'tf', topic:'Assessment Weighting',
  en:'The final exam in this course is worth more than 50% of the total grade.',
  zh:'本课程期末考试占总成绩50%以上。',
  ans:false,
  okEn:'Correct — FALSE. The assessment is distributed across multiple components (assignments, quizzes, exam) so no single component exceeds 50%.',
  okZh:'正确——假。评估分布在多个组成部分（作业、测验、考试），因此没有单一部分超过50%。',
  errEn:'Incorrect — FALSE. Assessment is distributed; the final exam does not exceed 50%.',
  errZh:'不正确——假。评估是分散的；期末考试不超过50%。'},

{ id:'u0q7', unit:0, type:'mcq', topic:'Business Environments',
  en:'What does "business environments" encompass in this course?',
  zh:'"商业环境"在本课程中包括什么？',
  opts:['Only economic conditions','Legal, ethical, social and regulatory contexts of business','The physical office environment','Marketing and sales conditions'],
  optsZh:['仅限经济条件','商业的法律、伦理、社会和监管背景','实体办公环境','营销和销售条件'],
  ans:1,
  okEn:'Correct. Business environments include legal, ethical, social and regulatory contexts that affect how businesses operate.',
  okZh:'正确。商业环境包括影响企业运营方式的法律、伦理、社会和监管背景。',
  errEn:'Incorrect. Business environments cover legal, ethical, social and regulatory contexts — much broader than just economics.',
  errZh:'不正确。商业环境涵盖法律、伦理、社会和监管背景——比单纯的经济学范围更广。'},

// ===== UNIT 1 EXTENDED =====
{ id:'u1q7', unit:1, type:'mcq', topic:'Rule of Law — Principles',
  en:'Which of the following is NOT one of the 5 principles of the Rule of Law?',
  zh:'下列哪项不是法治的5项原则之一？',
  opts:['Equality before the law','Law is supreme over all persons','Government can act without legal authority','Independent judiciary'],
  optsZh:['法律面前人人平等','法律高于所有人','政府可以无需法律授权行事','独立的司法机构'],
  ans:2,
  okEn:'Correct. "Government can act without legal authority" contradicts the Rule of Law — governments MUST have legal authority for their actions.',
  okZh:'正确。"政府可以无需法律授权行事"与法治相悖——政府必须有法律授权才能行动。',
  errEn:'Incorrect. Governments must always act with legal authority — acting without it violates the Rule of Law.',
  errZh:'不正确。政府必须始终有法律授权行事——没有授权行事违反了法治原则。'},

{ id:'u1q8', unit:1, type:'mcq', topic:'Separation of Powers',
  en:'Which arm of government is responsible for MAKING laws?',
  zh:'政府哪个部门负责制定法律？',
  opts:['Judiciary','Executive','Legislature','Administrative tribunals'],
  optsZh:['司法机构','行政机构','立法机构','行政裁判所'],
  ans:2,
  okEn:'Correct. The Legislature (Parliament) is responsible for making laws. The Executive administers them and the Judiciary interprets them.',
  okZh:'正确。立法机构（议会）负责制定法律。行政机构执行法律，司法机构解释法律。',
  errEn:'Incorrect. The Legislature makes laws. The Executive administers laws, the Judiciary interprets laws.',
  errZh:'不正确。立法机构制定法律。行政机构执行法律，司法机构解释法律。'},

{ id:'u1q9', unit:1, type:'tf', topic:'Division of Powers — Residual',
  en:'Under the Australian Constitution, matters not listed as Commonwealth powers are left to the States.',
  zh:'根据澳大利亚宪法，未列为联邦权力的事项归各州管辖。',
  ans:true,
  okEn:'Correct — TRUE. Residual powers belong to the States. The Constitution only grants specific (enumerated) powers to the Commonwealth.',
  okZh:'正确——真。剩余权力属于各州。宪法只授予联邦特定（列举）权力。',
  errEn:'Incorrect — TRUE. States retain residual powers for matters not granted to the Commonwealth.',
  errZh:'不正确——真。各州保留未授予联邦的事项的剩余权力。'},

{ id:'u1q10', unit:1, type:'scenario', topic:'Constitutional Powers',
  en:'[SCENARIO]\nThe Commonwealth Parliament passes a law regulating the content of university courses across Australia, arguing it promotes economic development.\n[QUESTION]\nUnder which constitutional head of power would the Commonwealth most likely justify this law?',
  zh:'[场景]\n联邦议会通过一项法律，规范全澳大利亚大学课程内容，声称这促进了经济发展。\n[问题]\n联邦最可能依据哪个宪法权力来证明这部法律的合理性？',
  opts:['The corporations power (s51(xx))','The education power','The trade and commerce power (s51(i))','The defence power'],
  optsZh:['公司权力（第51(xx)条）','教育权力','贸易和商业权力（第51(i)条）','国防权力'],
  ans:0,
  okEn:'Correct. There is no direct education head of power — the Commonwealth often relies on the corporations power to regulate universities as constitutional corporations.',
  okZh:'正确。没有直接的教育权力——联邦通常依赖公司权力来规范大学作为宪法公司。',
  errEn:'Incorrect. There is no Commonwealth "education power." The corporations power is most commonly used to regulate university activities.',
  errZh:'不正确。没有联邦"教育权力"。公司权力最常用于规范大学活动。'},

{ id:'u1q11', unit:1, type:'fill', topic:'Referendum',
  en:'The section of the Australian Constitution that sets out the procedure for amending the Constitution is s___.',
  zh:'澳大利亚宪法中规定修宪程序的条款是第___条。',
  answers:['128','s128','section 128'],
  okEn:'Correct. Section 128 of the Constitution requires a double majority: national majority of voters AND majority in at least 4 of 6 states.',
  okZh:'正确。宪法第128条要求双重多数：全国选民多数以及至少6个州中4个州的多数。',
  errEn:'Incorrect. Section 128 governs constitutional amendments, requiring a double majority (national vote + 4/6 states).',
  errZh:'不正确。第128条规定宪法修正案，要求双重多数（全国投票+6个州中的4个）。'},

{ id:'u1q12', unit:1, type:'mcq', topic:'Protection of Rights',
  en:'Australia does NOT have a general bill of rights. How are rights primarily protected at the federal level?',
  zh:'澳大利亚没有一般性权利法案。在联邦层面，权利主要如何受到保护？',
  opts:['Through the Corporations Act 2001','Through a few express constitutional rights and judicial interpretation','Through the Human Rights Act','Through the Privacy Act only'],
  optsZh:['通过2001年《公司法》','通过少数明确的宪法权利和司法解释','通过《人权法》','仅通过《隐私法》'],
  ans:1,
  okEn:'Correct. Australia has only a few explicit constitutional rights (e.g. trial by jury, acquisition on just terms) — rights are largely protected through common law and limited constitutional interpretation.',
  okZh:'正确。澳大利亚只有少数明确的宪法权利（如陪审团审判、公正条款征用）——权利主要通过普通法和有限的宪法解释来保护。',
  errEn:'Incorrect. Australia has no general bill of rights; protection comes from a few express constitutional rights plus common law.',
  errZh:'不正确。澳大利亚没有一般性权利法案；保护来自少数明确的宪法权利加上普通法。'},

// ===== UNIT 2 EXTENDED =====
{ id:'u2q7', unit:2, type:'mcq', topic:'Statute Law vs Common Law',
  en:'When statute law and common law conflict, which prevails?',
  zh:'当成文法与普通法发生冲突时，哪个优先？',
  opts:['Common law always prevails','Statute law always prevails','Equity prevails','It depends on the court'],
  optsZh:['普通法始终优先','成文法始终优先','衡平法优先','取决于法院'],
  ans:1,
  okEn:'Correct. Statute law (Acts of Parliament) prevails over common law. Parliament is supreme, and can override or modify judge-made law.',
  okZh:'正确。成文法（议会法案）优先于普通法。议会至高无上，可以推翻或修改法官制定的法律。',
  errEn:'Incorrect. Statute law prevails over common law — parliamentary supremacy means Parliament can override judge-made law.',
  errZh:'不正确。成文法优先于普通法——议会主权意味着议会可以推翻法官制定的法律。'},

{ id:'u2q8', unit:2, type:'tf', topic:'Equity',
  en:'Equity developed to provide remedies that common law courts could not offer, such as injunctions and specific performance.',
  zh:'衡平法的发展是为了提供普通法法院无法提供的救济，例如禁令和强制履行。',
  ans:true,
  okEn:'Correct — TRUE. Equity developed in the Court of Chancery to remedy the harshness and inflexibility of the common law, offering remedies like injunctions, specific performance, and trusts.',
  okZh:'正确——真。衡平法在大法官法院发展起来，以弥补普通法的严苛和僵化，提供禁令、强制履行和信托等救济。',
  errEn:'Incorrect — TRUE. Equity provides remedies unavailable at common law (injunctions, specific performance, constructive trusts).',
  errZh:'不正确——真。衡平法提供普通法无法提供的救济（禁令、强制履行、推定信托）。'},

{ id:'u2q9', unit:2, type:'mcq', topic:'How a Bill Becomes Law',
  en:'What is the FINAL step before a bill becomes an Act of Parliament in Australia?',
  zh:'在澳大利亚，法案成为议会法案前的最后步骤是什么？',
  opts:['Passed by the Senate','Royal Assent from the Governor-General','Approved by the High Court','Published in the Gazette'],
  optsZh:['参议院通过','总督御准','高等法院批准','在政府公报上公布'],
  ans:1,
  okEn:'Correct. After passing both Houses of Parliament, a bill requires Royal Assent from the Governor-General to become law.',
  okZh:'正确。法案经两院通过后，需要总督御准才能成为法律。',
  errEn:'Incorrect. The final step is Royal Assent from the Governor-General (representing the Crown).',
  errZh:'不正确。最后一步是总督（代表王室）的御准。'},

{ id:'u2q10', unit:2, type:'mcq', topic:'Jurisdiction',
  en:'Which court has ORIGINAL jurisdiction to hear constitutional matters in Australia?',
  zh:'澳大利亚哪个法院对宪法事项具有初始管辖权？',
  opts:['Federal Court of Australia','Supreme Court of NSW','High Court of Australia','District Court'],
  optsZh:['澳大利亚联邦法院','新南威尔士州最高法院','澳大利亚高等法院','地区法院'],
  ans:2,
  okEn:'Correct. The High Court has original jurisdiction over constitutional matters. It is also the final court of appeal in Australia.',
  okZh:'正确。高等法院对宪法事项具有初始管辖权。它也是澳大利亚的最终上诉法院。',
  errEn:'Incorrect. The High Court has original jurisdiction for constitutional matters and is the final court of appeal.',
  errZh:'不正确。高等法院对宪法事项具有初始管辖权，也是最终上诉法院。'},

{ id:'u2q11', unit:2, type:'scenario', topic:'Precedent',
  en:'[SCENARIO]\nA judge is deciding a contract dispute. She finds a case from the Full Court of the Supreme Court of NSW that directly addresses the issue, and a House of Lords (UK) case with persuasive reasoning.\n[QUESTION]\nWhich case must she follow?',
  zh:'[场景]\n一名法官正在裁决合同纠纷。她找到了新南威尔士州最高法院全院直接处理该问题的案例，以及一个具有说服力推理的英国上议院案例。\n[问题]\n她必须遵循哪个案例？',
  opts:['The House of Lords case — it is more authoritative','The Full Court NSW case — it is binding on her as a lower NSW court','Either — she has a free choice','Neither — she must decide independently'],
  optsZh:['英国上议院案例——它更权威','新南威尔士州全院案例——作为较低级的新南威尔士州法院对她有约束力','任何一个——她可以自由选择','两者都不——她必须独立判决'],
  ans:1,
  okEn:'Correct. The Full Court of the Supreme Court of NSW is binding on lower NSW courts. The House of Lords is only persuasive (not binding) in Australian courts.',
  okZh:'正确。新南威尔士州最高法院全院对新南威尔士州下级法院具有约束力。英国上议院在澳大利亚法院仅具有说服力（无约束力）。',
  errEn:'Incorrect. A Full Court decision in the same court hierarchy is binding; House of Lords is only persuasive in Australia.',
  errZh:'不正确。同一法院层级的全院裁决具有约束力；英国上议院在澳大利亚仅具有说服力。'},

{ id:'u2q12', unit:2, type:'fill', topic:'Ratio Decidendi',
  en:'The binding part of a judgment — the legal reason for the decision — is called the ___.',
  zh:'判决中具有约束力的部分——裁决的法律理由——被称为___。',
  answers:['ratio decidendi','ratio','ratio decidendi (ratio)'],
  okEn:'Correct. Ratio decidendi is the binding legal principle from a case. Obiter dicta are non-binding remarks "by the way."',
  okZh:'正确。Ratio decidendi是案件中具有约束力的法律原则。Obiter dicta是非约束性的"附带"评论。',
  errEn:'Incorrect. The binding reason is "ratio decidendi." "Obiter dictum" refers to non-binding statements made in passing.',
  errZh:'不正确。具有约束力的理由是"ratio decidendi"。"Obiter dictum"是指附带的非约束性陈述。'},

// ===== UNIT 3 EXTENDED =====
{ id:'u3q7', unit:3, type:'tf', topic:'Sole Trader',
  en:'A sole trader and their business are considered the same legal entity.',
  zh:'独资经营者与其业务被视为同一法律实体。',
  ans:true,
  okEn:'Correct — TRUE. A sole trader has no separate legal entity — the person IS the business. This creates unlimited personal liability.',
  okZh:'正确——真。独资经营者没有独立的法律实体——个人就是业务。这产生无限的个人责任。',
  errEn:'Incorrect — TRUE. Sole traders have no separate legal entity; the person and business are the same, creating unlimited liability.',
  errZh:'不正确——真。独资经营者没有独立的法律实体；个人和业务相同，产生无限责任。'},

{ id:'u3q8', unit:3, type:'mcq', topic:'Partnership — Fiduciary Duties',
  en:'Partners owe each other fiduciary duties. Which of the following is a key fiduciary duty of a partner?',
  zh:'合伙人相互负有信义义务。以下哪项是合伙人的关键信义义务？',
  opts:['To maximise personal profit at all times','To act in good faith and in the best interests of the partnership','To avoid paying tax','To compete freely with other partners'],
  optsZh:['始终最大化个人利润','诚信行事并以合伙企业最大利益行事','避免纳税','与其他合伙人自由竞争'],
  ans:1,
  okEn:'Correct. Partners must act in good faith and prioritise partnership interests over personal interests — a key fiduciary duty.',
  okZh:'正确。合伙人必须诚信行事，将合伙企业利益置于个人利益之上——这是关键的信义义务。',
  errEn:'Incorrect. Fiduciary duty requires acting in good faith and in the best interests of the partnership, not pursuing personal gain.',
  errZh:'不正确。信义义务要求诚信行事并以合伙企业最大利益行事，而非追求个人利益。'},

{ id:'u3q9', unit:3, type:'mcq', topic:'Company — Separate Legal Entity',
  en:'The principle from Salomon v Salomon [1897] establishes that a company:',
  zh:'Salomon v Salomon [1897]案确立的原则是，公司：',
  opts:['Cannot be sued separately from its shareholders','Is a separate legal entity distinct from its shareholders','Must be owned by at least two people','Has unlimited liability'],
  optsZh:['不能与股东分开被起诉','是与股东不同的独立法律实体','必须至少由两人拥有','具有无限责任'],
  ans:1,
  okEn:'Correct. Salomon v Salomon established the fundamental principle that a company is a separate legal entity — the "corporate veil" separates the company from its members.',
  okZh:'正确。Salomon v Salomon确立了公司是独立法律实体的基本原则——"公司面纱"将公司与其成员分开。',
  errEn:'Incorrect. The key principle is separate legal entity — a company exists independently of its shareholders (Salomon v Salomon).',
  errZh:'不正确。关键原则是独立法律实体——公司独立于其股东存在（Salomon v Salomon案）。'},

{ id:'u3q10', unit:3, type:'scenario', topic:'Business Structure Liability',
  en:'[SCENARIO]\nAnna and Bob run a small accounting firm as a general partnership. The partnership incurs a debt of $500,000 that it cannot repay. Anna has personal assets worth $200,000.\n[QUESTION]\nWhat is Anna\'s maximum liability?',
  zh:'[场景]\n安娜和鲍勃以普通合伙形式经营一家小型会计师事务所。合伙企业产生了50万美元无法偿还的债务。安娜有价值20万美元的个人资产。\n[问题]\n安娜的最高责任是多少？',
  opts:['Only $250,000 (her 50% share)','Only $200,000 (limited to her assets)','Her full personal assets — up to the entire $500,000','Nothing — partnerships have limited liability'],
  optsZh:['仅25万美元（她50%的份额）','仅20万美元（限于她的资产）','她全部的个人资产——最高可达50万美元','没有——合伙企业具有有限责任'],
  ans:2,
  okEn:'Correct. In a general partnership, partners have unlimited joint and several liability. Anna is personally liable for the FULL debt — up to losing all her personal assets.',
  okZh:'正确。在普通合伙中，合伙人具有无限连带责任。安娜对全部债务承担个人责任——最高可损失所有个人资产。',
  errEn:'Incorrect. General partnership means unlimited joint and several liability — Anna is liable for the full $500,000 (beyond just her assets).',
  errZh:'不正确。普通合伙意味着无限连带责任——安娜对全部50万美元承担责任（超出她的资产）。'},

{ id:'u3q11', unit:3, type:'mcq', topic:'Trust Structure',
  en:'In a trust structure, who holds the legal title to the trust assets?',
  zh:'在信托结构中，谁持有信托资产的法定所有权？',
  opts:['The beneficiaries','The settlor','The trustee','The government'],
  optsZh:['受益人','委托人','受托人','政府'],
  ans:2,
  okEn:'Correct. The trustee holds legal title to assets and manages them for the benefit of the beneficiaries who hold the equitable/beneficial interest.',
  okZh:'正确。受托人持有资产的法定所有权，并为持有衡平/受益权益的受益人管理资产。',
  errEn:'Incorrect. The trustee holds legal title. Beneficiaries hold the equitable (beneficial) interest but not the legal title.',
  errZh:'不正确。受托人持有法定所有权。受益人持有衡平（受益）权益，但不持有法定所有权。'},

{ id:'u3q12', unit:3, type:'fill', topic:'Company Registration',
  en:'All Australian companies must be registered under the ___ Act 2001.',
  zh:'所有澳大利亚公司必须根据___法案2001年注册。',
  answers:['Corporations','corporations act','corporations act 2001'],
  okEn:'Correct. The Corporations Act 2001 (Cth) is the primary legislation governing companies in Australia.',
  okZh:'正确。2001年《公司法》（联邦）是澳大利亚管理公司的主要立法。',
  errEn:'Incorrect. Companies register under the Corporations Act 2001 (Cth), administered by ASIC.',
  errZh:'不正确。公司根据2001年《公司法》（联邦）注册，由ASIC管理。'},

// ===== UNIT 4 EXTENDED =====
{ id:'u4q7', unit:4, type:'mcq', topic:'Offer vs Invitation to Treat',
  en:'In Fisher v Bell [1961], a flick-knife displayed in a shop window with a price tag was held to be:',
  zh:'在Fisher v Bell [1961]案中，陈列在橱窗中附有价格标签的弹簧刀被认定为：',
  opts:['An offer to sell','An acceptance of purchase','An invitation to treat','A binding contract'],
  optsZh:['出售的要约','接受购买','邀请要约','具有约束力的合同'],
  ans:2,
  okEn:'Correct. Fisher v Bell confirmed that goods displayed in a shop window are an invitation to treat, not an offer. The customer makes the offer at the counter.',
  okZh:'正确。Fisher v Bell确认，陈列在橱窗中的商品是邀请要约，而非要约。顾客在柜台处提出要约。',
  errEn:'Incorrect. Fisher v Bell: shop displays are invitations to treat. The customer offers to buy; the shop accepts or rejects.',
  errZh:'不正确。Fisher v Bell案：商店陈列是邀请要约。顾客提出购买要约；商店接受或拒绝。'},

{ id:'u4q8', unit:4, type:'mcq', topic:'Postal Acceptance Rule',
  en:'The postal acceptance rule states that acceptance is effective when:',
  zh:'邮政承诺规则规定，承诺在以下情况下生效：',
  opts:['The letter is received by the offeror','The offeror reads the letter','The letter is posted (placed in the letterbox)','The offeror confirms receipt'],
  optsZh:['要约人收到信件时','要约人阅读信件时','信件寄出时（放入信箱）','要约人确认收到时'],
  ans:2,
  okEn:'Correct. The postal acceptance rule (Adams v Lindsell) states acceptance is complete when the letter is posted — even if lost in the mail.',
  okZh:'正确。邮政承诺规则（Adams v Lindsell案）规定，信件寄出时承诺即完成——即使信件在邮递过程中丢失。',
  errEn:'Incorrect. The postal rule: acceptance is complete on posting (not on receipt). This is an exception to the general communication rule.',
  errZh:'不正确。邮政规则：承诺在寄出时完成（而非收到时）。这是一般通信规则的例外。'},

{ id:'u4q9', unit:4, type:'tf', topic:'Consideration — Adequacy',
  en:'Courts will not enforce a contract if the consideration provided is too low in value (inadequate consideration).',
  zh:'如果提供的对价价值过低（不充分的对价），法院将不会强制执行合同。',
  ans:false,
  okEn:'Correct — FALSE. Courts do not assess the adequacy of consideration — it must be sufficient (have some value) but need not be adequate (fair market value). A peppercorn can be valid consideration.',
  okZh:'正确——假。法院不评估对价的充分性——对价必须充分（有一定价值），但不必adequate（公平市值）。一粒胡椒可以是有效的对价。',
  errEn:'Incorrect — FALSE. Consideration need only be "sufficient" (have some legal value), not adequate (fair value). Courts do not interfere with bargains.',
  errZh:'不正确——假。对价只需"充分"（有一定法律价值），不必adequate（公平价值）。法院不干预交易。'},

{ id:'u4q10', unit:4, type:'mcq', topic:'Intention to Create Legal Relations',
  en:'For contracts between commercial parties, the presumption regarding intention to create legal relations is:',
  zh:'对于商业各方之间的合同，关于创设法律关系意图的推定是：',
  opts:['There is NO presumption — intention must always be proven','There IS a presumption that they intend legal relations','There is a presumption they do NOT intend legal relations','Intention is irrelevant for commercial contracts'],
  optsZh:['没有推定——必须始终证明意图','推定他们有意创设法律关系','推定他们无意创设法律关系','意图对商业合同无关紧要'],
  ans:1,
  okEn:'Correct. For commercial agreements there is a rebuttable presumption of intention to create legal relations. For social/domestic agreements the opposite is presumed.',
  okZh:'正确。对于商业协议，存在创设法律关系意图的可反驳推定。对于社会/家庭协议，则推定相反。',
  errEn:'Incorrect. Commercial parties are presumed to intend legal relations; social/domestic parties are presumed NOT to intend legal relations.',
  errZh:'不正确。商业各方被推定有意创设法律关系；社会/家庭各方被推定无意创设法律关系。'},

{ id:'u4q11', unit:4, type:'match', topic:'Contract Elements',
  en:'Match each element of a valid contract to its description.',
  zh:'将有效合同的每个要素与其描述匹配。',
  pairs:[
    {term:'Offer', termCn:'要约', def:'A definite proposal to contract on specific terms', defCn:'以特定条款缔结合同的明确提议'},
    {term:'Consideration', termCn:'对价', def:'Something of value exchanged by each party', defCn:'各方交换的有价值之物'},
    {term:'Capacity', termCn:'缔约能力', def:'The legal ability to enter into a contract', defCn:'签订合同的法律能力'},
    {term:'Legality', termCn:'合法性', def:'The contract purpose must not be illegal or contrary to public policy', defCn:'合同目的不得违法或违反公共政策'}
  ]},

{ id:'u4q12', unit:4, type:'mcq', topic:'Minors and Contracts',
  en:'A contract made by a minor (person under 18) is generally:',
  zh:'未成年人（18岁以下）订立的合同通常是：',
  opts:['Void — completely invalid','Voidable — the minor can choose to enforce or reject it','Binding — same as adults','Illegal — not permitted at all'],
  optsZh:['无效——完全无效','可撤销——未成年人可选择执行或拒绝','有约束力——与成年人相同','非法——完全不被允许'],
  ans:1,
  okEn:'Correct. Contracts with minors are generally voidable at the minor\'s option. The minor can choose to enforce or avoid the contract, but the adult party is bound.',
  okZh:'正确。与未成年人的合同通常由未成年人选择是��撤销。未成年人可以选择执行或撤销合同，但成年方受约束。',
  errEn:'Incorrect. Minors\' contracts are voidable (not void) at the minor\'s option. Exceptions include contracts for necessaries.',
  errZh:'不正确。未成年人的合同由未成年人选择是否撤销（而非无效）。例外情况包括生活必需品合同。'},

// ===== UNIT 5 EXTENDED =====
{ id:'u5q7', unit:5, type:'mcq', topic:'Express vs Implied Terms',
  en:'An implied term in a contract is one that:',
  zh:'合同中的默示条款是指：',
  opts:['Is written explicitly in the contract','Is implied by statute, custom, or the courts to give the contract business efficacy','Is agreed orally before signing','Is always void and unenforceable'],
  optsZh:['在合同中明确书面约定','由法规、惯例或法院暗示以赋予合同商业效力','在签署前口头约定','始终无效且不可执行'],
  ans:1,
  okEn:'Correct. Implied terms are those not expressly stated but read into the contract by law, custom, or necessity to make it work commercially.',
  okZh:'正确。默示条款是那些未明确说明但由法律、惯例或必要性纳入合同以使其在商业上有效的条款。',
  errEn:'Incorrect. Implied terms are supplied by law/custom/courts — not expressly agreed but necessary for the contract to function.',
  errZh:'不正确。默示条款由法律/惯例/法院提供——未明确约定，但对于合同运作是必要的。'},

{ id:'u5q8', unit:5, type:'mcq', topic:'Exclusion Clauses',
  en:'For an exclusion clause to be effective, it must be:',
  zh:'免责条款要有效，必须满足：',
  opts:['Written in very large text','Incorporated into the contract AND cover the loss that occurred','Agreed to verbally after the contract is signed','Approved by the ACCC'],
  optsZh:['以非常大的字体书写','纳入合同且涵盖所发生的损失','在合同签署后口头同意','经ACCC批准'],
  ans:1,
  okEn:'Correct. For an exclusion clause to work, it must (1) be incorporated into the contract (signed/noticed/course of dealing) and (2) on its true construction, cover the type of loss that occurred.',
  okZh:'正确。要使免责条款有效，必须（1）纳入合同（签署/通知/交易过程），且（2）在其真实解释下，涵盖所发生的损失类型。',
  errEn:'Incorrect. An exclusion clause must be incorporated AND must cover the specific loss — courts construe them strictly against the party relying on them.',
  errZh:'不正确。免责条款必须被纳入合同，且必须涵盖特定损失——法院对依赖该条款的一方严格解释。'},

{ id:'u5q9', unit:5, type:'tf', topic:'Misrepresentation',
  en:'A misrepresentation must be a false statement of fact — a false opinion or prediction is sufficient to constitute misrepresentation.',
  zh:'不实陈述必须是虚假的事实陈述——虚假的意见或预测足以构成不实陈述。',
  ans:false,
  okEn:'Correct — FALSE. Misrepresentation requires a false statement of FACT. Statements of opinion, future intention, or law do not normally constitute actionable misrepresentation (unless the representor knows the opinion to be false).',
  okZh:'正确——假。不实陈述要求虚假的事实陈述。意见、未来意图或法律陈述通常不构成可诉的不实陈述（除非陈述者知道该意见是虚假的）。',
  errEn:'Incorrect — FALSE. Only false statements of FACT can be misrepresentation; opinions and predictions generally cannot.',
  errZh:'不正确——假。只有虚假的事实陈述才能构成不实陈述；意见和预测通常不能。'},

{ id:'u5q10', unit:5, type:'mcq', topic:'Frustration',
  en:'A contract is frustrated when:',
  zh:'合同受挫是指：',
  opts:['One party simply changes their mind','A supervening event makes the contract impossible or radically different from what was agreed','The price becomes too expensive','One party fails to perform on time'],
  optsZh:['一方仅仅改变主意','后来发生的事件使合同变得不可能或与所约定的根本不同','价格变得太贵','一方未按时履行'],
  ans:1,
  okEn:'Correct. Frustration occurs when a supervening (unexpected) event, through no fault of either party, makes performance impossible, illegal, or radically different.',
  okZh:'正确。当后来发生的（意外）事件，由于双方均无过错，使履行变得不可能、非法或根本不同时，合同受挫。',
  errEn:'Incorrect. Frustration requires a supervening event outside both parties\' control that fundamentally changes the nature of the contract.',
  errZh:'不正确。受挫需要双方均无法控制的后来事件，从根本上改变了合同的性质。'},

{ id:'u5q11', unit:5, type:'scenario', topic:'Damages',
  en:'[SCENARIO]\nIn Hadley v Baxendale (1854), a mill owner sent a broken crankshaft to be repaired. The carrier delayed delivery. The mill lost profits during the delay that the carrier didn\'t know about.\n[QUESTION]\nCould the mill owner claim for the lost profits?',
  zh:'[场景]\n在Hadley v Baxendale（1854）案中，一位磨坊主送去了损坏的曲轴进行修理。承运人延迟了交付。磨坊在承运人不知情的情况下在延迟期间损失了利润。\n[问题]\n磨坊主能否索赔失去的利润？',
  opts:['Yes — all losses caused by breach are recoverable','No — losses must have been in the reasonable contemplation of both parties at the time of contracting','Yes — consequential loss is always recoverable','No — loss of profits can never be claimed in contract'],
  optsZh:['是的——违约造成的所有损失都可以追偿','不——损失必须在缔约时双方合理预期之内','是的——后续损失始终可以追偿','不——合同中永远无法索赔利润损失'],
  ans:1,
  okEn:'Correct. Hadley v Baxendale established the remoteness rule: only damages that were reasonably foreseeable/contemplated by BOTH parties at the time of contracting are recoverable.',
  okZh:'正确。Hadley v Baxendale建立了远距离规则：只有在缔约时双方合理预见/预期的损害赔偿才可追偿。',
  errEn:'Incorrect. Hadley v Baxendale: damages limited to what was in the reasonable contemplation of both parties when contracting.',
  errZh:'不正确。Hadley v Baxendale：损害赔偿限于缔约时双方合理预期内的内容。'},

{ id:'u5q12', unit:5, type:'mcq', topic:'Discharge by Breach',
  en:'A contract is discharged by breach when:',
  zh:'合同因违约而解除是指：',
  opts:['Both parties fully perform their obligations','A party fails to perform, repudiates, or makes performance impossible','The court declares the contract void','Both parties agree in writing to end it'],
  optsZh:['双方完全履行其义务','一方未履行、拒绝履行或使履行不可能','法院宣布合同无效','双方书面同意终止合同'],
  ans:1,
  okEn:'Correct. Breach occurs when a party fails to perform, anticipatorily repudiates, or makes performance impossible. The innocent party may sue for damages and/or terminate the contract.',
  okZh:'正确。当一方未能履行、预期拒绝履行或使履行不可能时，发生违约。无过错方可起诉索赔损害赔偿和/或解除合同。',
  errEn:'Incorrect. Breach involves failure to perform, repudiation, or preventing performance — not mutual agreement or court orders.',
  errZh:'不正确。违约涉及未能履行、拒绝履行或阻止履行——而非双方协议或法院命令。'},

// ===== UNIT 6 EXTENDED =====
{ id:'u6q7', unit:6, type:'mcq', topic:'Duty of Care — Neighbour Principle',
  en:'In Donoghue v Stevenson [1932], Lord Atkin\'s "neighbour principle" states that you owe a duty of care to:',
  zh:'在Donoghue v Stevenson [1932]案中，阿特金勋爵的"邻人原则"规定，您对以下人员负有注意义务：',
  opts:['Only your immediate family','Only your business partners','Persons so closely and directly affected by your act that you ought to have them in contemplation','Only persons you have a contract with'],
  optsZh:['只有你的直系亲属','只有你的商业伙伴','与你的行为如此密切相关，以至于你应该考虑到他们的人','只有与你有合同关系的人'],
  ans:2,
  okEn:'Correct. The neighbour principle: you owe a duty to those closely and directly affected by your acts — persons you ought reasonably to have in contemplation.',
  okZh:'正确。邻人原则：您对与您的行为密切相关的人负有义务——您应该合理考虑到的人。',
  errEn:'Incorrect. The neighbour principle extends to anyone "closely and directly affected" — much broader than family or contractual relationships.',
  errZh:'不正确。邻人原则延伸至任何"密切直接���影响"的人——远比家庭或合同关系广泛。'},

{ id:'u6q8', unit:6, type:'mcq', topic:'Breach — Factors',
  en:'Which factor REDUCES the likelihood that a defendant breached their duty of care?',
  zh:'哪个因素会降低被告违反注意义务的可能性？',
  opts:['High probability of harm','Severe potential injury','High cost of taking precautions','Large number of potential victims'],
  optsZh:['高度的伤害可能性','严重的潜在伤害','采取预防措施的高成本','大量潜在受害者'],
  ans:2,
  okEn:'Correct. The higher the cost/burden of taking precautions, the less likely a court will find breach — it\'s unreasonable to require excessively costly precautions. The other factors increase the likelihood of breach.',
  okZh:'正确。采取预防措施的成本/负担越高，法院认定违约的可能性越小——要求过于昂贵的预防措施是不合理的。其他因素会增加违约的可能性。',
  errEn:'Incorrect. High cost of precautions REDUCES the likelihood of breach finding — it would be unreasonable to impose very expensive precautions.',
  errZh:'不正确。高成本的预防措施降低了认定违约的可能性——施加非常昂贵的预防措施是不合理的。'},

{ id:'u6q9', unit:6, type:'fill', topic:'But For Test',
  en:'The "but for" test asks: but for the defendant\'s negligence, would the ___ have occurred?',
  zh:'"但为"测试问道：但为被告的过失，___是否会发生？',
  answers:['harm','damage','injury','plaintiff\'s harm','loss','plaintiff\'s loss'],
  okEn:'Correct. The "but for" test for causation: but for the defendant\'s breach, would the plaintiff\'s harm have occurred? If no, causation is established.',
  okZh:'正确。因果关系的"但为"测试：但为被告的违约，原告的伤害是否会发生？如果不会，则因果关系成立。',
  errEn:'Incorrect. The "but for" test: but for the defendant\'s negligence, would the harm/damage have occurred? This tests the causal link.',
  errZh:'不正确。"但为"测试：但为被告的过失，伤害/损害是否会发生？这测试了因果关系。'},

{ id:'u6q10', unit:6, type:'mcq', topic:'Remoteness — Wagon Mound',
  en:'The Wagon Mound test for remoteness of damage asks whether the damage was:',
  zh:'Wagon Mound远距离损害测试问的是损害是否：',
  opts:['The exact type of damage that occurred previously','Of a type that was reasonably foreseeable','The most severe damage possible','Caused directly without any intervening act'],
  optsZh:['以前发生的确切类型的损害','属于合理可预见的类型','可能发生的最严重损害','直接造成而无任何介入行为'],
  ans:1,
  okEn:'Correct. Wagon Mound (No 1): A defendant is only liable for damage of a type that was reasonably foreseeable — even if the exact manner was not foreseeable.',
  okZh:'正确。Wagon Mound（第1号）：被告只对合理可预见类型的损害承担责任——即使确切的方式不可预见。',
  errEn:'Incorrect. Wagon Mound: liability is limited to damage of a type reasonably foreseeable at the time of the negligent act.',
  errZh:'不正确。Wagon Mound：责任限于过失行为发生时合理可预见类型的损害。'},

{ id:'u6q11', unit:6, type:'tf', topic:'Civil Liability Act',
  en:'The Civil Liability Act (state-based legislation) has partly replaced common law in Australian negligence law.',
  zh:'《民事责任法》（基于州的立法）在澳大利亚过失法中已部分取代了普通法。',
  ans:true,
  okEn:'Correct — TRUE. State Civil Liability Acts (e.g. NSW Civil Liability Act 2002) codify and sometimes modify the common law rules of negligence, particularly in personal injury claims.',
  okZh:'正确——真。州《民事责任法》（如2002年新南威尔士州《民事责任法》）将过失的普通法规则编纂，有时进行修改，特别是在人身伤害索赔中。',
  errEn:'Incorrect — TRUE. Civil Liability Acts codify negligence law in each state, partially displacing common law principles.',
  errZh:'不正确——真。《民事责任法》在每个州对过失法进行编纂，部分取代了普通法原则。'},

{ id:'u6q12', unit:6, type:'scenario', topic:'Negligence — Duty of Care',
  en:'[SCENARIO]\nA supermarket employee mops the floor and places a "Wet Floor" sign. A customer ignores the sign, slips and is injured.\n[QUESTION]\nWhich element of negligence is most affected by the customer ignoring the sign?',
  zh:'[场景]\n一名超市员工拖地并放置了"地板湿滑"警告牌。一名顾客忽视了警告牌，滑倒受伤。\n[问题]\n顾客忽视警告牌最影响过失的哪个要素？',
  opts:['Duty of care — the supermarket had no duty','Breach — the supermarket did not breach its duty','Causation — the breach did not cause the harm','Contributory negligence (volenti/fault of plaintiff)'],
  optsZh:['注意义务——超市没有义务','违约——超市没有违反其义务','因果关系——违约没有造成伤害','促成过失（自愿/原告的过错）'],
  ans:3,
  okEn:'Correct. The customer ignoring the sign is relevant to defences (contributory negligence / voluntary assumption of risk). It may reduce or defeat the claim.',
  okZh:'正确。顾客忽视警告牌与抗辩（促成过失/自愿承担风险）有关。这可能减少或驳回索赔。',
  errEn:'Incorrect. The supermarket still owed a duty and may have breached it. The customer ignoring the sign affects defences — especially contributory negligence.',
  errZh:'不正确。超市仍然负有义务，可能违反了该义务。顾客忽视警告牌影响抗辩——尤其是促成过失。'},

// ===== UNIT 7 EXTENDED =====
{ id:'u7q6', unit:7, type:'mcq', topic:'Hedley Byrne v Heller',
  en:'What important principle did Hedley Byrne & Co v Heller [1964] establish?',
  zh:'Hedley Byrne & Co v Heller [1964]案确立了什么重要原则？',
  opts:['Product liability for physical goods','Liability for negligent misstatement causing pure economic loss','The neighbour principle in negligence','Strict liability for dangerous activities'],
  optsZh:['有形商品的产品责任','因过失虚假陈述造成纯经济损失的责任','过失中的邻人原则','危险活动的严格责任'],
  ans:1,
  okEn:'Correct. Hedley Byrne established that a duty of care can arise for negligent misstatements causing pure economic loss where there is a "special relationship" — one party possessing skill/knowledge and the other reasonably relying on it.',
  okZh:'正确。Hedley Byrne确立了，在存在"特殊关系"的情况下——一方拥有技能/知识，另一方合理依赖——因过失虚假陈述造成纯经济损失可产生注意义务。',
  errEn:'Incorrect. Hedley Byrne deals with negligent misstatement causing economic loss through a special relationship of reliance — not physical goods.',
  errZh:'不正确。Hedley Byrne处理的是通过特殊依赖关系造成经济损失的过失虚假陈述——而非有形商品。'},

{ id:'u7q7', unit:7, type:'mcq', topic:'Voluntary Assumption of Risk',
  en:'The defence of volenti non fit injuria (voluntary assumption of risk) requires that the plaintiff:',
  zh:'自愿承担风险（Volenti non fit injuria）的抗辩要求原告：',
  opts:['Was injured on private property','Voluntarily and knowingly accepted the risk of the specific harm that occurred','Signed a contract with the defendant','Was warned about general risks'],
  optsZh:['在私有财产上受伤','自愿且知情地接受了所发生的特定伤害风险','与被告签订了合同','被警告了一般风险'],
  ans:1,
  okEn:'Correct. Volenti requires full knowledge of the risk AND voluntary acceptance of it. Merely working in a dangerous environment or receiving a general warning is insufficient.',
  okZh:'正确。自愿承担风险需要完全了解风险并自愿接受。仅仅在危险环境中工作或收到一般警告是不够的。',
  errEn:'Incorrect. Volenti requires the plaintiff to have had full knowledge of and voluntarily consented to the specific risk that materialised.',
  errZh:'不正确。自愿承担风险要求原告对已实现的特定风险有充分了解并自愿同意。'},

{ id:'u7q8', unit:7, type:'tf', topic:'Contributory Negligence',
  en:'Under proportionate liability, if a plaintiff is found 30% contributorily negligent, their damages are reduced by 30%.',
  zh:'在按比例分担责任下，如果原告被认定有30%的促成过失，其损害赔偿将减少30%。',
  ans:true,
  okEn:'Correct — TRUE. Under contributory negligence and proportionate liability, damages are apportioned — a 30% finding against the plaintiff reduces their award by 30%.',
  okZh:'正确——真。在促成过失和按比例分担责任下，损害赔偿按比例分配——对原告30%的认定使其赔偿减少30%。',
  errEn:'Incorrect — TRUE. Contributory negligence is assessed proportionately — damages are reduced by the plaintiff\'s share of fault.',
  errZh:'不正确——真。促成过失按比例评估——损害赔偿按原告的过错份额减少。'},

{ id:'u7q9', unit:7, type:'mcq', topic:'Professional Negligence',
  en:'For a professional (e.g. lawyer, doctor, accountant) the standard of care in negligence is:',
  zh:'对于专业人士（如律师、医生、会计师），过失中的注意标准是：',
  opts:['The ordinary reasonable person standard','The standard of a reasonable professional with the same qualifications/experience','The highest possible standard in the profession','No standard — professionals are exempt from negligence claims'],
  optsZh:['普通合理人标准','具有相同资质/经验的合理专业人士的标准','该行业可能的最高标准','没有标准——专业人士免于过失索赔'],
  ans:1,
  okEn:'Correct. Professionals are held to the standard of a reasonable professional in the same field — i.e. a reasonable lawyer, doctor, or accountant with similar qualifications.',
  okZh:'正确。专业人士被要求达到同一领域合理专业人士的标准——即具有类似资质的合理律师、医生或会计师。',
  errEn:'Incorrect. The standard for professionals is that of a reasonable professional with comparable skills and experience in the same field.',
  errZh:'不正确。专业人士的标准是在同一领域具有可比技能和经验的合理专业人士的标准。'},

{ id:'u7q10', unit:7, type:'scenario', topic:'Negligent Misstatement',
  en:'[SCENARIO]\nAlex, a financial advisor at a bank, tells a client that a particular investment is "very low risk." Alex failed to properly assess the product. The client invests $100,000 and loses it all.\n[QUESTION]\nUnder Hedley Byrne, what must the client establish to succeed?',
  zh:'[场景]\n亚历克斯是一家银行的理财顾问，告诉客户某项投资"风险极低"。亚历克斯未能正确评估该产品。客户投资了10万美元，全部亏损。\n[问题]\n根据Hedley Byrne案，客户必须证明什么才能成功索赔？',
  opts:['The investment was illegal','A special relationship existed, the statement was negligent, and the client reasonably relied on it to their detriment','The bank made a profit','Alex intentionally lied'],
  optsZh:['投资是非法的','存在特殊关系、陈述是过失性的，且客户合理依赖该陈述受损','银行获利','亚历克斯故意撒谎'],
  ans:1,
  okEn:'Correct. Hedley Byrne requires: (1) special relationship (adviser with expertise + client relying on advice), (2) negligent misstatement, (3) reasonable reliance, (4) resulting loss.',
  okZh:'正确。Hedley Byrne要求：(1)特殊关系（具有专业知识的顾问+依赖建议的客户），(2)过失虚假陈述，(3)合理依赖，(4)由此产生的损失。',
  errEn:'Incorrect. The elements are: special relationship, negligent statement, reasonable reliance on the statement, and resulting economic loss.',
  errZh:'不正确。要素是：特殊关系、过失陈述、对陈述的合理依赖以及由此产生的经济损失。'},

// ===== UNIT 8 EXTENDED =====
{ id:'u8q7', unit:8, type:'mcq', topic:'ACL — Schedule 2',
  en:'The Australian Consumer Law (ACL) is found in:',
  zh:'澳大利亚消费者法（ACL）见于：',
  opts:['The Trade Practices Act 1974','Schedule 2 of the Competition and Consumer Act 2010','The Fair Trading Act','The Consumer Protection Ordinance'],
  optsZh:['1974年《贸易行为法》','2010年《竞争与消费者法》附表2','《公平交易法》','《消费者保护条例》'],
  ans:1,
  okEn:'Correct. The ACL is contained in Schedule 2 of the Competition and Consumer Act 2010 (Cth). It replaced the Trade Practices Act 1974.',
  okZh:'正确。ACL包含在2010年《竞争与消费者法》（联邦）附表2中。它取代了1974年《贸易行为法》。',
  errEn:'Incorrect. The ACL is Schedule 2 of the Competition and Consumer Act 2010 — not the old Trade Practices Act which was repealed.',
  errZh:'不正确。ACL是2010年《竞争与消费者法》的附表2——而非已废除的旧《贸易行为法》。'},

{ id:'u8q8', unit:8, type:'mcq', topic:'Misleading Conduct — s18',
  en:'Which section of the ACL prohibits misleading or deceptive conduct?',
  zh:'ACL哪一条款禁止误导性或欺骗性行为？',
  opts:['Section 9','Section 18','Section 54','Section 23'],
  optsZh:['第9条','第18条','第54条','第23条'],
  ans:1,
  okEn:'Correct. Section 18 ACL prohibits a person in trade or commerce from engaging in conduct that is misleading or deceptive, or likely to mislead or deceive.',
  okZh:'正确。ACL第18条禁止从事贸易或商业活动的人参与误导性或欺骗性行为，或可能误导或欺骗的行为。',
  errEn:'Incorrect. Section 18 is the key provision for misleading and deceptive conduct. s54 is acceptable quality; s23 is unfair contract terms.',
  errZh:'不正确。第18条是误导性和欺骗性行为的关键条款。第54条是可接受质量；第23条是不公平合同条款。'},

{ id:'u8q9', unit:8, type:'tf', topic:'Consumer Guarantees — Acceptable Quality',
  en:'Consumer guarantees under the ACL apply to all purchases, whether for personal or commercial use.',
  zh:'根据ACL的消费者保证适用于所有购买，无论是个人还是商业用途。',
  ans:false,
  okEn:'Correct — FALSE. Consumer guarantees under the ACL only apply to goods/services acquired by a "consumer" — the monetary threshold was removed in 2021, applying primarily to goods/services for personal, domestic or household use, or goods ordinarily acquired for personal use.',
  okZh:'正确——假。根据ACL的消费者保证只适用于"消费者"购买的商品/服务——通常是主要用于个人、家庭或家用目的的购买，或通常用于个人使用的商品。',
  errEn:'Incorrect — FALSE. Consumer guarantees apply to "consumer" transactions — not all commercial purchases qualify under ACL consumer guarantees.',
  errZh:'不正确——假。消费者保证适用于"消费者"交易——并非所有商业购买都符合ACL消费者保证的资格。'},

{ id:'u8q10', unit:8, type:'scenario', topic:'Consumer Guarantee — Remedy',
  en:'[SCENARIO]\nSam buys a $2,000 laptop. After one week, the screen stops working. The retailer offers to repair it, but Sam wants a refund.\n[QUESTION]\nUnder the ACL, when is Sam entitled to a full refund instead of repair?',
  zh:'[场景]\n萨姆购买了一台价值2000美元的笔记本电脑。一周后，屏幕停止工作。零售商提供修理，但萨姆想要退款。\n[问题]\n根据ACL，萨姆在什么情况下有权获得全额退款而非修理？',
  opts:['Always — the consumer always chooses','Only if the product cost more than $1,000','If the failure is "major" — the product is substantially unfit for purpose or cannot be fixed within a reasonable time','Only if the retailer agrees to refund'],
  optsZh:['始终——消费者总是可以选择','只有当产品成本超过1000美元时','如果故障是"重大的"——产品基本不适合用途或不能在合理时间内修复','只有当零售商同意退款时'],
  ans:2,
  okEn:'Correct. For a MAJOR failure, the consumer can reject the goods and choose a refund or replacement. For a minor failure, the supplier can choose to repair.',
  okZh:'正确。对于重大故障，消费者可以拒绝商品并选择退款或更换。对于轻微故障，供应商可以选择修理。',
  errEn:'Incorrect. A refund is available for MAJOR failures. For minor failures, the supplier can choose to repair rather than replace/refund.',
  errZh:'不正确。退款适用于重大故障。对于轻微故障，供应商可以选择修理而非更换/退款。'},

{ id:'u8q11', unit:8, type:'mcq', topic:'Unfair Contract Terms',
  en:'An unfair contract term under s23 ACL must satisfy which of the following?',
  zh:'根据ACL第23条的不公平合同条款必须满足以下哪项？',
  opts:['The contract must be for more than $10,000','The term creates a significant imbalance, is not reasonably necessary, and would cause detriment if relied upon','The term must be hidden in fine print','The consumer must be elderly or vulnerable'],
  optsZh:['合同必须超过10000美元','该条款造成重大不平衡、非合理必要，且若被依赖会造成损害','该条款必须隐藏在小字体中','消费者必须是老年人或弱势群体'],
  ans:1,
  okEn:'Correct. Under s23 ACL, a term is unfair if it: (1) causes a significant imbalance, (2) is not reasonably necessary to protect a legitimate interest, and (3) would cause detriment if relied upon.',
  okZh:'正确。根据ACL第23条，如果条款：(1)造成重大不平衡，(2)非合理必要以保护合法利益，以及(3)若被依赖会造成损害，则该条款是不公平的。',
  errEn:'Incorrect. The three-limb test for unfair terms: significant imbalance + not reasonably necessary + causes detriment.',
  errZh:'不正确。不公平条款的三部分测试：重大不平衡+非合理必要+造成损害。'},

{ id:'u8q12', unit:8, type:'fill', topic:'ACCC Role',
  en:'The regulator responsible for enforcing the Australian Consumer Law is the ___.',
  zh:'负责执行澳大利亚消费者法的监管机构是___。',
  answers:['ACCC','Australian Competition and Consumer Commission'],
  okEn:'Correct. The ACCC (Australian Competition and Consumer Commission) is the primary national regulator enforcing the ACL.',
  okZh:'正确。ACCC（澳大利亚竞争与消费者委员会）是执行ACL的主要全国监管机构。',
  errEn:'Incorrect. The ACCC (Australian Competition and Consumer Commission) enforces the ACL nationally.',
  errZh:'不正确。ACCC（澳大利亚竞争与消费者委员会）在全国范围内执行ACL。'},

// ===== UNIT 9 EXTENDED =====
{ id:'u9q7', unit:9, type:'mcq', topic:"Carroll's Pyramid — Levels",
  en:'What is the HIGHEST level of Carroll\'s CSR Pyramid, representing a company\'s voluntary contribution to society?',
  zh:'卡罗尔CSR金字塔的最高层次是什么，代表公司对社会的自愿贡献？',
  opts:['Economic responsibility','Legal responsibility','Ethical responsibility','Philanthropic responsibility'],
  optsZh:['经济责任','法律责任','伦理责任','慈善责任'],
  ans:3,
  okEn:'Correct. Carroll\'s Pyramid (bottom to top): Economic → Legal → Ethical → Philanthropic. Philanthropy (giving back) is the highest, most discretionary level.',
  okZh:'正确。卡罗尔金字塔（从底部到顶部）：经济→法律→伦理→慈善。慈善（回馈）是最高的、最具可选择性的层次。',
  errEn:'Incorrect. Carroll\'s Pyramid top level is Philanthropic. Order from base: Economic (required) → Legal → Ethical → Philanthropic (desired).',
  errZh:'不正确。卡罗尔金字塔最高层是慈善。从底部排序：经济（必需）→法律→伦理→慈善（期望）。'},

{ id:'u9q8', unit:9, type:'tf', topic:'Stakeholder Theory',
  en:'According to Freeman\'s Stakeholder Theory, a company should ONLY be accountable to its shareholders.',
  zh:'根据弗里曼的利益相关者理论，公司应该只对其股东负责。',
  ans:false,
  okEn:'Correct — FALSE. Freeman\'s Stakeholder Theory argues that businesses should be accountable to ALL stakeholders — employees, customers, suppliers, communities and shareholders — not just shareholders.',
  okZh:'正确——假。弗里曼的利益相关者理论认为，企业应该对所有利益相关者负责——员工、客户、供应商、社区和股东——而不仅仅是股东。',
  errEn:'Incorrect — FALSE. Stakeholder theory is the OPPOSITE of shareholder primacy — it requires accountability to ALL stakeholders, not just shareholders.',
  errZh:'不正确——假。利益相关者理论与股东至上理论相反——它要求对所有利益相关者负责，而不仅仅是股东。'},

{ id:'u9q9', unit:9, type:'mcq', topic:'ESG — Governance',
  en:'The "G" in ESG refers to:',
  zh:'ESG中的"G"指的是：',
  opts:['Growth','Green initiatives','Governance (board structure, transparency, accountability)','Geographical diversity'],
  optsZh:['增长','绿色倡议','治理（董事会结构、透明度、问责制）','地理多样性'],
  ans:2,
  okEn:'Correct. ESG: Environmental (climate, pollution), Social (human rights, labour), Governance (board composition, audit, transparency, executive pay). Governance is the "G".',
  okZh:'正确。ESG：环境（气候、污染）、社会（人权、劳工）、治理（董事会构成、审计、透明度、高管薪酬）。治理是"G"。',
  errEn:'Incorrect. G = Governance: board structure, transparency, shareholder rights, executive remuneration, and anti-corruption measures.',
  errZh:'不正确。G=治理：董事会结构、透明度、股东权利、高管薪酬和反腐败措施。'},

{ id:'u9q10', unit:9, type:'mcq', topic:'Triple Bottom Line',
  en:'The "Triple Bottom Line" framework, coined by John Elkington in 1994, measures business performance in terms of:',
  zh:'约翰·埃尔金顿1994年创造的"三重底线"框架以什么来衡量商业绩效？',
  opts:['Revenue, costs and profit','People, Planet and Profit','Economic, legal and ethical performance','Short, medium and long-term returns'],
  optsZh:['收入、成本和利润','人、星球和利润','经济、法律和伦理绩效','短期、中期和长期回报'],
  ans:1,
  okEn:'Correct. The Triple Bottom Line = People (social), Planet (environmental), Profit (economic). All three must be managed sustainably.',
  okZh:'正确。三重底线=人（社会）、星球（环境）、利润（经济）。三者都必须可持续管理。',
  errEn:'Incorrect. Triple Bottom Line = People + Planet + Profit — a sustainability framework that goes beyond financial-only measurement.',
  errZh:'不正确。三重底线=人+星球+利润——一个超越纯财务衡量的可持续发展框架。'},

{ id:'u9q11', unit:9, type:'scenario', topic:'Greenwashing',
  en:'[SCENARIO]\nEcoShine advertises its cleaning products as "100% natural and carbon neutral." Investigation reveals the products contain synthetic chemicals and no carbon offset program exists.\n[QUESTION]\nWhich provision of the ACL is most relevant?',
  zh:'[场景]\nEcoShine将其清洁产品宣传为"100%天然且碳中和"。调查显示产品含有合成化学物质，且不存在碳抵消计划。\n[问题]\nACL哪条规定最相关？',
  opts:['Section 54 — acceptable quality','Section 18 — misleading and deceptive conduct','Section 236 — damages only','Section 128 — constitutional referendum'],
  optsZh:['第54条——可接受质量','第18条——误导性和欺骗性行为','第236条——仅损害赔偿','第128条——宪法公投'],
  ans:1,
  okEn:'Correct. False "green" claims constitute misleading and deceptive conduct under s18 ACL — this is greenwashing. The ACCC actively investigates and enforces against greenwashing.',
  okZh:'正确。虚假的"绿色"声明构成ACL第18条下的误导性和欺骗性行为——这是洗绿行为。ACCC积极调查和执法打击洗绿。',
  errEn:'Incorrect. False environmental claims = misleading/deceptive conduct under s18 ACL (greenwashing). The ACCC has enforcement powers for this.',
  errZh:'不正确。虚假环境声明=ACL第18条下的误导性/欺骗性行为（洗绿）。ACCC对此拥有执法权力。'},

{ id:'u9q12', unit:9, type:'fill', topic:'UN SDGs',
  en:'The United Nations Sustainable Development Goals set ___ goals to be achieved by 2030.',
  zh:'联合国可持续发展目标设定了___个到2030年实现的目标。',
  answers:['17','seventeen'],
  okEn:'Correct. There are 17 UN SDGs covering areas including poverty, health, education, clean energy, climate action, and partnerships for sustainable development.',
  okZh:'正确。共有17个联合国可持续发展目标，涵盖贫困、健康、教育、清洁能源、气候行动和可持续发展伙伴关系等领域。',
  errEn:'Incorrect. There are 17 UN Sustainable Development Goals to be achieved by 2030, adopted in 2015.',
  errZh:'不正确。共有17个联合国可持续发展目标，于2015年通过，2030年前实现。'},

// ===== UNIT 10 EXTENDED =====
{ id:'u10q7', unit:10, type:'mcq', topic:'EPBC Act — Key Function',
  en:'The primary purpose of the Environment Protection and Biodiversity Conservation Act 1999 (EPBC Act) is to:',
  zh:'1999年《环境保护和生物多样性保护法》（EPBC法）的主要目的是：',
  opts:['Regulate mining royalties','Protect matters of national environmental significance and biodiversity','Set carbon emission targets','Regulate consumer product labelling'],
  optsZh:['规范采矿特许使用费','保护具有国家环境重要性的事项和生物多样性','设定碳排放目标','规范消费品标签'],
  ans:1,
  okEn:'Correct. The EPBC Act protects matters of national environmental significance (threatened species, Ramsar wetlands, World Heritage areas, etc.) and regulates actions with significant environmental impact.',
  okZh:'正确。EPBC法保护具有国家环境重要性的事项（濒危物种、拉姆萨尔湿地、世界遗产地等）并规范具有重大环境影响的行动。',
  errEn:'Incorrect. The EPBC Act protects national environmental significance — biodiversity, heritage areas, threatened species. Not mining royalties or emissions targets.',
  errZh:'不正确。EPBC法保护国家环境重要性——生物多样性、遗产区、濒危物种。不是采矿特许使用费或排放目标。'},

{ id:'u10q8', unit:10, type:'mcq', topic:'Climate Change Act 2022',
  en:'Australia\'s Climate Change Act 2022 sets a statutory greenhouse gas emissions reduction target for 2030 of:',
  zh:'澳大利亚2022年《气候变化法》设定了2030年法定温室气体减排目标：',
  opts:['26-28% below 2005 levels','43% below 2005 levels','Net zero by 2030','50% below 2010 levels'],
  optsZh:['比2005年水平低26-28%','比2005年水平低43%','到2030年净零排放','比2010年水平低50%'],
  ans:1,
  okEn:'Correct. The Climate Change Act 2022 (Cth) enshrines a 43% reduction by 2030 (on 2005 levels) and net zero by 2050 as statutory targets.',
  okZh:'正确。2022年《气候变化法》（联邦）将到2030年减排43%（相对于2005年水平）和到2050年净零排放作为法定目标。',
  errEn:'Incorrect. The 2022 Act set 43% by 2030 (replacing the previous 26-28% target) and net zero by 2050.',
  errZh:'不正确。2022年法案设定了2030年43%（取代之前的26-28%目标）和2050年净零排放的目标。'},

{ id:'u10q9', unit:10, type:'tf', topic:'Modern Slavery Act',
  en:'The Modern Slavery Act 2018 (Cth) requires companies with annual revenue over $100 million to report on modern slavery risks in their operations and supply chains.',
  zh:'2018年《现代奴役法》（联邦）要求年收入超过1亿美元的公司报告其运营和供应链中的现代奴役风险。',
  ans:true,
  okEn:'Correct — TRUE. The Modern Slavery Act 2018 requires entities with annual consolidated revenue of $100 million or more to submit modern slavery statements annually.',
  okZh:'正确——真。2018年《现代奴役法》要求年合并收入在1亿美元或以上的实体每年提交现代奴役声明。',
  errEn:'Incorrect — TRUE. Entities with $100M+ revenue must report annually on modern slavery risks in their operations and supply chains.',
  errZh:'不正确——真。年收入1亿美元以上的实体必须每年报告其运营和供应链中的现代奴役风险。'},

{ id:'u10q10', unit:10, type:'mcq', topic:'ASX Corporate Governance Principles',
  en:'How many ASX Corporate Governance Principles and Recommendations are there?',
  zh:'ASX企业治理原则和建议共有多少条？',
  opts:['5','6','8','12'],
  optsZh:['5条','6条','8条','12条'],
  ans:2,
  okEn:'Correct. There are 8 ASX Corporate Governance Principles (4th edition, 2019): covering board structures, ethics, risk, audit, remuneration and more.',
  okZh:'正确。共有8条ASX企业治理原则（2019年第4版）：涵盖董事会结构、道德、风险、审计、薪酬等方面。',
  errEn:'Incorrect. There are 8 ASX Corporate Governance Principles and Recommendations (4th edition, 2019).',
  errZh:'不正确。共有8条ASX企业治理原则和建议（2019年第4版）。'},

{ id:'u10q11', unit:10, type:'scenario', topic:'EPBC Act — Approval',
  en:'[SCENARIO]\nA mining company proposes to build a new mine in an area that contains habitat for a critically endangered species listed under the EPBC Act.\n[QUESTION]\nWhat must the company do before proceeding?',
  zh:'[场景]\n一家采矿公司提议在一个含有EPBC法所列濒危物种栖息地的地区建设新矿。\n[问题]\n公司在继续之前必须做什么？',
  opts:['Nothing — state government approval is sufficient','Refer the action to the Commonwealth Environment Minister for assessment and approval','Only consult with local indigenous communities','Complete an internal environmental audit'],
  optsZh:['不需要做任何事——州政府批准就足够了','将行动提交联邦环境部长进行评估和批准','只需咨询当地土著社区','完成内部环境审计'],
  ans:1,
  okEn:'Correct. Actions that are likely to have a significant impact on a matter of national environmental significance (like critically endangered species) must be referred to the Commonwealth Environment Minister under the EPBC Act.',
  okZh:'正确。可能对具有国家环境重要性的事项（如极度濒危物种）产生重大影响的行动，必须根据EPBC法提交联邦环境部长审查。',
  errEn:'Incorrect. The EPBC Act requires referral to the Commonwealth Environment Minister when actions may significantly impact nationally protected matters.',
  errZh:'不正确。EPBC法要求在行动可能对国家保护事项产生重大影响时，提交联邦环境部长审查。'},

{ id:'u10q12', unit:10, type:'fill', topic:'Greenwashing — ACCC',
  en:'Making false environmental claims to appear more sustainable is commonly known as ___.',
  zh:'发表虚假环境声明以显得更具可持续性的行为通常称为___。',
  answers:['greenwashing','green washing','green-washing'],
  okEn:'Correct. Greenwashing involves misleading consumers about the environmental credentials of a product or company. The ACCC has published guidelines and actively enforces against it.',
  okZh:'正确。洗绿涉及误导消费者关于产品或公司的环境资质。ACCC已发布指南并积极执法打击洗绿行为。',
  errEn:'Incorrect. "Greenwashing" is the term for misleading environmental/sustainability claims — a violation of s18 ACL enforced by the ACCC.',
  errZh:'不正确。"洗绿"是误导性环境/可持续性声明的术语——是ACCC执行的ACL第18条的违反。'},

// ===== UNIT 11 EXTENDED =====
{ id:'u11q7', unit:11, type:'mcq', topic:'Director Duty — s180',
  en:'Section 180 of the Corporations Act 2001 imposes on directors a duty to:',
  zh:'2001年《公司法》第180条对董事施加了以下义务：',
  opts:['Maximise shareholder dividends at all times','Exercise their powers and discharge their duties with the care and diligence of a reasonable person','Never take risks with company funds','Report monthly to ASIC'],
  optsZh:['始终最大化股东股息','以合理人的谨慎和勤勉行使权力和履行职责','永不以公司资金承担风险','每月向ASIC报告'],
  ans:1,
  okEn:'Correct. s180 Corporations Act: directors must exercise powers and discharge duties with the degree of care and diligence that a reasonable person would exercise in the same position.',
  okZh:'正确。《公司法》第180条：董事必须以合理人在相同职位上应有的谨慎和勤勉程度行使权力和履行职责。',
  errEn:'Incorrect. s180 is the duty of care and diligence — a reasonable person standard applied to directors in the same position.',
  errZh:'不正确。第180条是谨慎和勤勉义务——应用于相同职位董事的合理人标准。'},

{ id:'u11q8', unit:11, type:'mcq', topic:'Director Duty — s181',
  en:'Section 181 of the Corporations Act requires directors to exercise powers in:',
  zh:'《公司法》第181条要求董事以以下方式行使权力：',
  opts:['Their personal best interests','Good faith in the best interests of the corporation and for a proper purpose','The interests of the majority shareholder','Compliance with the CEO\'s instructions only'],
  optsZh:['其个人最大利益','为公司最大利益真诚行事并出于正当目的','多数股东的利益','仅遵从CEO的指示'],
  ans:1,
  okEn:'Correct. s181: Directors must act in good faith in the best interests of the corporation AND for a proper purpose — dual requirements.',
  okZh:'正确。第181条：董事必须为公司最大利益真诚行事，并出于正当目的——双重要求。',
  errEn:'Incorrect. s181 requires good faith in the best interests of the CORPORATION (not personal interests or majority shareholder) for a proper purpose.',
  errZh:'不正确。第181条要求为公司（而非个人利益或多数股东）的最大利益真诚行事，并出于正当目的。'},

{ id:'u11q9', unit:11, type:'tf', topic:'Director Duty — s182',
  en:'Section 182 Corporations Act prohibits directors from improperly using their position to gain an advantage for themselves or others.',
  zh:'《公司法》第182条禁止董事不正当地利用其职位为自己或他人谋取利益。',
  ans:true,
  okEn:'Correct — TRUE. s182 prohibits improper use of position by officers/employees. s183 prohibits improper use of information. Both carry civil and criminal penalties.',
  okZh:'正确——真。第182条禁止高管/员工不当使用职位。第183条禁止不当使用信息。两者都有民事和刑事处罚。',
  errEn:'Incorrect — TRUE. s182 prohibits improper use of position; s183 prohibits improper use of information. These are key director duties.',
  errZh:'不正确——真。第182条禁止不当使用职位；第183条禁止不当使用信息。这些是关键的董事义务。'},

{ id:'u11q10', unit:11, type:'mcq', topic:'Whistleblower Protections',
  en:'Under the Corporations Act whistleblower regime, a whistleblower who is threatened or harassed after reporting can:',
  zh:'在《公司法》举报人制度下，举报后受到威胁或骚扰的举报人可以：',
  opts:['Only report to police','Seek compensation and protection through courts — retaliation is prohibited','Do nothing — there are no protections','Only seek an apology'],
  optsZh:['只能向警方举报','通过法院寻求赔偿和保护——报复被禁止','什么也不做——没有保护','只能寻求道歉'],
  ans:1,
  okEn:'Correct. The Corporations Act whistleblower protections (Part 9.4AAA) provide immunity from civil/criminal liability, and allow compensation claims for detrimental conduct (retaliation) against the whistleblower.',
  okZh:'正确。《公司法》举报人保护（第9.4AAA部分）提供免于民事/刑事责任的豁免，并允许因对举报人的不利行为（报复）提出赔偿索赔。',
  errEn:'Incorrect. Whistleblowers have legal protections — retaliation is prohibited and they can seek compensation in court for detrimental conduct.',
  errZh:'不正确。举报人有法律保护——报复被禁止，他们可以就不利行为在法院寻求赔偿。'},

{ id:'u11q11', unit:11, type:'scenario', topic:'Director Breach',
  en:'[SCENARIO]\nDirector Maria approves a large loan to a company secretly owned by her brother without disclosing this conflict of interest to the board.\n[QUESTION]\nWhich director duty under the Corporations Act has Maria most likely breached?',
  zh:'[场景]\n董事玛丽亚批准向她哥哥秘密拥有的公司提供大额贷款，未向董事会披露这一利益冲突。\n[问题]\n玛丽亚最可能违反了《公司法》中的哪项董事义务？',
  opts:['s180 — duty of care and diligence only','s181 (good faith/proper purpose) and s182 (improper use of position) and s191 (failure to disclose material personal interest)','No breach — it is her decision as a director','Only s183 — improper use of information'],
  optsZh:['仅第180条——谨慎和勤勉义务','第181条（真诚/正当目的）和第182条（不当使用职位）和第191条（未披露重大个人利益）','无违规——这是她作为董事的决定','仅第183条——不当使用信息'],
  ans:1,
  okEn:'Correct. Maria breached: s181 (not acting in good faith in the company\'s interests), s182 (using position to benefit her brother), and s191 (failing to disclose a material personal interest to the board).',
  okZh:'正确。玛丽亚违反了：第181条（未以真诚为公司利益行事）、第182条（利用职位使其兄弟受益）和第191条（未向董事会披露重大个人利益）。',
  errEn:'Incorrect. Multiple breaches: s181 (good faith), s182 (improper use of position), and s191 (failure to disclose personal interest at board meetings).',
  errZh:'不正确。多项违规：第181条（真诚）、第182条（不当使用职位）和第191条（未在董事会会议上披露个人利益）。'},

{ id:'u11q12', unit:11, type:'match', topic:'Director Duties',
  en:'Match each Corporations Act section to the director duty it imposes.',
  zh:'将每个《公司法》条款与其施加的董事义务匹配。',
  pairs:[
    {term:'s180', termCn:'第180条', def:'Duty of care and diligence', defCn:'谨慎和勤勉义务'},
    {term:'s181', termCn:'第181条', def:'Duty to act in good faith and proper purpose', defCn:'真诚行事和正当目的义务'},
    {term:'s182', termCn:'第182条', def:'Prohibition on improper use of position', defCn:'禁止不当使用职位'},
    {term:'s183', termCn:'第183条', def:'Prohibition on improper use of information', defCn:'禁止不当使用信息'}
  ]},


];

// ============================================================
//  DND QUESTION — Always last (Court Hierarchy)
// ============================================================
const DND_DRIVES = [
  { id:'hc',  label:'High Court of Australia',           labelCN:'澳大利亚高等法院',     icon:'⚖️' },
  { id:'fed', label:'Federal Court / Court of Appeal',   labelCN:'联邦法院/上诉法院',     icon:'🏛️' },
  { id:'sup', label:'Supreme Court (State/Territory)',   labelCN:'（州/领地）最高法院',   icon:'🔷' },
  { id:'dis', label:'District / County Court',           labelCN:'地区/县级法院',          icon:'📋' },
  { id:'mag', label:'Magistrates Court',                 labelCN:'治安法院',               icon:'📂' },
];
const DND_CORRECT_ORDER = ['hc','fed','sup','dis','mag'];

// ============================================================
//  GAME STATE
// ============================================================
const STATE = {
  score: 0,
  floor: 0,
  totalFloors: 0,
  queue: [],
  answered: false,
  topicsCovered: [],
  startTime: 0,
  dndSlots: {},
  dndDragId: null,
  matchSelectedTerm: null,
  matchPairs: [],
  matchMatched: 0,
};

const AEGIS_LINES = {
  boot: [
    {en:'AEGIS ONLINE. INITIALISING KNOWLEDGE VERIFICATION PROTOCOL...', zh:'AEGIS已上线。正在初始化知识验证协议...'},
    {en:'CORPORATE ESCAPE PROTOCOL v3.0 INITIATED. DEMONSTRATE YOUR KNOWLEDGE.', zh:'企业逃脱协议v3.0已启动。展示你的知识，特工。'},
    {en:'NEXCORP TOWER SECURITY ACTIVE. ANSWER CORRECTLY TO ADVANCE.', zh:'奈克斯科普大厦安全系统激活。正确回答方可晋级。'},
    {en:'IDENTIFYING AGENT... NEURAL SIGNATURE SCANNED. READY.', zh:'正在识别特工...神经特征已扫描。准备就绪。'},
  ],
  correct: [
    {en:'ACCESS GRANTED. NEURAL PATTERN VERIFIED.', zh:'访问授权。神经模式已验证。'},
    {en:'CORRECT DATA TRANSMISSION. PROCEEDING TO NEXT SECTOR.', zh:'数据传输正确。继续前进至下一区域。'},
    {en:'KNOWLEDGE CONFIRMED. SECURITY BYPASS SUCCESSFUL.', zh:'知识已确认。安全绕过成功。'},
    {en:'IMPRESSIVE. YOUR LEGAL EXPERTISE IS BEYOND EXPECTATIONS.', zh:'令人印象深刻。你的法律专业知识超出预期。'},
    {en:'SECURITY CLEARANCE UPGRADED. EXCELLENT RESPONSE.', zh:'安全许可已升级。回答出色。'},
  ],
  wrong: [
    {en:'ACCESS DENIED. INCORRECT DATA DETECTED. RECALIBRATING...', zh:'访问被拒。检测到数据错误。重新校准中...'},
    {en:'SECURITY BREACH ATTEMPT FAILED. REVIEW YOUR PROTOCOLS, AGENT.', zh:'安全突破尝试失败。请复习你的协议，特工。'},
    {en:'SYSTEM ERROR. KNOWLEDGE GAP DETECTED. REPROCESSING...', zh:'系统错误。检测到知识空白。重新处理中...'},
    {en:'NEURAL MISMATCH. CONSULT THE DATABASE AND TRY AGAIN.', zh:'神经不匹配。请查阅数据库后重试。'},
  ],
  trans: [
    {en:'ASCENDING TO NEXT SECURITY LEVEL...', zh:'上升至下一安全级别...'},
    {en:'ACCESSING NEXT DATA VAULT...', zh:'正在访问下一数据库...'},
    {en:'SECURITY DOOR UNLOCKED. PROCEEDING FORWARD.', zh:'安全门已解锁。继续前进。'},
    {en:'SECTOR CLEARED. ADVANCING TO NEW ZONE.', zh:'区域已清除。前往新区域。'},
  ],
  win: [
    {en:'ESCAPE SEQUENCE COMPLETE. ALL SECURITY LEVELS CLEARED. OUTSTANDING PERFORMANCE, AGENT!', zh:'逃脱序列完成。所有安全级别已清除。表现出色，特工！'},
  ],
  intro: [
    {en:'AGENT IDENTIFIED. I AM AEGIS — ADAPTIVE ELECTRONIC GUIDANCE AND INTELLIGENCE SYSTEM.', zh:'特工已识别。我是AEGIS——自适应电子引导与智能系统。'},
    {en:'I WILL GUIDE YOU THROUGH NEXCORP TOWER. ANSWER EACH QUESTION TO UNLOCK THE NEXT FLOOR.', zh:'我将引导你通过奈克斯科普大厦。回答每道问题以解锁下一层。'},
    {en:'USE YOUR KNOWLEDGE OF BUSINESS LAW TO BYPASS ALL SECURITY LOCKS. GOOD LUCK.', zh:'运用你的商法知识绕过所有安全锁。祝你好运。'},
  ],
};

function randItem(arr) { return arr[Math.floor(Math.random() * arr.length)]; }

// ============================================================
//  DOM REFERENCES
// ============================================================
const GW       = document.getElementById('game-wrapper');
const hudFloor = document.getElementById('hud-floor');
const hudScore = document.getElementById('hud-score');
const hudClock = document.getElementById('hud-clock');
const hudProgress = document.getElementById('hud-progress');
const batteryBar  = document.getElementById('battery-bar');
const dialogueBox = document.getElementById('dialogue-box');
const dialogueTxtEn = document.getElementById('dialogue-text-en');
const dialogueTxtZh = document.getElementById('dialogue-text-zh');
const dialogueCnt = document.getElementById('dialogue-continue');
const aegisSvg    = document.getElementById('aegis-svg');
const ftOverlay   = document.getElementById('floor-transition');
const ftText      = document.getElementById('ft-text');
const ftCn        = document.getElementById('ft-cn');
const ftBar       = document.getElementById('ft-bar');
const exitModal   = document.getElementById('exit-modal');

// ============================================================
//  SCREEN MANAGEMENT
// ============================================================
function showScreen(id, animClass) {
  document.querySelectorAll('.screen.active').forEach(s => {
    s.classList.remove('active');
    s.classList.remove('anim-boot','anim-wipe','anim-blinds','anim-zoom','anim-match','anim-win');
  });
  const s = document.getElementById(id);
  if (!s) return;
  s.classList.add('active');
  if (animClass) {
    s.classList.remove(animClass);
    void s.offsetWidth; // reflow
    s.classList.add(animClass);
  }
}

// ============================================================
//  TYPEWRITER EFFECT
// ============================================================
let typeTimer = null;
function typewrite(el, text, speed, cb) {
  if (typeTimer) clearInterval(typeTimer);
  el.innerHTML = '';
  let i = 0;
  typeTimer = setInterval(() => {
    if (i < text.length) {
      el.innerHTML = text.slice(0, i + 1) + '<span class="type-cursor">▋</span>';
      SoundFX.playType();
      i++;
    } else {
      clearInterval(typeTimer);
      el.innerHTML = text;
      if (cb) cb();
    }
  }, speed || 25);
}

// ============================================================
//  DIALOGUE BOX  (bilingual: accepts {en, zh} object or string)
// ============================================================
let dialogueTypeTimerZh = null;
function showDialogue(line, showContinue) {
  const en = typeof line === 'object' ? line.en : line;
  const zh = typeof line === 'object' ? (line.zh || '') : '';
  dialogueBox.classList.remove('hidden');
  aegisSvg.classList.add('talking');
  aegisSvg.classList.remove('alarmed');
  if (dialogueTypeTimerZh) { clearInterval(dialogueTypeTimerZh); dialogueTypeTimerZh = null; }
  // Typewrite English
  typewrite(dialogueTxtEn, en, 20, () => {
    aegisSvg.classList.remove('talking');
    if (showContinue) dialogueCnt.style.display = 'block';
    // Typewrite Chinese after English finishes
    if (zh) {
      dialogueTxtZh.innerHTML = '';
      let i = 0;
      dialogueTypeTimerZh = setInterval(() => {
        if (i < zh.length) {
          dialogueTxtZh.innerHTML = zh.slice(0, i + 1) + '<span class="type-cursor">▋</span>';
          i++;
        } else {
          clearInterval(dialogueTypeTimerZh);
          dialogueTxtZh.innerHTML = zh;
        }
      }, 18);
    }
  });
  dialogueCnt.style.display = 'none';
  dialogueTxtZh.innerHTML = '';
}

function hideDialogue() {
  dialogueBox.classList.add('hidden');
  dialogueCnt.style.display = 'none';
  dialogueTxtZh.innerHTML = '';
}

// ============================================================
//  HUD UPDATE
// ============================================================
function updateHUD() {
  hudFloor.textContent = `FLOOR ${STATE.floor}/${STATE.totalFloors}`;
  hudScore.textContent = `SCR ${STATE.score}`;
  // Progress dots
  hudProgress.innerHTML = '';
  for (let i = 0; i < STATE.totalFloors; i++) {
    const dot = document.createElement('div');
    dot.className = 'prog-dot';
    if (i < STATE.floor) dot.classList.add('done');
    else if (i === STATE.floor) dot.classList.add('current');
    hudProgress.appendChild(dot);
  }
  // Battery (score-based)
  const segs = batteryBar.querySelectorAll('.battery-seg');
  const filled = Math.min(5, Math.round((STATE.score / (STATE.totalFloors * 10)) * 5));
  segs.forEach((s, idx) => {
    s.classList.toggle('empty', idx >= filled);
  });
}

function animateScore() {
  hudScore.classList.remove('bounce');
  void hudScore.offsetWidth;
  hudScore.classList.add('bounce');
  setTimeout(() => hudScore.classList.remove('bounce'), 400);
}

// ============================================================
//  CLOCK
// ============================================================
function startClock() {
  STATE.startTime = Date.now();
  setInterval(() => {
    const elapsed = Math.floor((Date.now() - STATE.startTime) / 1000);
    const h = String(Math.floor(elapsed / 3600)).padStart(2,'0');
    const m = String(Math.floor((elapsed % 3600) / 60)).padStart(2,'0');
    const s = String(elapsed % 60).padStart(2,'0');
    hudClock.textContent = `${h}:${m}:${s}`;
  }, 1000);
}

// ============================================================
//  MATRIX RAIN CANVAS (boot screen)
// ============================================================
function initMatrixRain() {
  const canvas = document.getElementById('matrix-canvas');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  const chars = 'アイウエオカキクケコサシスセソタチツテトナニヌネノABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789法律合同公司责任法院';
  let W, H, cols, drops;
  function resize() {
    W = canvas.width  = canvas.offsetWidth  || GW.offsetWidth;
    H = canvas.height = canvas.offsetHeight || GW.offsetHeight;
    cols = Math.floor(W / 16);
    drops = Array.from({length: cols}, () => Math.random() * -50);
  }
  resize();
  new ResizeObserver(resize).observe(canvas.parentElement || GW);
  let matrixRaf = null;
  function drawMatrix() {
    ctx.fillStyle = 'rgba(0,0,0,0.04)';
    ctx.fillRect(0, 0, W, H);
    ctx.font = '13px monospace';
    for (let i = 0; i < cols; i++) {
      const c = chars[Math.floor(Math.random() * chars.length)];
      const x = i * 16;
      const y = drops[i] * 16;
      ctx.fillStyle = drops[i] * 16 > H * 0.85 ? 'rgba(0,255,255,0.9)' : 'rgba(0,180,80,0.75)';
      ctx.fillText(c, x, y);
      if (y > H && Math.random() > 0.975) drops[i] = 0;
      drops[i]++;
    }
    matrixRaf = requestAnimationFrame(drawMatrix);
  }
  drawMatrix();
  // Stop matrix after game starts
  window._stopMatrix = () => {
    if (matrixRaf) { cancelAnimationFrame(matrixRaf); matrixRaf = null; }
    ctx.clearRect(0, 0, W, H);
  };
}

// ============================================================
//  PARTICLES
// ============================================================
function initParticles() {
  const canvas = document.getElementById('particles-canvas');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  let W, H, particles = [];
  function resize() {
    W = canvas.width  = GW.offsetWidth;
    H = canvas.height = GW.offsetHeight;
  }
  resize();
  new ResizeObserver(resize).observe(GW);
  for (let i = 0; i < 60; i++) {
    particles.push({ x: Math.random()*W, y: Math.random()*H, r: Math.random()*1.5+0.3, vx: (Math.random()-0.5)*0.3, vy: -Math.random()*0.4-0.1, a: Math.random() });
  }
  function draw() {
    ctx.clearRect(0,0,W,H);
    particles.forEach(p => {
      ctx.beginPath();
      ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
      ctx.fillStyle = `rgba(0,255,255,${0.15 + Math.sin(p.a)*0.1})`;
      ctx.fill();
      p.x += p.vx; p.y += p.vy; p.a += 0.02;
      if (p.y < 0) { p.y = H; p.x = Math.random()*W; }
    });
    requestAnimationFrame(draw);
  }
  draw();
}

// ============================================================
//  OVERLAYS
// ============================================================
function showCorrectOverlay() {
  const o = document.getElementById('correct-overlay');
  o.classList.remove('hidden');
  GW.style.boxShadow = '0 0 80px rgba(0,255,128,0.4), 0 0 200px rgba(0,200,80,0.2)';
  setTimeout(() => {
    o.classList.add('hidden');
    GW.style.boxShadow = '';
  }, 800);
}
function showWrongOverlay() {
  const o = document.getElementById('wrong-overlay');
  o.classList.remove('hidden');
  GW.classList.remove('shake');
  void GW.offsetWidth;
  GW.classList.add('shake');
  GW.style.boxShadow = '0 0 80px rgba(255,0,0,0.35), inset 0 0 80px rgba(255,0,0,0.15)';
  aegisSvg.classList.add('alarmed');
  setTimeout(() => {
    o.classList.add('hidden');
    GW.classList.remove('shake');
    GW.style.boxShadow = '';
    aegisSvg.classList.remove('alarmed');
  }, 600);
}

// ============================================================
//  FLOOR TRANSITION
// ============================================================
function floorTransition(text, textCn, cb) {
  ftOverlay.classList.remove('hidden');
  ftText.textContent = text;
  ftCn.textContent = textCn;
  ftBar.style.width = '0%';
  SoundFX.playTransition();
  setTimeout(() => { ftBar.style.width = '100%'; }, 50);
  setTimeout(() => {
    ftOverlay.classList.add('hidden');
    ftBar.style.width = '0%';
    if (cb) cb();
  }, 900);
}

// ============================================================
//  QUEUE BUILDING
// ============================================================
function buildQueue() {
  // Shuffle QUESTION_BANK, pick 9 with unit interleaving
  const shuffled = [...QUESTION_BANK].sort(() => Math.random() - 0.5);
  const selected = [];
  let lastUnit = -1;
  // Try to interleave — first pass preferring different units
  for (const q of shuffled) {
    if (selected.length >= 15) break;
    if (q.unit !== lastUnit) {
      selected.push(q);
      lastUnit = q.unit;
    }
  }
  // Fill remaining if needed
  for (const q of shuffled) {
    if (selected.length >= 15) break;
    if (!selected.includes(q)) selected.push(q);
  }
  // DnD is always last
  selected.push({ id:'dnd', unit:2, type:'dnd', topic:'Court Hierarchy', en:'Court Hierarchy Drag and Drop' });
  return selected;
}

// ============================================================
//  INIT GAME
// ============================================================
function initGame() {
  STATE.score = 0;
  STATE.floor = 0;
  STATE.topicsCovered = [];
  STATE.answered = false;
  STATE.queue = buildQueue();
  STATE.totalFloors = STATE.queue.length;
  updateHUD();
  startClock();
  SoundFX.stopAmbient(); // stop any old ambient
  runBoot();
}

// ============================================================
//  BOOT SEQUENCE
// ============================================================
const BOOT_LINES = [
  {en:'NEXCORP SECURITY SYSTEM v3.0 — POWER ON...', delay:0},
  {en:'CPU CORES: 2048 ACTIVE | RAM: 512TB ALLOCATED', delay:260},
  {en:'AEGIS AI CORE: ONLINE ✓', delay:260},
  {en:'BIOMETRIC AUTHENTICATION: BYPASSED ✓', delay:280},
  {en:'NEURAL INTERFACE: CONNECTED ✓', delay:260},
  {en:'LOADING LEGAL DATABASE... 69 MODULES DETECTED ✓', delay:300},
  {en:'ESCAPE ROUTE: LOCKED — KNOWLEDGE KEY REQUIRED', delay:260},
  {en:'ALL SYSTEMS NOMINAL. INITIALISING AGENT INTERFACE...', delay:300},
];

function runBoot() {
  window.isGameStarting = false;
  showScreen('screen-boot', 'anim-boot');
  hideDialogue();
  initMatrixRain();
  const terminal  = document.getElementById('boot-terminal');
  const prompt    = document.getElementById('boot-prompt');
  const progWrap  = document.getElementById('boot-progress-wrap');
  const progBar   = document.getElementById('boot-progress-bar');
  terminal.innerHTML = '';
  prompt.style.display = 'none';
  progWrap.style.display = 'none';
  SoundFX.playBoot();

  let cumDelay = 320;
  BOOT_LINES.forEach((line, i) => {
    cumDelay += line.delay;
    const d = cumDelay;
    setTimeout(() => {
      const span = document.createElement('div');
      span.className = 'bt-line';
      span.textContent = '> ' + line.en;
      terminal.appendChild(span);
      // progress bar
      progWrap.style.display = 'block';
      progBar.style.width = (((i + 1) / BOOT_LINES.length) * 100) + '%';
    }, d);
  });

  const totalDelay = cumDelay + 400;
  setTimeout(() => { prompt.style.display = ''; }, totalDelay);
}

function startGame() {
  if (window._stopMatrix) window._stopMatrix();
  SoundFX.playTransition();
  SoundFX.startAmbient();
  // Show AEGIS intro dialogue first, then begin questions after short delay
  const introLine = randItem(AEGIS_LINES.intro);
  floorTransition('INITIATING ESCAPE PROTOCOL...', '启动逃脱协议...', () => {
    window.isGameStarting = false; // Safe to clear — boot screen no longer active
    showDialogue(introLine, false);
    setTimeout(() => {
      showDialogue(randItem(AEGIS_LINES.boot), false);
      showNextQuestion();
    }, 3200);
  });
}

// ============================================================
//  SHOW NEXT QUESTION
// ============================================================
function showNextQuestion() {
  if (STATE.floor >= STATE.queue.length) {
    showWinScreen();
    return;
  }
  const q = STATE.queue[STATE.floor];
  STATE.answered = false;
  if (!STATE.topicsCovered.includes(`${UNIT_NAMES[q.unit]}: ${q.topic}`)) {
    STATE.topicsCovered.push(`${UNIT_NAMES[q.unit]}: ${q.topic}`);
  }
  updateHUD();

  const floorLabel = STATE.floor < STATE.queue.length - 1 
    ? `FLOOR ${String(STATE.floor + 1).padStart(2,'0')} // SECURITY LEVEL ${STATE.floor + 1}`
    : `FINAL FLOOR // MAINFRAME CORE`;

  switch (q.type) {
    case 'mcq':
    case 'scenario': showMCQScreen(q, floorLabel); break;
    case 'tf':       showTFScreen(q, floorLabel);  break;
    case 'fill':     showFillScreen(q, floorLabel); break;
    case 'match':    showMatchScreen(q, floorLabel); break;
    case 'dnd':      showDNDScreen(); break;
  }
}

// ============================================================
//  MCQ / SCENARIO SCREEN
// ============================================================
function showMCQScreen(q, floorLabel) {
  const panel   = document.getElementById('question-panel');
  const unitTag = document.getElementById('q-unit-tag');
  const header  = document.getElementById('q-floor-header');
  const qText   = document.getElementById('q-text');
  const mcqGrid = document.getElementById('q-mcq-answers');
  const tfBtns  = document.getElementById('q-tf-buttons');
  const fillArea = document.getElementById('q-fill-area');
  const feedback = document.getElementById('q-feedback');
  const cont     = document.getElementById('q-continue');

  // Set unit color
  const color = UNIT_COLORS[q.unit] || '#0ff';
  panel.style.setProperty('--unit-color', `linear-gradient(90deg, transparent, ${color}, transparent)`);
  unitTag.textContent  = UNIT_NAMES[q.unit];
  unitTag.style.color  = color;
  unitTag.style.borderColor = color;
  header.innerHTML = `&#9672;&nbsp; ${floorLabel} &nbsp;&#9672;<span class="q-type-badge">${q.type.toUpperCase()}</span>`;
  
  // Build question text — handle both inline [SCENARIO]...[QUESTION] and separate scenario/en fields
  let questionHTML = '';
  if (q.type === 'scenario') {
    let scenarioText = q.scenario, scenarioZhText = q.scenarioZh;
    let questionText = q.en, questionZhText = q.zh;
    if (!scenarioText && q.en && q.en.includes('[SCENARIO]')) {
      const enParts  = q.en.split(/\[QUESTION\]/i);
      const zhParts  = (q.zh || '').split(/\[问题\]|\[QUESTION\]/i);
      const enScen   = enParts[0].replace(/\[SCENARIO\]/gi, '').trim();
      const zhScen   = zhParts[0].replace(/\[场景\]|\[SCENARIO\]/gi, '').trim();
      scenarioText   = enScen;
      scenarioZhText = zhScen;
      questionText   = (enParts[1] || '').trim();
      questionZhText = (zhParts[1] || '').trim();
    }
    questionHTML += `<div class="scenario-box">${scenarioText}<span class="cn-text">${scenarioZhText || ''}</span></div>`;
    questionHTML += questionText + `<span class="cn-text">${questionZhText || ''}</span>`;
  } else {
    questionHTML += q.en + `<span class="cn-text">${q.zh}</span>`;
  }
  qText.innerHTML = questionHTML;

  // Show MCQ, hide others
  mcqGrid.classList.remove('hidden');
  tfBtns.classList.add('hidden');
  fillArea.classList.add('hidden');
  feedback.classList.add('hidden');
  cont.classList.add('hidden');
  mcqGrid.innerHTML = '';

  q.opts.forEach((opt, idx) => {
    const btn = document.createElement('button');
    btn.className = 'answer-btn';
    const letter = String.fromCharCode(65+idx);
    btn.innerHTML = `<span style="font-family:'Orbitron',monospace;font-size:0.75em;letter-spacing:2px;color:#0ff;margin-right:8px;opacity:0.9;">${letter}.</span>${opt}<span class="cn-text">${q.optsZh[idx]}</span>`;
    btn.addEventListener('mouseenter', () => SoundFX.playClick());
    btn.addEventListener('click', () => {
      if (STATE.answered) return;
      STATE.answered = true;
      handleMCQAnswer(q, idx);
    });
    mcqGrid.appendChild(btn);
  });

  const animClass = q.type === 'scenario' ? 'anim-blinds' : 'anim-wipe';
  showScreen('screen-question', animClass);
}

function handleMCQAnswer(q, selectedIdx) {
  const btns = document.querySelectorAll('#q-mcq-answers .answer-btn');
  btns.forEach(b => b.disabled = true);
  const correct = (selectedIdx === q.ans);
  btns[q.ans].classList.add('correct');
  if (!correct) btns[selectedIdx].classList.add('wrong');

  const fb = document.getElementById('q-feedback');
  fb.classList.remove('hidden', 'ok', 'err');
  if (correct) {
    fb.className = 'feedback-msg ok';
    fb.innerHTML = `&#10003; ${q.okEn}<span class="cn-text">${q.okZh}</span>`;
    STATE.score += 10;
    animateScore();
    showCorrectOverlay();
    SoundFX.playCorrect();
    showDialogue(randItem(AEGIS_LINES.correct), false);
  } else {
    fb.className = 'feedback-msg err';
    fb.innerHTML = `&#10007; ${q.errEn}<span class="cn-text">${q.errZh}</span>`;
    showWrongOverlay();
    SoundFX.playWrong();
    showDialogue(randItem(AEGIS_LINES.wrong), false);
    // Spaced repetition: requeue 3 positions later
    requeueWrong(q);
  }
  document.getElementById('q-continue').classList.remove('hidden');
}

// ============================================================
//  TRUE/FALSE SCREEN
// ============================================================
function showTFScreen(q, floorLabel) {
  const panel   = document.getElementById('question-panel');
  const unitTag = document.getElementById('q-unit-tag');
  const header  = document.getElementById('q-floor-header');
  const qText   = document.getElementById('q-text');
  const mcqGrid = document.getElementById('q-mcq-answers');
  const tfBtns  = document.getElementById('q-tf-buttons');
  const fillArea = document.getElementById('q-fill-area');
  const feedback = document.getElementById('q-feedback');
  const cont     = document.getElementById('q-continue');

  const color = UNIT_COLORS[q.unit] || '#0ff';
  panel.style.setProperty('--unit-color', `linear-gradient(90deg, transparent, ${color}, transparent)`);
  unitTag.textContent = UNIT_NAMES[q.unit];
  unitTag.style.color = color;
  unitTag.style.borderColor = color;
  header.innerHTML = `&#9672;&nbsp; ${floorLabel} — TRUE OR FALSE &nbsp;&#9672;`;

  const tfStmt   = q.stmt   || q.en  || '';
  const tfStmtZh = q.stmtZh || q.zh  || '';
  qText.innerHTML = `<em style="color:#ff0;font-size:0.8em;letter-spacing:2px;">TRUE OR FALSE? // 真或假？</em><br><br>${tfStmt}<span class="cn-text">${tfStmtZh}</span>`;

  mcqGrid.classList.add('hidden');
  tfBtns.classList.remove('hidden');
  fillArea.classList.add('hidden');
  feedback.classList.add('hidden');
  cont.classList.add('hidden');

  const trueBtn  = document.getElementById('tf-true');
  const falseBtn = document.getElementById('tf-false');
  trueBtn.disabled = false;
  falseBtn.disabled = false;
  trueBtn.className  = 'tf-btn true-btn';
  falseBtn.className = 'tf-btn false-btn';

  function handleTF(chosen) {
    if (STATE.answered) return;
    STATE.answered = true;
    trueBtn.disabled = true;
    falseBtn.disabled = true;
    const correct = (chosen === q.ans);
    if (correct) {
      (chosen ? trueBtn : falseBtn).classList.add('correct');
      feedback.className = 'feedback-msg ok';
      feedback.innerHTML = `&#10003; ${q.okEn}<span class="cn-text">${q.okZh}</span>`;
      STATE.score += 10;
      animateScore();
      showCorrectOverlay();
      SoundFX.playCorrect();
      showDialogue(randItem(AEGIS_LINES.correct), false);
    } else {
      (chosen ? trueBtn : falseBtn).classList.add('wrong');
      (q.ans ? trueBtn : falseBtn).classList.add('correct');
      feedback.className = 'feedback-msg err';
      feedback.innerHTML = `&#10007; ${q.errEn}<span class="cn-text">${q.errZh}</span>`;
      showWrongOverlay();
      SoundFX.playWrong();
      showDialogue(randItem(AEGIS_LINES.wrong), false);
      requeueWrong(q);
    }
    feedback.classList.remove('hidden');
    cont.classList.remove('hidden');
  }

  trueBtn.onclick  = () => handleTF(true);
  falseBtn.onclick = () => handleTF(false);

  showScreen('screen-question', 'anim-blinds');
}

// ============================================================
//  FILL IN BLANK SCREEN
// ============================================================
function showFillScreen(q, floorLabel) {
  const panel   = document.getElementById('question-panel');
  const unitTag = document.getElementById('q-unit-tag');
  const header  = document.getElementById('q-floor-header');
  const qText   = document.getElementById('q-text');
  const mcqGrid = document.getElementById('q-mcq-answers');
  const tfBtns  = document.getElementById('q-tf-buttons');
  const fillArea = document.getElementById('q-fill-area');
  const feedback = document.getElementById('q-feedback');
  const cont     = document.getElementById('q-continue');
  const fillInput  = document.getElementById('fill-input');
  const fillSubmit = document.getElementById('fill-submit');
  const fillHint   = document.getElementById('fill-hint');

  const color = UNIT_COLORS[q.unit] || '#0ff';
  panel.style.setProperty('--unit-color', `linear-gradient(90deg, transparent, ${color}, transparent)`);
  unitTag.textContent = UNIT_NAMES[q.unit];
  unitTag.style.color = color;
  unitTag.style.borderColor = color;
  header.innerHTML = `&#9672;&nbsp; ${floorLabel} — FILL IN THE BLANK &nbsp;&#9672;`;

  // Support both naming conventions: blank/blankZh/accepts (original) or en/zh/answers (newer)
  const fillText   = q.blank   || q.en  || '';
  const fillTextZh = q.blankZh || q.zh  || '';
  const accepts    = q.accepts || q.answers || [];

  // Format blank with highlighted underline
  const formatted = fillText.replace('___', '<span class="fill-blank-highlight">___</span>');
  qText.innerHTML = formatted + `<span class="cn-text">${fillTextZh}</span>`;
  fillHint.textContent = 'Type your answer and press SUBMIT or ENTER // 输入答案并按提交或回车';

  mcqGrid.classList.add('hidden');
  tfBtns.classList.add('hidden');
  fillArea.classList.remove('hidden');
  feedback.classList.add('hidden');
  cont.classList.add('hidden');

  fillInput.value = '';
  fillInput.disabled = false;
  fillInput.style.borderColor = '';
  fillSubmit.disabled = false;

  function handleFill() {
    if (STATE.answered) return;
    const val = fillInput.value.trim().toLowerCase();
    if (!val) return;
    STATE.answered = true;
    fillInput.disabled = true;
    fillSubmit.disabled = true;
    const correct = accepts.some(a => a.toLowerCase() === val);
    if (correct) {
      fillInput.style.borderColor = '#0f8';
      feedback.className = 'feedback-msg ok';
      feedback.innerHTML = `&#10003; ${q.okEn}<span class="cn-text">${q.okZh}</span>`;
      STATE.score += 10;
      animateScore();
      showCorrectOverlay();
      SoundFX.playCorrect();
      showDialogue(randItem(AEGIS_LINES.correct), false);
    } else {
      fillInput.style.borderColor = '#f44';
      feedback.className = 'feedback-msg err';
      feedback.innerHTML = `&#10007; ${q.errEn}<span class="cn-text">${q.errZh}</span>`;
      showWrongOverlay();
      SoundFX.playWrong();
      showDialogue(randItem(AEGIS_LINES.wrong), false);
      requeueWrong(q);
    }
    feedback.classList.remove('hidden');
    cont.classList.remove('hidden');
  }

  fillSubmit.onclick = handleFill;
  fillInput.onkeydown = e => { if (e.key === 'Enter') handleFill(); };

  showScreen('screen-question', 'anim-zoom');
  setTimeout(() => fillInput.focus(), 500);
}

// ============================================================
//  MATCHING SCREEN
// ============================================================
function showMatchScreen(q, floorLabel) {
  const panel   = document.getElementById('match-panel');
  const unitTag = document.getElementById('match-unit-tag');
  const header  = document.getElementById('match-floor-header');
  const termsEl = document.getElementById('match-terms');
  const defsEl  = document.getElementById('match-defs');
  const feedback = document.getElementById('match-feedback');
  const cont     = document.getElementById('match-continue');

  const color = UNIT_COLORS[q.unit] || '#0ff';
  panel.style.setProperty('--unit-color', `linear-gradient(90deg, transparent, ${color}, transparent)`);
  unitTag.textContent = UNIT_NAMES[q.unit];
  unitTag.style.color = color;
  unitTag.style.borderColor = color;
  header.innerHTML = `&#9672;&nbsp; ${floorLabel} — MATCH PAIRS &nbsp;&#9672;`;

  feedback.classList.add('hidden');
  cont.classList.add('hidden');
  STATE.matchSelectedTerm = null;
  STATE.matchMatched = 0;

  // Build shuffled pairs
  const pairs = q.pairs.map((p, i) => ({ ...p, id: i }));
  const shuffledDefs = [...pairs].sort(() => Math.random() - 0.5);
  STATE.matchPairs = pairs;

  termsEl.innerHTML = '';
  defsEl.innerHTML  = '';

  pairs.forEach(p => {
    const el = document.createElement('div');
    el.className = 'match-item';
    el.dataset.id = p.id;
    el.dataset.role = 'term';
    el.textContent = p.term;
    el.addEventListener('mouseenter', () => SoundFX.playClick());
    el.addEventListener('click', () => selectTerm(el, p.id));
    termsEl.appendChild(el);
  });

  shuffledDefs.forEach(p => {
    const el = document.createElement('div');
    el.className = 'match-item';
    el.dataset.id = p.id;
    el.dataset.role = 'def';
    el.textContent = p.def;
    el.addEventListener('mouseenter', () => SoundFX.playClick());
    el.addEventListener('click', () => selectDef(el, p.id));
    defsEl.appendChild(el);
  });

  showScreen('screen-match', 'anim-match');
  showDialogue(`MATCH PAIRS TO VERIFY KNOWLEDGE. ${q.en} // ${q.zh}`, false);
}

function selectTerm(el, id) {
  if (el.classList.contains('matched-correct') || el.classList.contains('disabled-item')) return;
  document.querySelectorAll('#match-terms .match-item').forEach(t => t.classList.remove('selected'));
  el.classList.add('selected');
  STATE.matchSelectedTerm = id;
}

function selectDef(el, defId) {
  if (STATE.matchSelectedTerm == null) return;
  if (el.classList.contains('matched-correct') || el.classList.contains('disabled-item')) return;
  const termId = STATE.matchSelectedTerm;
  if (termId === null || termId === undefined) return;

  const termEl = document.querySelector(`#match-terms .match-item[data-id="${termId}"]`);
  const correct = (termId === defId);

  if (correct) {
    if (termEl) { termEl.classList.remove('selected'); termEl.classList.add('matched-correct','disabled-item'); }
    el.classList.add('matched-correct','disabled-item');
    STATE.matchMatched++;
    SoundFX.playCorrect();
    STATE.score += 3;
    animateScore();
    if (STATE.matchMatched === STATE.matchPairs.length) {
      const q = STATE.queue[STATE.floor];
      const fb = document.getElementById('match-feedback');
      fb.className = 'feedback-msg ok';
      fb.innerHTML = `&#10003; ${q.okEn || 'All pairs matched correctly!'}<span class="cn-text">${q.okZh || '所有配对正确！'}</span>`;
      fb.classList.remove('hidden');
      document.getElementById('match-continue').classList.remove('hidden');
      showCorrectOverlay();
      showDialogue(randItem(AEGIS_LINES.correct), false);
    }
  } else {
    if (termEl) { termEl.classList.remove('selected'); termEl.classList.add('matched-wrong'); }
    el.classList.add('matched-wrong');
    SoundFX.playWrong();
    showWrongOverlay();
    setTimeout(() => {
      if (termEl) termEl.classList.remove('matched-wrong');
      el.classList.remove('matched-wrong');
    }, 600);
  }
  STATE.matchSelectedTerm = null;
}

// ============================================================
//  DND SCREEN
// ============================================================
function showDNDScreen() {
  const drivesContainer = document.getElementById('drives-container');
  const slotsContainer  = document.getElementById('slots-container');
  drivesContainer.innerHTML = '';
  slotsContainer.innerHTML  = '';
  STATE.dndSlots = { 1:null, 2:null, 3:null, 4:null, 5:null };

  // Shuffle drives
  const shuffled = [...DND_DRIVES].sort(() => Math.random() - 0.5);
  shuffled.forEach(d => {
    const el = document.createElement('div');
    el.className = 'data-drive';
    el.id = 'drive-' + d.id;
    el.draggable = true;
    el.innerHTML = `<span class="drive-icon">${d.icon}</span><span class="drive-label">${d.label}<span class="cn-text">${d.labelCN}</span></span>`;
    el.addEventListener('dragstart', e => { STATE.dndDragId = d.id; el.classList.add('dragging'); SoundFX.playDrag(); e.dataTransfer.effectAllowed = 'move'; });
    el.addEventListener('dragend',   () => { el.classList.remove('dragging'); STATE.dndDragId = null; });
    drivesContainer.appendChild(el);
  });

  // Create slots
  for (let i = 1; i <= 5; i++) {
    const slot = document.createElement('div');
    slot.className = 'server-slot';
    slot.id = 'slot-' + i;
    slot.dataset.slot = i;
    slot.innerHTML = `<span class="slot-num">${i}</span><span class="slot-content"><span class="slot-empty-label">EMPTY SLOT ${i} // 空槽位</span></span>`;
    slot.addEventListener('dragover',  e => { e.preventDefault(); slot.classList.add('drag-over'); });
    slot.addEventListener('dragleave', () => slot.classList.remove('drag-over'));
    slot.addEventListener('drop',      e => { e.preventDefault(); slot.classList.remove('drag-over'); dropOnSlot(i); });
    slotsContainer.appendChild(slot);
  }

  document.getElementById('dnd-submit-btn').onclick = submitDND;
  document.getElementById('dnd-reset-btn').onclick  = resetDND;
  document.getElementById('dnd-feedback').classList.add('hidden');

  showScreen('screen-floordnd', 'anim-wipe');
  showDialogue('FINAL CHALLENGE: Arrange the Australian Court Hierarchy. Slot 1 = HIGHEST authority. // 最终挑战：排列澳大利亚法院层级。插槽1=最高权威。', false);
}

function dropOnSlot(slotNum) {
  const driveId = STATE.dndDragId;
  if (!driveId) return;
  // Remove drive from any previous slot
  Object.keys(STATE.dndSlots).forEach(k => {
    if (STATE.dndSlots[k] === driveId) STATE.dndSlots[k] = null;
  });
  // Remove drive from drives col if placed
  const drive = document.getElementById('drive-' + driveId);
  if (!drive) return;
  STATE.dndSlots[slotNum] = driveId;
  SoundFX.playDrop();

  // Update slot display
  const slot = document.getElementById('slot-' + slotNum);
  const dDef = DND_DRIVES.find(d => d.id === driveId);
  slot.className = 'server-slot filled';
  slot.innerHTML = `<span class="slot-num">${slotNum}</span><span class="slot-content">${dDef.label}<span class="cn-text">${dDef.labelCN}</span></span><button class="remove-btn" onclick="removeDriveFromSlot(${slotNum})">&#10005;</button>`;

  drive.classList.add('placed');
}

function removeDriveFromSlot(slotNum) {
  const driveId = STATE.dndSlots[slotNum];
  if (!driveId) return;
  STATE.dndSlots[slotNum] = null;
  const drive = document.getElementById('drive-' + driveId);
  if (drive) drive.classList.remove('placed');
  const slot = document.getElementById('slot-' + slotNum);
  slot.className = 'server-slot';
  slot.innerHTML = `<span class="slot-num">${slotNum}</span><span class="slot-content"><span class="slot-empty-label">EMPTY SLOT ${slotNum} // 空槽位</span></span>`;
}

function submitDND() {
  const fb = document.getElementById('dnd-feedback');
  // Check all slots filled
  for (let i = 1; i <= 5; i++) {
    if (!STATE.dndSlots[i]) {
      fb.className = 'feedback-msg err';
      fb.innerHTML = '&#10007; Fill ALL 5 slots before submitting. // 提交前请填写所有5个插槽。';
      fb.classList.remove('hidden');
      return;
    }
  }
  let allCorrect = true;
  for (let i = 1; i <= 5; i++) {
    const slot = document.getElementById('slot-' + i);
    if (STATE.dndSlots[i] === DND_CORRECT_ORDER[i-1]) {
      slot.classList.add('correct-slot');
    } else {
      slot.classList.add('wrong-slot');
      allCorrect = false;
    }
  }
  if (allCorrect) {
    fb.className = 'feedback-msg ok';
    fb.innerHTML = '&#10003; PERFECT! Correct hierarchy: High Court → Federal/CoA → Supreme → District → Magistrates // 完美！正确层级：高等法院 → 联邦/上诉法院 → 最高法院 → 地区法院 → 治安法院';
    STATE.score += 20;
    animateScore();
    showCorrectOverlay();
    SoundFX.playCorrect();
    fb.classList.remove('hidden');
    document.getElementById('dnd-submit-btn').disabled = true;
    setTimeout(() => advanceFloor(), 2000);
  } else {
    fb.className = 'feedback-msg err';
    fb.innerHTML = '&#10007; Some courts are in the wrong order. Check and try again. // 部分法院顺序有误，请检查并重试。';
    fb.classList.remove('hidden');
    showWrongOverlay();
    SoundFX.playWrong();
    // Reset wrong slots after delay
    setTimeout(() => {
      for (let i = 1; i <= 5; i++) {
        document.getElementById('slot-' + i).classList.remove('correct-slot','wrong-slot');
      }
    }, 1000);
  }
}

function resetDND() {
  for (let i = 1; i <= 5; i++) {
    removeDriveFromSlot(i);
  }
  document.getElementById('dnd-feedback').classList.add('hidden');
  document.getElementById('dnd-submit-btn').disabled = false;
}

// ============================================================
//  SPACED REPETITION
// ============================================================
function requeueWrong(q) {
  // Don't requeue if already a retry or it's the DnD question
  if (q.id === 'dnd' || q._retry) return;
  const insertPos = Math.min(STATE.floor + 4, STATE.queue.length);
  const retryQ = { ...q, _retry: true };
  STATE.queue.splice(insertPos, 0, retryQ);
  STATE.totalFloors = STATE.queue.length;
  updateHUD();
}

// ============================================================
//  ADVANCE FLOOR
// ============================================================
function advanceFloor() {
  STATE.floor++;
  if (STATE.floor >= STATE.queue.length) {
    showWinScreen();
    return;
  }
  const q = STATE.queue[STATE.floor];
  const isLast = (STATE.floor === STATE.queue.length - 1 && q.type === 'dnd');
  const tText = isLast ? 'FINAL FLOOR — MAINFRAME CORE' : `ACCESSING FLOOR ${String(STATE.floor + 1).padStart(2,'0')}...`;
  const tCn   = isLast ? '最终层——主机核心' : `正在访问第${STATE.floor + 1}层...`;
  floorTransition(tText, tCn, () => {
    showDialogue(randItem(AEGIS_LINES.trans), false);
    showNextQuestion();
  });
}

// ============================================================
//  WIN SCREEN
// ============================================================
function showWinScreen() {
  SoundFX.playWin();
  SoundFX.stopAmbient();
  showScreen('screen-win', 'anim-win');
  hideDialogue();

  const elapsed = Math.floor((Date.now() - STATE.startTime) / 1000);
  const m = Math.floor(elapsed / 60);
  const s = elapsed % 60;
  document.getElementById('win-stats').textContent =
    `SCORE: ${STATE.score} pts  |  TIME: ${m}m ${s}s  |  FLOORS: ${STATE.floor}  |  QUESTIONS ATTEMPTED: ${STATE.queue.length}`;

  const list = document.getElementById('win-knowledge-list');
  list.innerHTML = STATE.topicsCovered.map(t => `<div>&#9654; ${t}</div>`).join('');

  setTimeout(() => showDialogue(AEGIS_LINES.win[0], false), 1000);
}

// ============================================================
//  EXIT BUTTON & MODAL
// ============================================================
document.getElementById('exit-btn').addEventListener('click', () => {
  SoundFX.playClick();
  exitModal.classList.remove('hidden');
});

// ── Mute button ──────────────────────────────────────────────
let _muted = false;
document.getElementById('mute-btn').addEventListener('click', () => {
  _muted = !_muted;
  SoundFX.setAmbientMuted(_muted);
  const btn = document.getElementById('mute-btn');
  btn.innerHTML = _muted ? '&#128263;' : '&#9834;';
  btn.classList.toggle('muted', _muted);
  btn.title = _muted ? 'Unmute ambient sound' : 'Mute ambient sound';
});
document.getElementById('exit-yes').addEventListener('click', () => {
  window.location.href = 'index.html?skip_intro=true';
});
document.getElementById('exit-no').addEventListener('click', () => {
  SoundFX.playClick();
  exitModal.classList.add('hidden');
});

// ============================================================
//  FULLSCREEN
// ============================================================
function enterFullscreen() {
  const el = document.documentElement;
  try {
    if      (el.requestFullscreen)       el.requestFullscreen();
    else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
    else if (el.mozRequestFullScreen)    el.mozRequestFullScreen();
  } catch(e) {}
}
document.addEventListener('fullscreenchange', () => {
  if (document.fullscreenElement) {
    GW.style.maxWidth  = 'none';
    GW.style.maxHeight = 'none';
  } else {
    GW.style.maxWidth  = '1600px';
    GW.style.maxHeight = '900px';
  }
});
document.addEventListener('keydown', e => {
  if (e.key === 'Escape' && document.fullscreenElement) {
    try { document.exitFullscreen(); } catch(e2) {}
  }
});

// ============================================================
//  CONTINUE BUTTONS
// ============================================================
document.getElementById('q-continue').addEventListener('click', () => {
  SoundFX.playClick();
  advanceFloor();
});
document.getElementById('match-continue').addEventListener('click', () => {
  SoundFX.playClick();
  advanceFloor();
});
document.getElementById('replay-btn').addEventListener('click', () => {
  SoundFX.playClick();
  initGame();
});

// ============================================================
//  BOOT SCREEN — start on any key/click
// ============================================================
function onBootStart(e) {
  if (window.isGameStarting) return;
  const prompt = document.getElementById('boot-prompt');
  const bootScreen = document.getElementById('screen-boot');
  if (bootScreen.classList.contains('active') && prompt.style.display !== 'none') {
    window.isGameStarting = true;
    enterFullscreen();
    startGame();
  }
}
document.addEventListener('keydown', onBootStart);
document.getElementById('screen-boot').addEventListener('click', onBootStart);

// ============================================================
//  INITIALISE
// ============================================================
initParticles();
initGame();
// Matrix starts in runBoot; particles run always
</script>
</body>
</html>
